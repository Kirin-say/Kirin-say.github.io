<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="referrer" content="no-referrer" />
    <meta name="description" content="一鼓作气，再而衰，三而竭orz开始准备AK，后面因为参加D3CTF Finals时间断层，陆陆续续就没有怎么做了 0x01 无限流1234567#kanxue1key1&#x3D;&quot;cuk!ogl&quot;key2&#x3D;&quot;goluck!&quot;ans&#x3D;&quot;&quot;for i in key2:    ans+&#x3D;str(key1.inde">
<meta property="og:type" content="article">
<meta property="og:title" content="KCTF 2019 Finals">
<meta property="og:url" content="http://yoursite.com/2019/12/30/KCTF-2019-Finals/index.html">
<meta property="og:site_name" content="Kirin&#39;s Blog">
<meta property="og:description" content="一鼓作气，再而衰，三而竭orz开始准备AK，后面因为参加D3CTF Finals时间断层，陆陆续续就没有怎么做了 0x01 无限流1234567#kanxue1key1&#x3D;&quot;cuk!ogl&quot;key2&#x3D;&quot;goluck!&quot;ans&#x3D;&quot;&quot;for i in key2:    ans+&#x3D;str(key1.inde">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7434375-c9bfec64a4f2c72e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7434375-b4060ada6f6b5eb6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7434375-1b6c8167b920cf78.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="article:published_time" content="2019-12-30T12:27:16.000Z">
<meta property="article:modified_time" content="2020-02-02T15:21:08.019Z">
<meta property="article:author" content="Kirin">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/7434375-c9bfec64a4f2c72e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>KCTF 2019 Finals</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2020/01/01/Heap-in-Windows/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/12/01/QEMU-Escape-Learning/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/12/30/KCTF-2019-Finals/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&text=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&is_video=false&description=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=KCTF 2019 Finals&body=Check out this article: http://yoursite.com/2019/12/30/KCTF-2019-Finals/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&name=KCTF 2019 Finals&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-无限流"><span class="toc-number">1.</span> <span class="toc-text">0x01 无限流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-南充茶坊"><span class="toc-number">2.</span> <span class="toc-text">0x02 南充茶坊</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-街机少年"><span class="toc-number">3.</span> <span class="toc-text">0x03 街机少年</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-小虎还乡"><span class="toc-number">4.</span> <span class="toc-text">0x04 小虎还乡</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        KCTF 2019 Finals
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Kirin's Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-12-30T12:27:16.000Z" itemprop="datePublished">2019-12-30</time>
    </div>


      

      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><strong>一鼓作气，再而衰，三而竭orz</strong><br><strong>开始准备AK，后面因为参加D3CTF Finals时间断层，陆陆续续就没有怎么做了</strong><br><img src="https://upload-images.jianshu.io/upload_images/7434375-c9bfec64a4f2c72e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Emmmm"></p>
<h2 id="0x01-无限流"><a href="#0x01-无限流" class="headerlink" title="0x01 无限流"></a>0x01 无限流</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#kanxue1</span><br><span class="line">key1&#x3D;&quot;cuk!ogl&quot;</span><br><span class="line">key2&#x3D;&quot;goluck!&quot;</span><br><span class="line">ans&#x3D;&quot;&quot;</span><br><span class="line">for i in key2:</span><br><span class="line">    ans+&#x3D;str(key1.index(i))</span><br><span class="line">print ans</span><br></pre></td></tr></table></figure>
<h2 id="0x02-南充茶坊"><a href="#0x02-南充茶坊" class="headerlink" title="0x02 南充茶坊"></a>0x02 南充茶坊</h2><p>首先看到<code>南充茶坊.exe</code>本身没有什么操作，并且可以看到新进程<code>CM.exe</code><br>直接binwalk即可提取出CM.exe,同时可以看到压缩包，提取后是一些pyc，同时可以看到CM.exe中只是解压了一段数据(python的bootloader)并运行新的进程，可以看到是pyinstaller<br>直接使用pyinstxtractor.py提取失败，打开winhex，发现CM.exe的py数据最后四字节有问题：<br><img src="https://upload-images.jianshu.io/upload_images/7434375-b4060ada6f6b5eb6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="DEADCODE"><br>去掉后重新提取，即可在提取的资源中发现主程序的pyc数据(<code>\CM.exe_extracted\CM</code>)，添加pyc文件头，再使用uncompyle6.exe反编译，其他几个引用库，修复pyc文件头再反编译即可:<br><img src="https://upload-images.jianshu.io/upload_images/7434375-1b6c8167b920cf78.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Header"><br>得到三个主要文件：<br>CM.py:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">from CMpub import pub_n_list, pub_e_list</span><br><span class="line">from general import valid_serial, valid_username, get_enc_seq, enc0</span><br><span class="line">from Crypto.Util.number import bytes_to_long</span><br><span class="line">from os import system</span><br><span class="line"></span><br><span class="line">def check(serial, seq):</span><br><span class="line">    now &#x3D; serial</span><br><span class="line">    for j in range(len(seq)):</span><br><span class="line">        i &#x3D; seq[j]</span><br><span class="line">        n &#x3D; pub_n_list[i]</span><br><span class="line">        e &#x3D; pub_e_list[i]</span><br><span class="line">        if now &gt; pub_n_list[i]:</span><br><span class="line">            return False</span><br><span class="line">        if i &gt; 0:</span><br><span class="line">            now &#x3D; pow(now, e, n)</span><br><span class="line">        else:</span><br><span class="line">            now &#x3D; enc0(now, e, n)</span><br><span class="line">            if 0 &#x3D;&#x3D; now:</span><br><span class="line">                return False</span><br><span class="line"></span><br><span class="line">    return now</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    username0 &#x3D; input(&#39;Please input Username:\t&#39;)</span><br><span class="line">    serial0 &#x3D; input(&#39;Please input Serial:\t&#39;)</span><br><span class="line">    try:</span><br><span class="line">        valid_serial(serial0)</span><br><span class="line">        valid_username(username0)</span><br><span class="line">    except:</span><br><span class="line">        print(&#39;\nInvalid Input\n&#39;)</span><br><span class="line">        return</span><br><span class="line">    else:</span><br><span class="line">        serial &#x3D; int(serial0, 16)</span><br><span class="line">        username &#x3D; username0.encode(&#39;utf-8&#39;)</span><br><span class="line">        seq &#x3D; get_enc_seq(username)</span><br><span class="line">        username &#x3D; bytes_to_long(username)</span><br><span class="line">        check_value &#x3D; check(serial, seq)</span><br><span class="line">        if check_value &#x3D;&#x3D; username:</span><br><span class="line">            print(&#39;\nCorrect!\n&#39;)</span><br><span class="line">        else:</span><br><span class="line">            print(&#39;\nOops! The encrypted Serial is not &quot;&#39; + username0 + &#39;&quot;.\n&#39;)</span><br><span class="line">        system(&#39;pause&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>CMpub.py:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">pub_n_list &#x3D; [</span><br><span class="line"> 1230179032923966355216193664456989083993912178939747632284136330115404600706909248395341278324517175820853286404743710145952644302282044037365125019184623573863075946389644423629304167773956447181872440665027369039751736977631813405,</span><br><span class="line"> 1230197346433601576871359147146318345794660644587556813317361121112259736906064757424819981626600536503633922734399282271582600808051530362336101942259823441839299355603967188517947938968081105138847731565260537550727639211683197879,</span><br><span class="line"> 1230175103148238074642625667635930176506433011031372989302833308622794392947506662903737049730958209740476679577696669046125817578949235076594181707520951908118478466754559490593457625240572006099913042624607335165510041897534435209,</span><br><span class="line"> 1230195419889872144876656964938566328205499234259210834822623032535100815525647028091967713768075507813160118981470260555950945392043292242406398016007295386079663975352275199434079009613722639414793342879897781273997830701207001839,</span><br><span class="line"> 1230174827420484335136670743465041112031290639257519417607166302989196920558878232997045073571925815302061150702941267642751824310540753494973942944709182841639107639574372312103384805313053886702823094137071927771880443876497834223,</span><br><span class="line"> 1230185988420782350445684618408731075592594374149632568516959143947765502111474165779039038375448460747737995123102271976521803891348006321134167925739699715318653372703575221067707929872597815216923462345784043188962130180912008349,</span><br><span class="line"> 1230182067416272799574586563163545941454653137377618375202713428977357995541722463977983142958255155175313052685136009571171283284447072364958073918526788611457558644331357136872625495927467161960356807765452292242153097362794537297,</span><br><span class="line"> 1230175667673121302771605367336364266247327534138626737357715728447532125946735363769285915448580252805827932111511713836998047583507066247536863749820566853793525683889378074234787827092004094825431802398656705570322640700888234457,</span><br><span class="line"> 1230196215847264556140155304337951587143228841840811940425256504477922246092127337047231112435502675187836322205816125340569108923142351137471846665258392302281836567949024626839375922984390501852966755563575130612920367863203222919,</span><br><span class="line"> 1230186684530117755130494958384962720772853569595334792197322452151726400507263657518745202199786469389956474942774063845925192557326303453731548268507917026122142913461670429214311602221240479274737794080665351419597459856902143413]</span><br><span class="line">pub_e_list &#x3D; [</span><br><span class="line"> 516522834974778788822737622050071002228140433403308439492366176194856535110473049678585760137133115927927751389873437178270126066640141239601219481836725664034890696476089482771855782560150644578106217444113872365843767702019835165,</span><br><span class="line"> 763019398230639020385095590111745749325105506404934257293148841704076883985487416392986296273940405033341623636375465706381388882972769884442281412068657916633528090146878551371406807944205178239005601520958614234641039656871416589,</span><br><span class="line"> 758988267473789691400810521950661631157749425185051374867090671651749645717430551141709267885532654476900928589359256799354189000242807872593092025777838259738748452497031844208902096380110211365512236965688511597330444132995706089,</span><br><span class="line"> 1160624249765899561934599801255171381291816170997589163041066264243942985094428544791715385847964978883555709070528078257993944356365754193784103706700609561770247555832359683008614876192584738534198649251915489100192910235497240729,</span><br><span class="line"> 969584864618350548573879514405798110739020997255786147754353418263140741786718203172013471748696400657712445258494301947449205093259143099235572291402265831321039275001497928579686310419303799571460516007736804962510266314260484877,</span><br><span class="line"> 977635869919691501956476862485989771461480520535754082824505449124021204549179419508424215127475063873127952064971338143136691515421466871627243381628988777601672460858098249144471775030169367579800220246847826510445608881346258241,</span><br><span class="line"> 78547544255936347746865903259860321812178052069796003154571672431430356709336862994676369608681727972743046653319757142976388460246409300441314120923213061705641045744824531268088986356203751782848608006264879618324460588039470689,</span><br><span class="line"> 917852167599983949701460374746950168138446186550074700858636881546192542929330983597633909534315139846805451671216776221152853388795036676315895948093016056124384137235869660229554239964598066970045657946753074761366723500887474273,</span><br><span class="line"> 512767915836808239407587704603826045022417741229198687031456060058182528147222248648359114235863620155721720617193551963387219761946115199232261616095015003006138489919312964841684835736418589367746436759162173805823822810793395319,</span><br><span class="line"> 1528664914065178933673821962753205462549978186396819666317790993639228285768444490202530533489915241541000489357324333513953018274712260336841857865516134868397620862505815431605074038377372062941322744934135683316080403207986149067]</span><br></pre></td></tr></table></figure>
<p>general.py:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">from hashlib import sha256</span><br><span class="line"></span><br><span class="line">def valid_serial(serial):</span><br><span class="line">    assert type(serial) &#x3D;&#x3D; str</span><br><span class="line">    assert len(serial) &gt; 0</span><br><span class="line">    if not &#39;0&#39; !&#x3D; serial[0]:</span><br><span class="line">        assert 1 &#x3D;&#x3D; len(serial)</span><br><span class="line">        for c in serial:</span><br><span class="line">            if not ord(&#39;0&#39;) &lt;&#x3D; ord(c) &lt;&#x3D; ord(&#39;9&#39;):</span><br><span class="line">                if not ord(&#39;A&#39;) &lt;&#x3D; ord(c) &lt;&#x3D; ord(&#39;F&#39;):</span><br><span class="line">                    raise AssertionError</span><br><span class="line"></span><br><span class="line">        return serial</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def valid_username(username):</span><br><span class="line">    assert type(username) &#x3D;&#x3D; str</span><br><span class="line">    assert len(username) &gt; 0</span><br><span class="line">    for c in username:</span><br><span class="line">        assert ord(c) &gt; 0</span><br><span class="line"></span><br><span class="line">    return username</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_enc_seq(username):</span><br><span class="line">    h &#x3D; sha256()</span><br><span class="line">    h.update(username)</span><br><span class="line">    hash_value &#x3D; int(h.hexdigest(), 16)</span><br><span class="line">    T &#x3D; 9</span><br><span class="line">    S &#x3D; 10</span><br><span class="line">    stat &#x3D; [0] * (T + 1)</span><br><span class="line">    seq &#x3D; [0]</span><br><span class="line">    n &#x3D; hash_value</span><br><span class="line">    while n &gt; 0:</span><br><span class="line">        if S * T &gt; len(seq):</span><br><span class="line">            now &#x3D; n % T + 1</span><br><span class="line">            if stat[now] &lt; S:</span><br><span class="line">                seq.append(now)</span><br><span class="line">                stat[now] +&#x3D; 1</span><br><span class="line">            n &#x2F;&#x2F;&#x3D; T</span><br><span class="line"></span><br><span class="line">    return seq</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def enc0(m, e, n):</span><br><span class="line">    nbit &#x3D; 192</span><br><span class="line">    T &#x3D; (n.bit_length() - 1) &#x2F;&#x2F; nbit + 1</span><br><span class="line">    ans &#x3D; 0</span><br><span class="line">    for i in range(T - 1, -1, -1):</span><br><span class="line"></span><br><span class="line">        def xxx(x, t):</span><br><span class="line">            return x &gt;&gt; t * nbit &amp; (1 &lt;&lt; nbit) - 1</span><br><span class="line"></span><br><span class="line">        now_n &#x3D; xxx(n, i)</span><br><span class="line">        now_e &#x3D; xxx(e, i)</span><br><span class="line">        now_m &#x3D; xxx(m, i)</span><br><span class="line">        if now_m &gt;&#x3D; now_n:</span><br><span class="line">            return 0</span><br><span class="line">        ans &#x3D; (ans &lt;&lt; nbit) + pow(now_m, now_e, now_n)</span><br><span class="line"></span><br><span class="line">    return ans</span><br></pre></td></tr></table></figure>
<p><strong>可以看到是多重RSA<br>解九个n需要<br>其中大部分可以靠factordb/yafu/RSACTFTools解出<br>注意其中：<br>pub_n_list[0]需要分块求解<br>pub_n_list[3]需要msieve<br>pub_n_list[7]和pub_n_list[8]共模求解<br>pub_n_list[5]利用循环：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">n &#x3D; pub_n_list[5]</span><br><span class="line">e &#x3D; pub_e_list[5]</span><br><span class="line">c &#x3D; pow(2,e,n)</span><br><span class="line">print(&quot;start&quot;)</span><br><span class="line">for i in range(1,2000):</span><br><span class="line">    c &#x3D; pow(c,e,n)</span><br><span class="line">    if c &#x3D;&#x3D; 2:</span><br><span class="line">        print(i)</span><br></pre></td></tr></table></figure>
<p>最终求解即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">from gmpy2 import invert</span><br><span class="line">e &#x3D; [False,True,False,True,True,False,False,True,True,True]</span><br><span class="line">pub_n_list &#x3D; [</span><br><span class="line"> 1230179032923966355216193664456989083993912178939747632284136330115404600706909248395341278324517175820853286404743710145952644302282044037365125019184623573863075946389644423629304167773956447181872440665027369039751736977631813405,</span><br><span class="line"> 1230197346433601576871359147146318345794660644587556813317361121112259736906064757424819981626600536503633922734399282271582600808051530362336101942259823441839299355603967188517947938968081105138847731565260537550727639211683197879,</span><br><span class="line"> 1230175103148238074642625667635930176506433011031372989302833308622794392947506662903737049730958209740476679577696669046125817578949235076594181707520951908118478466754559490593457625240572006099913042624607335165510041897534435209,</span><br><span class="line"> 1230195419889872144876656964938566328205499234259210834822623032535100815525647028091967713768075507813160118981470260555950945392043292242406398016007295386079663975352275199434079009613722639414793342879897781273997830701207001839,</span><br><span class="line"> 1230174827420484335136670743465041112031290639257519417607166302989196920558878232997045073571925815302061150702941267642751824310540753494973942944709182841639107639574372312103384805313053886702823094137071927771880443876497834223,</span><br><span class="line"> 1230185988420782350445684618408731075592594374149632568516959143947765502111474165779039038375448460747737995123102271976521803891348006321134167925739699715318653372703575221067707929872597815216923462345784043188962130180912008349,</span><br><span class="line"> 1230182067416272799574586563163545941454653137377618375202713428977357995541722463977983142958255155175313052685136009571171283284447072364958073918526788611457558644331357136872625495927467161960356807765452292242153097362794537297,</span><br><span class="line"> 1230175667673121302771605367336364266247327534138626737357715728447532125946735363769285915448580252805827932111511713836998047583507066247536863749820566853793525683889378074234787827092004094825431802398656705570322640700888234457,</span><br><span class="line"> 1230196215847264556140155304337951587143228841840811940425256504477922246092127337047231112435502675187836322205816125340569108923142351137471846665258392302281836567949024626839375922984390501852966755563575130612920367863203222919,</span><br><span class="line"> 1230186684530117755130494958384962720772853569595334792197322452151726400507263657518745202199786469389956474942774063845925192557326303453731548268507917026122142913461670429214311602221240479274737794080665351419597459856902143413]</span><br><span class="line">pub_e_list &#x3D; [</span><br><span class="line"> 516522834974778788822737622050071002228140433403308439492366176194856535110473049678585760137133115927927751389873437178270126066640141239601219481836725664034890696476089482771855782560150644578106217444113872365843767702019835165,</span><br><span class="line"> 763019398230639020385095590111745749325105506404934257293148841704076883985487416392986296273940405033341623636375465706381388882972769884442281412068657916633528090146878551371406807944205178239005601520958614234641039656871416589,</span><br><span class="line"> 758988267473789691400810521950661631157749425185051374867090671651749645717430551141709267885532654476900928589359256799354189000242807872593092025777838259738748452497031844208902096380110211365512236965688511597330444132995706089,</span><br><span class="line"> 1160624249765899561934599801255171381291816170997589163041066264243942985094428544791715385847964978883555709070528078257993944356365754193784103706700609561770247555832359683008614876192584738534198649251915489100192910235497240729,</span><br><span class="line"> 969584864618350548573879514405798110739020997255786147754353418263140741786718203172013471748696400657712445258494301947449205093259143099235572291402265831321039275001497928579686310419303799571460516007736804962510266314260484877,</span><br><span class="line"> 977635869919691501956476862485989771461480520535754082824505449124021204549179419508424215127475063873127952064971338143136691515421466871627243381628988777601672460858098249144471775030169367579800220246847826510445608881346258241,</span><br><span class="line"> 78547544255936347746865903259860321812178052069796003154571672431430356709336862994676369608681727972743046653319757142976388460246409300441314120923213061705641045744824531268088986356203751782848608006264879618324460588039470689,</span><br><span class="line"> 917852167599983949701460374746950168138446186550074700858636881546192542929330983597633909534315139846805451671216776221152853388795036676315895948093016056124384137235869660229554239964598066970045657946753074761366723500887474273,</span><br><span class="line"> 512767915836808239407587704603826045022417741229198687031456060058182528147222248648359114235863620155721720617193551963387219761946115199232261616095015003006138489919312964841684835736418589367746436759162173805823822810793395319,</span><br><span class="line"> 1528664914065178933673821962753205462549978186396819666317790993639228285768444490202530533489915241541000489357324333513953018274712260336841857865516134868397620862505815431605074038377372062941322744934135683316080403207986149067]</span><br><span class="line">n0 &#x3D; [3 , 5 , 7185931 , 158808094450561 , 71865654341558562052460445666991255437082533473043601769875791167176804170025423671296979603455163675313185119614191555444054006826175580211227699148166547437793831583944982630043047905318718417096260894067097]</span><br><span class="line">phi &#x3D; 1</span><br><span class="line">for i in n0:</span><br><span class="line">    phi*&#x3D;i-1</span><br><span class="line">d0 &#x3D; invert(pub_e_list[0]&#x2F;&#x2F;5,phi)</span><br><span class="line">e0 &#x3D; 5 * 269 * 100479347467620083 * 3821997825858167173910810789124613195528533611172697535969177289820154015727992167281727873897740742740733210910948103694567722741818071770351352777527509949808410647489867809691490251021126067129368597541181679</span><br><span class="line"></span><br><span class="line">n1 &#x3D; [3012613441, 408348887278831461892610983390456945715612189153595698014201723503582993177671598068402822885301113712860820610804438839912419021850712894809826330539771179969086301239790288951959814006579380835620367785931463468740342519]</span><br><span class="line">e1 &#x3D; 763019398230639020385095590111745749325105506404934257293148841704076883985487416392986296273940405033341623636375465706381388882972769884442281412068657916633528090146878551371406807944205178239005601520958614234641039656871416589</span><br><span class="line">phi &#x3D; 1</span><br><span class="line">for i in n1:</span><br><span class="line">    phi*&#x3D;i-1</span><br><span class="line">d1 &#x3D; invert(pub_e_list[1],phi)</span><br><span class="line">p2 &#x3D; 36796059015915981995743432427927902530578158826788662547913509800095517347118062478922356654842254755916234587213077</span><br><span class="line">q2 &#x3D; pub_n_list[2]&#x2F;&#x2F;p2</span><br><span class="line">phi2 &#x3D; (p2-1)*(q2-1)</span><br><span class="line">e2 &#x3D; 7537 * 9255264980309 * 10880470858007751390324652265533378235468341001689138251269957159180985184462655657188218085336892458554427149527946369954194849737545474019636015673163686687177842336952960193593542624177105956374331546420180666133</span><br><span class="line">d2 &#x3D; invert(e2,phi2)</span><br><span class="line">print(d2)</span><br><span class="line">n7 &#x3D; pub_n_list[7]</span><br><span class="line">n8 &#x3D; pub_n_list[8]</span><br><span class="line">p4 &#x3D; 35073848198058968264749790689745197012385911613318747771531468291963621262770461817935405298684967674641247961569207</span><br><span class="line">q4 &#x3D; 35073848198058968264749790689745197012385911613318747864444430571453140176920442860760331340059929469925220710756489</span><br><span class="line">d4 &#x3D; invert(pub_e_list[4],(p4-1)*(q4-1))</span><br><span class="line">e5 &#x3D; 11 * 13 * 191 * 733657391 * 4026960893339 * 12115379258185536246641740189808027591877771839170387403121796053010686218208201487072073319275818512067594227149411425111528971256589583807806340652926403236922622238967009523050297874688181255609871957293</span><br><span class="line">p &#x3D; gcd(n7,n8)</span><br><span class="line">p6 &#x3D; 26153324138194530872309557862464074525306735281010877795840958405693838446634362256045094682633541743845611502925341</span><br><span class="line">q6 &#x3D; 47037312003475104493787837223043052957997925611039410248119470723357078273788416725476266555402464778755414193496517</span><br><span class="line">phi6 &#x3D; (p6-1)*(q6-1)</span><br><span class="line">d5 &#x3D; 1</span><br><span class="line">d6 &#x3D; invert(pub_e_list[6],phi6)</span><br><span class="line">d7 &#x3D; invert(pub_e_list[7],(p-1)*(n7&#x2F;&#x2F;p-1))</span><br><span class="line">d8 &#x3D; invert(pub_e_list[8],(p-1)*(n8&#x2F;&#x2F;p-1))</span><br><span class="line">p9 &#x3D; 33478071698956898786044169848212690817704794983713768568912431388982883793878002287614711652531743087737814467999489</span><br><span class="line">q9 &#x3D; pub_n_list[9]&#x2F;&#x2F;p9</span><br><span class="line">phi9 &#x3D; (p9-1)*(q9-1)</span><br><span class="line">d9 &#x3D; invert(pub_e_list[9],phi9)</span><br><span class="line">print(0,d1,d2,0,d4,0,d6,d7,d8,d9)</span><br><span class="line">c &#x3D; pow(2,pub_e_list[9],pub_n_list[9])</span><br><span class="line">assert 2 &#x3D;&#x3D; pow(c,d9,pub_n_list[9])</span><br><span class="line">def solve_n5(n,e,c,iteration&#x3D;972):</span><br><span class="line">    for i in range(iteration):</span><br><span class="line">        c &#x3D; pow(c,e,n) </span><br><span class="line">    return c</span><br><span class="line"># solve_n5(pub_n_list[5],pub_e_list[5],c,972)</span><br><span class="line">from gmpy2 import gcd,is_prime,next_prime</span><br><span class="line">pub_n_list &#x3D; [</span><br><span class="line"> 1230179032923966355216193664456989083993912178939747632284136330115404600706909248395341278324517175820853286404743710145952644302282044037365125019184623573863075946389644423629304167773956447181872440665027369039751736977631813405,</span><br><span class="line"> 1230197346433601576871359147146318345794660644587556813317361121112259736906064757424819981626600536503633922734399282271582600808051530362336101942259823441839299355603967188517947938968081105138847731565260537550727639211683197879,</span><br><span class="line"> 1230175103148238074642625667635930176506433011031372989302833308622794392947506662903737049730958209740476679577696669046125817578949235076594181707520951908118478466754559490593457625240572006099913042624607335165510041897534435209,</span><br><span class="line"> 1230195419889872144876656964938566328205499234259210834822623032535100815525647028091967713768075507813160118981470260555950945392043292242406398016007295386079663975352275199434079009613722639414793342879897781273997830701207001839,</span><br><span class="line"> 1230174827420484335136670743465041112031290639257519417607166302989196920558878232997045073571925815302061150702941267642751824310540753494973942944709182841639107639574372312103384805313053886702823094137071927771880443876497834223,</span><br><span class="line"> 1230185988420782350445684618408731075592594374149632568516959143947765502111474165779039038375448460747737995123102271976521803891348006321134167925739699715318653372703575221067707929872597815216923462345784043188962130180912008349,</span><br><span class="line"> 1230182067416272799574586563163545941454653137377618375202713428977357995541722463977983142958255155175313052685136009571171283284447072364958073918526788611457558644331357136872625495927467161960356807765452292242153097362794537297,</span><br><span class="line"> 1230175667673121302771605367336364266247327534138626737357715728447532125946735363769285915448580252805827932111511713836998047583507066247536863749820566853793525683889378074234787827092004094825431802398656705570322640700888234457,</span><br><span class="line"> 1230196215847264556140155304337951587143228841840811940425256504477922246092127337047231112435502675187836322205816125340569108923142351137471846665258392302281836567949024626839375922984390501852966755563575130612920367863203222919,</span><br><span class="line"> 1230186684530117755130494958384962720772853569595334792197322452151726400507263657518745202199786469389956474942774063845925192557326303453731548268507917026122142913461670429214311602221240479274737794080665351419597459856902143413]</span><br><span class="line">def enc0(m, e, n):</span><br><span class="line">    nbit &#x3D; 192</span><br><span class="line">    T &#x3D; (n.bit_length() - 1) &#x2F;&#x2F; nbit + 1</span><br><span class="line">    ans &#x3D; 0</span><br><span class="line">    for i in range(T - 1, -1, -1):</span><br><span class="line"></span><br><span class="line">        def xxx(x, t):</span><br><span class="line">            return x &gt;&gt; t * nbit &amp; (1 &lt;&lt; nbit) - 1</span><br><span class="line"></span><br><span class="line">        now_n &#x3D; xxx(n, i)</span><br><span class="line">        print(now_n)</span><br><span class="line">        now_e &#x3D; xxx(e, i)</span><br><span class="line">        print(now_e)</span><br><span class="line">        now_m &#x3D; xxx(m, i)</span><br><span class="line">        if now_m &gt;&#x3D; now_n:</span><br><span class="line">            return 0</span><br><span class="line">        ans &#x3D; (ans &lt;&lt; nbit) + pow(now_m, now_e, now_n)</span><br><span class="line"></span><br><span class="line">    return ans</span><br><span class="line">enc0(1,pub_e_list[0],pub_n_list[0])</span><br><span class="line">n0 &#x3D; [4973828634074084070222279013150769733596223651485114564273,6277087998938792861042405062580257456598525084583043892593,6277031389885428580574088212602983156224270664268963309877,6277052177355867862708971469565390229110991711310599757597]</span><br><span class="line">e0 &#x3D; [2088392012863598836930805392926351714650188437587735488361,3784482471495320575589048728247975381653380680141800804337,5452515267665389664275951067811576469767027838421869719869,2513827307676496129699780837261567723809491022362599687453]</span><br><span class="line">p00,q00 &#x3D; 66428487199875098638682243347, 74874934591065563984140844459</span><br><span class="line">p11,q11 &#x3D; 62221071216704155848060102353, 100883637587609016545825234081</span><br><span class="line">p22,q22 &#x3D; 46189403453019724968918893779, 135897650123798146894617474263</span><br><span class="line">p33,q33 &#x3D; 50652156588134490618159573691, 123924677647906847227542543367</span><br><span class="line">phi00 &#x3D; (p00-1)*(q00-1)</span><br><span class="line">phi11 &#x3D; (p11-1)*(q11-1)</span><br><span class="line">phi22 &#x3D; (p22-1)*(q22-1)</span><br><span class="line">phi33 &#x3D; (p33-1)*(q33-1)</span><br><span class="line">p3 &#x3D; 34508357350889186927005771176009938286558270433215942821530479444470024241863567490529149148811494601012847563892119</span><br><span class="line">q3 &#x3D; pub_n_list[3]&#x2F;&#x2F;p3</span><br><span class="line">phi3 &#x3D; (p3-1)*(q3-1)</span><br><span class="line">d3 &#x3D; invert(pub_e_list[3],phi3)</span><br><span class="line">phi &#x3D; [phi00,phi11,phi22,phi33]</span><br><span class="line">d0 &#x3D; [invert(e0[i],phi[i]) for i in range(4)]</span><br><span class="line">pub_d_list &#x3D; [0,1229061379053482744823152709690434888605435342198642793057361495153090878523561729157374272032362247153476832905266577597936263875922635915871109425948662301015976854125739243408750974498511602088546684816889116185016023460221241669,777757116197429014363243483536399809327489478672765799132008796613164652485176625704586327714092043960999487185568710834915265226900792279774759093092549483626423808502139519027474793822444064402879491357824424416255246538629615833,d3,201419093613711761798540120588879041236840801068737686325195769604622639638393093247553615834885873886104026065263583851481439063609372020322699902282368593094548575688163522138303256348801329176798576662806247524508598547117027909,0,922636550562204599680939922372659456090989853033213781402035071733018496656291847983487357218691366381484789513851952285401356211108779700672241308549478980097499945532484886375918716118514969665502334756552044884230174523807259329,627567627354326605515830278366021138159090868181225778581524414114680017539982571880336309158282300554534438008003322761037932916796881232969829716072515736525821134512405811777096389132413642826921797756179543381108933388795804769,87763698610259057934268676955169084425464093902524300758830437447338976666426976224860384022223934601405128988601223084334832120115000652985202766336425151725676233383146800117094745887838499800523801384784235875984207816521259103,476133969086427941368462698171675198835788633664060460402567958612344234273279077792246479357026462298849835811290909092037603283477920353500979549470973082158764663458247740861805650589884280458476962517272738918503674157481390819]</span><br><span class="line">from Crypto.Util.number import long_to_bytes</span><br><span class="line">def dec0(pub_n,n0,d0,m):</span><br><span class="line">    nbit &#x3D; 192</span><br><span class="line">    T &#x3D; (pub_n.bit_length() - 1) &#x2F;&#x2F; nbit + 1</span><br><span class="line">    ans &#x3D; 0</span><br><span class="line">    for i in range(T - 1, -1, -1):</span><br><span class="line">        idx &#x3D; 3-i</span><br><span class="line">        def xxx(x, t):</span><br><span class="line">            return x &gt;&gt; t * nbit &amp; (1 &lt;&lt; nbit) - 1</span><br><span class="line">        now_m &#x3D; xxx(m, i)</span><br><span class="line">        ans &#x3D; (ans &lt;&lt; nbit) + pow(now_m, d0[idx], n0[idx])</span><br><span class="line">    return hex(ans)[2:].upper()</span><br><span class="line">def reverse(serial, seq):</span><br><span class="line">    now &#x3D; serial</span><br><span class="line">    for j in range(len(seq)):</span><br><span class="line">        i &#x3D; seq[j]</span><br><span class="line">        n &#x3D; pub_n_list[i]</span><br><span class="line">        e &#x3D; pub_e_list[i]</span><br><span class="line">        d &#x3D; pub_d_list[i]</span><br><span class="line">        if i &gt; 0 and i!&#x3D;5:</span><br><span class="line">            now &#x3D; pow(now, d, n)</span><br><span class="line">        elif i&#x3D;&#x3D;5:</span><br><span class="line">            now &#x3D; solve_n5(n,e,now,iteration&#x3D;972)</span><br><span class="line">        else:</span><br><span class="line">            now &#x3D; dec0(pub_n_list[0],n0,d0, now)</span><br><span class="line">            if 0 &#x3D;&#x3D; now:</span><br><span class="line">                return False</span><br><span class="line">    return now</span><br><span class="line">username &#x3D; &quot;KCTF&quot;</span><br><span class="line">sec &#x3D; get_enc_seq(username.encode(&#39;utf-8&#39;))</span><br><span class="line">from Crypto.Util.number import long_to_bytes,bytes_to_long</span><br><span class="line">name &#x3D; bytes_to_long(username.encode(&#39;utf-8&#39;))</span><br><span class="line">#&quot;89F3A5FD45E2A383&quot;</span><br><span class="line">#A7E477BED7F21984189BF0E42F92252C5B8EAC3D816F0A354A60FA97ACCA5E45EF94D1BD557C0BFD4AE6AF65236BDC205B084D3B9D7771C630611D5B2C3D4F10F14CE7C206DCDFDBD3578335BE68AD23018D2FC95D2F1F16ABD7FC78D22E2DB9</span><br><span class="line">#CA1F4C8740C8E620C4AC306F2C3BCB3FD7ABCC1378D94779DD78481EDC412ACE40A2092B4726A259367C43F3AA3DDDDF54C2513318A11C61867BC43882498F32EBD694C77786A9091FC1333E810888C01049E97F15E4B64123A913E5794B0614</span><br><span class="line">t &#x3D; hex(bytes_to_long(b&#39;\xa7\xe4w\xbe\xd7\xf2\x19\x84\x18\x9b\xf0\xe4&#x2F;\x92%,[\x8e\xac&#x3D;\x81o\n5J&#96;\xfa\x97\xac\xca^E\xef\x94\xd1\xbdU|\x0b\xfdJ\xe6\xafe#k\xdc [\x08M;\x9dwq\xc60a\x1d[,&#x3D;O\x10\xf1L\xe7\xc2\x06\xdc\xdf\xdb\xd3W\x835\xbeh\xad#\x01\x8d&#x2F;\xc9]&#x2F;\x1f\x16\xab\xd7\xfcx\xd2.-\xb9&#39;))</span><br><span class="line">print(&quot;a7e477bed7f21984189bf0e42f92252c5b8eac3d816f0a354a60fa97acca5e45ef94d1bd557c0bfd4ae6af65236bdc205b084d3b9d7771c630611d5b2c3d4f10f14ce7c206dcdfdbd3578335be68ad23018d2fc95d2f1f16abd7fc78d22e2db9&quot;.upper())</span><br><span class="line">print(reverse(name,sec[::-1]))</span><br></pre></td></tr></table></figure>
<h2 id="0x03-街机少年"><a href="#0x03-街机少年" class="headerlink" title="0x03 街机少年"></a>0x03 街机少年</h2><p><strong>XYLearn tqllllll !   7feilee tqllllll !</strong><br>应该是非预期了<br>IDA载入程序，看到主程序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">if ( get_input() )</span><br><span class="line">&#123;</span><br><span class="line">  SetUnhandledExceptionFilter(TopLevelExceptionFilter);</span><br><span class="line">  if ( GAME((unsigned __int8 *)name, name_len) )</span><br><span class="line">    output(&quot;You Win! You are very clever!&quot;);</span><br><span class="line">  else</span><br><span class="line">    output(&quot;Game Over&quot;);</span><br><span class="line">  system(&quot;pause&quot;);</span><br><span class="line">  result &#x3D; 0;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">  output(&quot;Game Over&quot;);</span><br><span class="line">  system(&quot;pause&quot;);</span><br><span class="line">  result &#x3D; 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序读入name和serial，而后走过一个判断，通过GAME函数返回值来判断是否正确<br>首先读入name和serial:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">for ( i &#x3D; 0; i &lt; 32; ++i )</span><br><span class="line">&#123;</span><br><span class="line">  v4 &#x3D; read_input();</span><br><span class="line">  if ( (v4 &lt; 97 || v4 &gt; 122) &amp;&amp; (v4 &lt; 65 || v4 &gt; 90) &amp;&amp; (v4 &lt; 48 || v4 &gt; 57) )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( v4 !&#x3D; 13 &amp;&amp; v4 !&#x3D; 10 )</span><br><span class="line">      return 0;</span><br><span class="line">    name_len &#x3D; i;</span><br><span class="line">    break;</span><br><span class="line">  &#125;</span><br><span class="line">  name[i] &#x3D; v4;</span><br><span class="line">&#125;</span><br><span class="line">if ( name_len &lt; 4 || name_len &gt; 16 )</span><br><span class="line">  return 0;</span><br><span class="line">output(&quot;Please input your KEY: ( : to z )&quot;);</span><br><span class="line">for ( j &#x3D; 0; j &lt; 128; ++j )</span><br><span class="line">&#123;</span><br><span class="line">  v3 &#x3D; read_input();</span><br><span class="line">  if ( v3 &lt; &#39;:&#39; || v3 &gt; &#39;z&#39; )</span><br><span class="line">  &#123;</span><br><span class="line">    if ( v3 !&#x3D; 13 &amp;&amp; v3 !&#x3D; 10 )</span><br><span class="line">      return 0;</span><br><span class="line">    serial_len &#x3D; j;</span><br><span class="line">    break;</span><br><span class="line">  &#125;</span><br><span class="line">  serial[j] &#x3D; v3;</span><br><span class="line">&#125;</span><br><span class="line">if ( !serial_len || serial_len &gt; 128 )</span><br><span class="line">  return 0;</span><br><span class="line">dec_len &#x3D; dec1((int)decode_serial, (int)serial, serial_len);</span><br></pre></td></tr></table></figure>
<p>简单判断name和serial合法后decode并存入全局变量数组<br>decode类似一个base64，只是对应处理位不同，直接对照求逆即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def dec1(str1):</span><br><span class="line">	ans&#x3D;[]</span><br><span class="line">	for i in range(len(str1)&#x2F;3):</span><br><span class="line">		ans.append(ord(str1[i*3])&gt;&gt;2)</span><br><span class="line">		ans.append(((ord(str1[i*3])&amp;0b11)&lt;&lt;4)+((ord(str1[i*3+1])&amp;0b11110000)&gt;&gt;4))</span><br><span class="line">		ans.append((ord(str1[i*3+1])&amp;0b1111)+((ord(str1[i*3+2])&amp;0b11000000)&gt;&gt;2))</span><br><span class="line">		ans.append(ord(str1[i*3+2])&amp;0b00111111)</span><br><span class="line">	s&#x3D;&quot;&quot;</span><br><span class="line">	for i in ans:</span><br><span class="line">		s+&#x3D;chr(i+ord(&quot;:&quot;))</span><br><span class="line">	return s</span><br><span class="line">#后面不足对应相同位置并补&#39;z&#39;即可</span><br></pre></td></tr></table></figure>
<p>在GAME中，首先使用大量数组查表隐藏了算法和计算过程<br>首先将第一轮table扣下来：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def func1(x, m):</span><br><span class="line">    s &#x3D; x</span><br><span class="line">    none_primitive_root &#x3D; 0</span><br><span class="line">    for i in range(1, m):</span><br><span class="line">        y &#x3D; min(x, s)</span><br><span class="line">        z &#x3D; max(x, s)</span><br><span class="line">        s &#x3D; y * y % 17 ^ triangle_at(xor_table, y, z)</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>根据返回值发现是一个乘方运算(取模意义下)，计算pow(x,m)<br>故而在第一层：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">for ( i &#x3D; 1; i &lt; 16; ++i )</span><br><span class="line"> &#123;</span><br><span class="line">   v35 &#x3D; v38;</span><br><span class="line">   v27 &#x3D; v51;</span><br><span class="line">   if ( v38 &gt; (signed int)v51 )</span><br><span class="line">   &#123;</span><br><span class="line">     v35 &#x3D; v51;                              &#x2F;&#x2F; 乘方</span><br><span class="line">     v27 &#x3D; v38;</span><br><span class="line">   &#125;</span><br><span class="line">   v38 &#x3D; v35 * v35 % 17 ^ table[(unsigned __int8)(v27 + (v35 - 1) * (34 - v35) &#x2F; 2 - v35)];</span><br><span class="line">   if ( v38 &#x3D;&#x3D; 1 &amp;&amp; i !&#x3D; 15 )  &#x2F;&#x2F; (p-1)&#x2F;2不满足 </span><br><span class="line">   &#123;</span><br><span class="line">     v51 &#x3D; (v51 + 1) % 16 + 1;  </span><br><span class="line">     v38 &#x3D; 0;</span><br><span class="line">     break;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>其实际计算的是相对v51步长2的模17下最近的非二次剩余<br>而后其根据输入name初始化了一个256长度数组（前16参与运算）<br>而后大致流程可以取下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br></pre></td><td class="code"><pre><span class="line">from base64 import b64decode,b64encode</span><br><span class="line">import os</span><br><span class="line">from functools import reduce</span><br><span class="line"></span><br><span class="line">xor_table &#x3D; [0,3,2,5,4,7,6,9,8,11,10,13,12,15,14,17,0,2,12,14,8,10,20,5,7,1,3,13,15,9,11,0,5,6,8,13,14,3,4,25,11,12,1,2,7,0,19,23,27,31,18,22,26,30,17,21,25,29,0,5,9,14,3,24,12,1,6,10,15,4,0,10,12,1,11,13,6,8,18,7,9,0,10,3,13,6,31,9,2,12,5,0,9,1,14,6,15,7,12,4,0,8,3,11,2,10,29,5,0,7,14,4,11,1,8,0,15,5,3,14,4,0,11,7,2,13,0,28,24,20,0,15,10,0,6,0]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">with open(&#39;E:&#x2F;Totoro.exe&#39;, &#39;rb&#39;) as f:</span><br><span class="line">    f.seek(0x16088, os.SEEK_SET)</span><br><span class="line">    bytes_397288 &#x3D; f.read(65536)</span><br><span class="line">    bytes_397288 &#x3D; [i for i in bytes_397288]</span><br><span class="line">    f.seek(0x26088, os.SEEK_SET)</span><br><span class="line">    bytes_3A7288 &#x3D; f.read(256)</span><br><span class="line">    bytes_3A7288 &#x3D; [i for i in bytes_3A7288]</span><br><span class="line">    f.seek(0x14E88, os.SEEK_SET)</span><br><span class="line">    bytes_396088 &#x3D; f.read(256)</span><br><span class="line">    bytes_396088 &#x3D; [i for i in bytes_396088]</span><br><span class="line">    f.seek(0x14F88, os.SEEK_SET)</span><br><span class="line">    bytes_396188 &#x3D; f.read(4096)</span><br><span class="line">    bytes_396188 &#x3D; [i for i in bytes_396188]</span><br><span class="line">    f.seek(0x15F88, os.SEEK_SET)</span><br><span class="line">    bytes_417188 &#x3D; f.read(256)</span><br><span class="line">    bytes_417188 &#x3D; [i for i in bytes_417188]</span><br><span class="line"></span><br><span class="line">def quadratic_residues(x, m):</span><br><span class="line">    while True:</span><br><span class="line">        s &#x3D; x</span><br><span class="line">        for i in range(1, m):</span><br><span class="line">            y &#x3D; s</span><br><span class="line">            z &#x3D; x</span><br><span class="line">            if s &gt; x:</span><br><span class="line">                y &#x3D; x</span><br><span class="line">                z &#x3D; s</span><br><span class="line">            idx &#x3D; (z + (y - 1) * (34 - y) &#x2F;&#x2F; 2 - y)%256</span><br><span class="line">            s &#x3D; (y * y % 17) ^ xor_table[idx]</span><br><span class="line">            if s &#x3D;&#x3D; 1 and i !&#x3D; 15:</span><br><span class="line">                x &#x3D; (x + 1) % 16 + 1</span><br><span class="line">                s &#x3D; 0</span><br><span class="line">                break</span><br><span class="line">        if s &#x3D;&#x3D; 1:</span><br><span class="line">            break</span><br><span class="line">    return x</span><br><span class="line"></span><br><span class="line">def _pow(x, m):</span><br><span class="line">    s &#x3D; x</span><br><span class="line">    global flag</span><br><span class="line">    for i in range(1, m):</span><br><span class="line">        y &#x3D; s</span><br><span class="line">        z &#x3D; x</span><br><span class="line">        if s &gt; x:</span><br><span class="line">            y &#x3D; x</span><br><span class="line">            z &#x3D; s</span><br><span class="line">        idx &#x3D; (z + (y - 1) * (34 - y) &#x2F;&#x2F; 2 - y)%256</span><br><span class="line">        s &#x3D; (y * y % 17) ^ xor_table[idx]</span><br><span class="line">        if s &#x3D;&#x3D; 1 and i !&#x3D; 15:</span><br><span class="line">            flag &#x3D; 1</span><br><span class="line">    return s</span><br><span class="line"></span><br><span class="line">def triangle_index(y, z):</span><br><span class="line">    return z + (y - 1) * (34 - y) &#x2F;&#x2F; 2 - y</span><br><span class="line"></span><br><span class="line">def triangle_at(mat, y, z):</span><br><span class="line">    return mat[triangle_index(y, z)]</span><br><span class="line"></span><br><span class="line">def get_inv(x):</span><br><span class="line">    while True:</span><br><span class="line">        s &#x3D; x</span><br><span class="line">        for i in range(1, 16):</span><br><span class="line">            y &#x3D; min(x, s)</span><br><span class="line">            z &#x3D; max(x, s)</span><br><span class="line">            s &#x3D; y * y % 17 ^ triangle_at(xor_table, y, z)</span><br><span class="line">            if s &#x3D;&#x3D; 1 and i !&#x3D; 16 - 1:</span><br><span class="line">                x &#x3D; (x + 1) % 16 + 1</span><br><span class="line">                s &#x3D; 0</span><br><span class="line">                break</span><br><span class="line">        if s &#x3D;&#x3D; 1:</span><br><span class="line">            break</span><br><span class="line">    return x</span><br><span class="line"></span><br><span class="line">def pows(x, m):</span><br><span class="line">    s &#x3D; x</span><br><span class="line">    none_primitive_root &#x3D; 0</span><br><span class="line">    for i in range(1, m):</span><br><span class="line">        y &#x3D; min(x, s)</span><br><span class="line">        z &#x3D; max(x, s)</span><br><span class="line">        s &#x3D; y * y % 17 ^ triangle_at(xor_table, y, z)</span><br><span class="line">        if s &#x3D;&#x3D; 1 and i !&#x3D; m-1:</span><br><span class="line">            none_primitive_root &#x3D; 1</span><br><span class="line">    return s,none_primitive_root</span><br><span class="line"></span><br><span class="line">def map_username(username,bytes_417188):</span><br><span class="line">    for i in range(len(username) - 1):</span><br><span class="line">        ch &#x3D; username[i + 1]</span><br><span class="line">        if i &gt;&#x3D; 7:</span><br><span class="line">            if i &gt;&#x3D; 10:</span><br><span class="line">                if i &gt;&#x3D; 13:</span><br><span class="line">                    bytes_417188[i] &#x3D; ch % 8 + 8</span><br><span class="line">                else:</span><br><span class="line">                    bytes_417188[i] &#x3D; 7 - ch % 7</span><br><span class="line">            else:</span><br><span class="line">                bytes_417188[i] &#x3D; ch % 8 + 8</span><br><span class="line">        else:</span><br><span class="line">            bytes_417188[i] &#x3D; 7 - ch % 7</span><br><span class="line">    return bytes_417188</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def get_idx(a, b, c):</span><br><span class="line">    lo &#x3D; ((b &gt;&gt; 2) ^ ((c &lt;&lt; 4) &amp; 0xC0)) ^ ((a &lt;&lt; 2) &amp; 0x3C) ^ 0xC7</span><br><span class="line">    hi &#x3D; (c &amp; 3) ^ ((b &lt;&lt; 2) &amp; 0xf) ^ 2</span><br><span class="line">    x &#x3D; lo | (hi &lt;&lt; 8)</span><br><span class="line">    return x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def unknown(a, b, c):</span><br><span class="line">    &#39;&#39;&#39;a^b^c&#39;&#39;&#39;</span><br><span class="line">    return bytes_397288[((a + b + c) % 16) | (a &lt;&lt; 4) | (b &lt;&lt; 8) | (c &lt;&lt; 12)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def check(username, key):</span><br><span class="line">   #key&#x3D;  [61, 136, 200, 67, 168, 249, 66, 246, 42, 33, 212, 253, 243, 246, 246, 244, 246, 249, 244, 255, 237]</span><br><span class="line">    key_len &#x3D; len(key)</span><br><span class="line">    ch &#x3D; username[0] % 16 + 1</span><br><span class="line">    username &#x3D; map_username(username,bytes_417188)</span><br><span class="line">    primitive_root &#x3D; quadratic_residues(ch,16)</span><br><span class="line">    kidx &#x3D; 0</span><br><span class="line">    x &#x3D; 5</span><br><span class="line">    while kidx &lt; key_len:</span><br><span class="line">        key_low &#x3D; key[kidx] % 16 + 1</span><br><span class="line">        key_high &#x3D; (key[kidx]&gt;&gt;4) % 16 + 1</span><br><span class="line">        flag &#x3D; 1</span><br><span class="line">        if primitive_root and key_low &lt;&#x3D; 16 and key_high &lt;&#x3D;16:</span><br><span class="line">            flag &#x3D; 0</span><br><span class="line">            key_low &#x3D; _pow(primitive_root, key_low)</span><br><span class="line">            r2 &#x3D; quadratic_residues(key_low,16)</span><br><span class="line">            key_high &#x3D; _pow(r2, key_high) </span><br><span class="line">            if flag:</span><br><span class="line">                break</span><br><span class="line">        primitive_root &#x3D; quadratic_residues(key_high,16)</span><br><span class="line">        primitive_flag &#x3D; (key_high * bytes_396088[username[key_low - 1] - key_high])&amp;0xff</span><br><span class="line">        for i in range(key_low, 128):</span><br><span class="line">            v4 &#x3D; int(username[i] &#x3D;&#x3D; 0)</span><br><span class="line">            v5 &#x3D; (((v4 + bytes_396188[get_idx(username[key_low - 1], username[i], key_high)])%256) * primitive_flag)&amp;0xff</span><br><span class="line">            primitive_flag &#x3D; (((v5 + 1) &amp; int(v5 !&#x3D; 0)) + v5)&amp;0xff</span><br><span class="line">        username[key_low - 1] &#x3D; (username[key_low - 1] + ((((2 * ((primitive_flag + 1) &amp; 1) - 1)&amp;0xff) * key_high)&amp;0xff))&amp;0xff</span><br><span class="line">        #print(&quot;test xor is &#123;&#125;&quot;.format(reduce(lambda x, y: x ^ y, username)))</span><br><span class="line">        if not primitive_flag:</span><br><span class="line">            break</span><br><span class="line">        if not any(username):</span><br><span class="line">            return kidx &#x3D;&#x3D; key_len - 1</span><br><span class="line">        key_low_ &#x3D; (key[kidx] &gt;&gt; 4) % 16 + 1</span><br><span class="line">        key_high_ &#x3D; key[kidx + 1] % 16 + 1</span><br><span class="line">        bytes_396088[key_low_ &#x2F;&#x2F; 2] &#x3D; (bytes_396088[key_low_ &#x2F;&#x2F; 2] + key_high_) % 127 + 1</span><br><span class="line">        kidx +&#x3D; 1</span><br><span class="line">        tmp &#x3D; unknown(username[2], username[1], username[0])</span><br><span class="line">        tmp &#x3D; unknown(username[4], username[3], tmp)</span><br><span class="line">        tmp &#x3D; unknown(username[6], username[5], tmp)</span><br><span class="line">        tmp &#x3D; unknown(username[8], username[7], tmp)</span><br><span class="line">        tmp &#x3D; unknown(username[10], username[9], tmp)</span><br><span class="line">        tmp &#x3D; unknown(username[12], username[11], tmp)</span><br><span class="line">        tmp &#x3D; unknown(username[14], username[13], tmp)</span><br><span class="line">        if tmp:</span><br><span class="line">            for i in range(15):</span><br><span class="line">                val &#x3D; bytes_3A7288[tmp | (username[i] &lt;&lt; 4)]</span><br><span class="line">                if val &amp; 1:</span><br><span class="line">                    username[i] &#x3D; val &gt;&gt; 1</span><br><span class="line">                    break</span><br><span class="line">        else:</span><br><span class="line">            print(kidx)</span><br><span class="line">            fflag &#x3D; 0</span><br><span class="line">            while True:</span><br><span class="line">                if username[x] &#x3D;&#x3D; 1:</span><br><span class="line">                    username[x] &#x3D; (username[x] - 1)%256</span><br><span class="line">                    x &#x3D; (x + 4) % 15</span><br><span class="line">                    fflag &#x3D; 1</span><br><span class="line">                    break</span><br><span class="line">                if username[x] &gt; 1:</span><br><span class="line">                    break</span><br><span class="line">                x &#x3D; (x + 4) % 15</span><br><span class="line">            if fflag &#x3D;&#x3D; 0:</span><br><span class="line">                username[x] &#x3D; username[x] - ((x * x + 1) % username[x] + 1)</span><br><span class="line">                x &#x3D; (x + 4) % 15</span><br><span class="line">        if not reduce(lambda x, y: x | y, username):</span><br><span class="line">            break</span><br><span class="line">    return False</span><br></pre></td></tr></table></figure>
<p>在循环过程中，每轮12bit key参与运算，首先根据第一步结果进行乘方，再进行一次求非平方剩余，再进行一次乘方(不出现单位元)，根据结果更新一位username数组，而后进行一轮变换(unknown)，根据变换结果更新一位username<br>通过观察数组及结果发现unknown操作是进行一组异或<br>若异或后不为0则依赖第二个数组将其每位异或结果调整为0<br>通过观察正确序列号发现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">正确退出应该是循环过每一位序列号经由最后: 循环次数&#x3D;&#x3D;序列号长度-1来return</span><br><span class="line">在正确序列号变换下tmp每轮是0</span><br></pre></td></tr></table></figure>
<p>其实到这里也没猜到具体的数学背景是什么，最开始肖神通过unknown中变换的数组搜索到AES的add field，不过后来发现只是一组异或，遂失败<br>不过从上面分析可以看到，每轮参与计算的只有12bit，而且通过正确序列号的程序流可以猜测到每一轮tmp=0即为控制条件，以此进行逐位爆破即可得到可能解<br><strong>最后肖神用unicorn成功解出(tqlll !!!)(python爆破我写得有点问题没搞定(飞神那边应该快改好了，已经出了几位))：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line">import sys</span><br><span class="line">import os</span><br><span class="line">import struct</span><br><span class="line">from base64 import b64decode, b64encode</span><br><span class="line">from capstone import *</span><br><span class="line">from capstone.x86_const import *</span><br><span class="line">from unicorn import *</span><br><span class="line">from unicorn.x86_const import *</span><br><span class="line"></span><br><span class="line">def p32(n):</span><br><span class="line">  return struct.pack(&quot;&lt;I&quot;, n)</span><br><span class="line">to &#x3D; b&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&#39;</span><br><span class="line">base &#x3D; b&#39;:;&lt;&#x3D;&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_&#96;abcdefghijklmnopqrstuvwxy&#39;</span><br><span class="line">def base64_enc(data):</span><br><span class="line">    data &#x3D; b64encode(data)</span><br><span class="line">    res &#x3D; []</span><br><span class="line">    for i in data:</span><br><span class="line">        res.append(base[to.index(i)])</span><br><span class="line">    return (&quot;&quot;.join([chr(i) for i in res])).encode()</span><br><span class="line">def base64_dec(data):</span><br><span class="line">    res &#x3D; []</span><br><span class="line">    for i in data:</span><br><span class="line">        res.append(to[base.index(i)])</span><br><span class="line">    return b64decode(&quot;&quot;.join([chr(i) for i in res]).encode())</span><br><span class="line"></span><br><span class="line">cs &#x3D; Cs(CS_ARCH_X86, CS_MODE_32)</span><br><span class="line"></span><br><span class="line">last_addr &#x3D; 0</span><br><span class="line">def hook_code(mu, addr, size, user_data):</span><br><span class="line">  global last_addr</span><br><span class="line">  last_addr &#x3D; addr</span><br><span class="line">  code &#x3D; mu.mem_read(addr, 10)</span><br><span class="line">  ins &#x3D; next(cs.disasm(code, addr, 1))</span><br><span class="line">  disasm &#x3D; &quot;&#123;:08x&#125;: &#123;&#125; &#123;&#125;&quot;.format(addr, ins.mnemonic, ins.op_str)</span><br><span class="line">  print(disasm)</span><br><span class="line"></span><br><span class="line">mu &#x3D; None</span><br><span class="line">with open(&quot;.&#x2F;Totoro.exe&quot;, &#39;rb&#39;) as f:</span><br><span class="line">    f.seek(0x400, os.SEEK_SET)</span><br><span class="line">    text &#x3D; f.read(0xf13b - 0x400)</span><br><span class="line">    f.seek(0xf320, os.SEEK_SET)</span><br><span class="line">    rdata &#x3D; f.read(0x14c68 - 0xf320)</span><br><span class="line">    f.seek(0x14E00, os.SEEK_SET)</span><br><span class="line">    data &#x3D; f.read(0x26C00-0x14E00)</span><br><span class="line">def check(username, key, addr_points&#x3D;None):</span><br><span class="line">  global mu</span><br><span class="line">  mu &#x3D; Uc(UC_ARCH_X86, UC_MODE_32)</span><br><span class="line">  text_start , text_end  &#x3D; 0x401000, 0x410000</span><br><span class="line">  idata_start, idata_end &#x3D; 0x410000, 0x410120</span><br><span class="line">  rdata_start, rdata_end &#x3D; 0x410120, 0x416000</span><br><span class="line">  data_start , data_end  &#x3D; 0x416000, 0x429000</span><br><span class="line">  stack_start, stack_end &#x3D; 0x7ffa0000, 0x80000000</span><br><span class="line">  cache_start, cache_end &#x3D; 0x100000, 0x110000</span><br><span class="line">  stack_curr &#x3D; 0x7fff0000</span><br><span class="line">  mu.mem_map(text_start, data_end - text_start)</span><br><span class="line">  mu.mem_write(text_start, text)</span><br><span class="line">  mu.mem_write(rdata_start, rdata)</span><br><span class="line">  mu.mem_write(data_start, data)</span><br><span class="line">  mu.mem_map(stack_start, stack_end - stack_start)</span><br><span class="line">  mu.mem_map(cache_start, cache_end - cache_start)</span><br><span class="line">  mu.reg_write(UC_X86_REG_ESP, stack_curr)</span><br><span class="line">  # key</span><br><span class="line">  key_addr &#x3D; 0x427E38</span><br><span class="line">  key_len_addr &#x3D; 0x427F38</span><br><span class="line">  mu.mem_write(key_addr, key)</span><br><span class="line">  mu.mem_write(key_addr + len(key), b&#39;\0&#39; * (256 - len(key)))</span><br><span class="line">  mu.mem_write(key_len_addr, p32(len(key)))</span><br><span class="line">  # username</span><br><span class="line">  mu.mem_write(stack_curr + 4, p32(cache_start))</span><br><span class="line">  mu.mem_write(cache_start, username)</span><br><span class="line">  mu.mem_write(stack_curr + 8, p32(len(username)))</span><br><span class="line">  # hook</span><br><span class="line">  # mu.hook_add(UC_HOOK_CODE, hook_code)</span><br><span class="line">  # execute</span><br><span class="line">  check_addr &#x3D; 0x401480</span><br><span class="line">  check_ret_addr &#x3D; 0x402088</span><br><span class="line">  try:</span><br><span class="line">    if not addr_points:</span><br><span class="line">      mu.emu_start(check_addr, check_ret_addr)</span><br><span class="line">    else:</span><br><span class="line">      start &#x3D; check_addr</span><br><span class="line">      for addr in addr_points:</span><br><span class="line">        mu.emu_start(start, addr)</span><br><span class="line">        mu.emu_start(addr, 0, count&#x3D;1)</span><br><span class="line">        start &#x3D; mu.reg_read(UC_X86_REG_EIP)</span><br><span class="line">  except UcError as e:</span><br><span class="line">    return False</span><br><span class="line">  return True</span><br><span class="line"></span><br><span class="line">username &#x3D; b&#39;KCTF&#39;</span><br><span class="line">key &#x3D; [0 for i in range(0x20)]</span><br><span class="line"></span><br><span class="line"># key &#x3D; [61, 136, 200, 67, 168, 249, 66, 246, 42, 33, 212, 253, 243, 246, 246, 244, 246, 249, 244, 255, 237, 249]</span><br><span class="line">end &#x3D; False</span><br><span class="line">for i in range(21):</span><br><span class="line">  for ch in range(256):</span><br><span class="line">    key[i] &#x3D; ch</span><br><span class="line">    if not check(username, bytes(key), [0x401F00] * (i+1)):</span><br><span class="line">      continue</span><br><span class="line">    if mu.reg_read(UC_X86_REG_EAX) &#x3D;&#x3D; 0:</span><br><span class="line">      print(i, ch)</span><br><span class="line">      break</span><br><span class="line">    key[i] &#x3D; 0x100</span><br><span class="line">  if key[i] &#x3D;&#x3D; 0x100:</span><br><span class="line">    break</span><br><span class="line">i +&#x3D; 1</span><br><span class="line">for ch in range(256):</span><br><span class="line">  key[i] &#x3D; ch</span><br><span class="line">  if not check(username, bytes(key)):</span><br><span class="line">    continue</span><br><span class="line">  if mu.reg_read(UC_X86_REG_EAX) &#x3D;&#x3D; 0:</span><br><span class="line">    print(i, ch)</span><br><span class="line">    break</span><br><span class="line">print(key)</span><br><span class="line">#Output:[61, 136, 200, 67, 168, 249, 66, 246, 42, 33, 212, 253, 243, 246, 246, 244, 246, 249, 244, 255, 237, 249]</span><br><span class="line">-------------------------------------------------------------------------------</span><br><span class="line">def dec1(str1):</span><br><span class="line">	ans&#x3D;[]</span><br><span class="line">	for i in range(len(str1)&#x2F;3):</span><br><span class="line">		ans.append(ord(str1[i*3])&gt;&gt;2)</span><br><span class="line">		ans.append(((ord(str1[i*3])&amp;0b11)&lt;&lt;4)+((ord(str1[i*3+1])&amp;0b11110000)&gt;&gt;4))</span><br><span class="line">		ans.append((ord(str1[i*3+1])&amp;0b1111)+((ord(str1[i*3+2])&amp;0b11000000)&gt;&gt;2))</span><br><span class="line">		ans.append(ord(str1[i*3+2])&amp;0b00111111)</span><br><span class="line">	ans.append(ord(str1[21])&gt;&gt;2)</span><br><span class="line">	ans.append((ord(str1[21])&amp;0b11)&lt;&lt;4)</span><br><span class="line">	s&#x3D;&quot;&quot;</span><br><span class="line">	for i in ans:</span><br><span class="line">		s+&#x3D;chr(i+ord(&quot;:&quot;))</span><br><span class="line">	return s+&quot;zz&quot;</span><br><span class="line">s&#x3D;&quot;&quot;</span><br><span class="line">final_key&#x3D;[61, 136, 200, 67, 168, 249, 66, 246, 42, 33, 212, 253, 243, 246, 246, 244, 246, 249, 244, 255, 237, 249]</span><br><span class="line">for i in final_key:</span><br><span class="line">	s+&#x3D;chr(i)</span><br><span class="line">print dec1(s)</span><br><span class="line">#Output:IRrBJtrsJi@dBWnwvyppwIpswIygxJzz</span><br></pre></td></tr></table></figure>
<h2 id="0x04-小虎还乡"><a href="#0x04-小虎还乡" class="headerlink" title="0x04 小虎还乡"></a>0x04 小虎还乡</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Windows 10 64位驱动程序</span><br><span class="line">由于我用的是驱动测试签名，因此请打开测试驱动签名，请做如下操作：</span><br><span class="line">管理员运行cmd，然后输入：</span><br><span class="line">bcdedit &#x2F;set testsigning on</span><br><span class="line">回车，重启即可。</span><br></pre></td></tr></table></figure>
<p>可以看到关键判断:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scanf(&amp;input_format, &amp;v8);                    &#x2F;&#x2F; %d</span><br><span class="line"> if ( (signed __int64)v8 &lt;&#x3D; 96000 &amp;&amp; (signed __int64)v8 &gt;&#x3D; 90000 )</span><br><span class="line"> &#123;</span><br><span class="line">   v15 &#x3D; 66i64;</span><br><span class="line">   v16 &#x3D; 169i64;</span><br><span class="line">   v12 &#x3D; 231i64;</span><br></pre></td></tr></table></figure>
<p>其他地方没有输入的程序流<br>所以猜测答案在90000-96000之间，由此确定了应该使用爆破，接下来patch掉输入在90000-96000时的弹窗即可<br>经过几次patch可以发现在:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">__int64 sub_140002050()</span><br><span class="line">&#123;</span><br><span class="line">  __int64 v0; &#x2F;&#x2F; rax</span><br><span class="line"></span><br><span class="line">  MessageBoxW(0i64, L&quot;wrong!&quot;, L&quot;err&quot;, 0);</span><br><span class="line">  v0 &#x3D; sub_1400014D0(aKerneloadriven);</span><br><span class="line">  return sub_140001E70(v0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将这里的MessageBoxW patch掉，而后爆破直到程序本身弹出”ok”即可:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import time</span><br><span class="line">from subprocess import Popen, PIPE</span><br><span class="line"></span><br><span class="line">for i in range(90000, 96000):</span><br><span class="line">  p &#x3D; Popen(&quot;.&#x2F;ConsoleApplication1.exe&quot;, stdin&#x3D;PIPE, stdout&#x3D;PIPE, stderr&#x3D;PIPE)</span><br><span class="line">  # time.sleep(0.01)</span><br><span class="line">  p.stdin.write(str(i)+&quot;\n&quot;)</span><br><span class="line">  res &#x3D; p.communicate()</span><br><span class="line">  # if len(res[0])!&#x3D;len(&quot;Enter pass word: &quot;):</span><br><span class="line">  #     print str(i),res</span><br><span class="line">  # if i %100&#x3D;&#x3D;0:</span><br><span class="line">  print i</span><br><span class="line">#输出ok时为:91024</span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-无限流"><span class="toc-number">1.</span> <span class="toc-text">0x01 无限流</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-南充茶坊"><span class="toc-number">2.</span> <span class="toc-text">0x02 南充茶坊</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-街机少年"><span class="toc-number">3.</span> <span class="toc-text">0x03 街机少年</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-小虎还乡"><span class="toc-number">4.</span> <span class="toc-text">0x04 小虎还乡</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/12/30/KCTF-2019-Finals/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&text=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&is_video=false&description=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=KCTF 2019 Finals&body=Check out this article: http://yoursite.com/2019/12/30/KCTF-2019-Finals/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&title=KCTF 2019 Finals" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/12/30/KCTF-2019-Finals/&name=KCTF 2019 Finals&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Kirin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


